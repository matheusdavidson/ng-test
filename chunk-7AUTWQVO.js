import{$ as Zr,$b as Hd,A as Je,B as Vd,Ba as Ld,Bb as Vn,Da as ut,Db as cs,E as Md,Eb as qd,Fa as Fe,Fb as ka,Fc as Xd,G as Fd,Ga as de,Hb as $d,Ia as Ve,Ib as Gd,J as Ia,Ja as Aa,Jb as zd,N as Jr,Na as ns,Nb as Wd,Oa as is,P as Ea,Pa as Ud,Pb as Kd,R as wa,Sa as Bi,Ta as B,Ub as kt,Vb as Na,Y as Xr,Z as ba,Za as Ca,_b as us,a as J,ab as Sa,b as Ne,ba as es,bb as xn,bc as Qd,ca as ts,da as kn,db as lt,ea as se,eb as ji,fa as be,g as Rt,h as v,ha as te,hb as Da,hc as Yd,i as Pd,ic as Oa,ja as z,jb as Bd,k as Pt,ka as xe,kb as rs,kc as Mn,la as $e,lb as ss,mc as Fn,n as Oe,nb as Xt,nc as ht,o as kd,oa as Ta,oc as Jd,p as Nd,pa as Te,q as Od,qa as pe,qb as os,qc as xa,ra as Nn,s as ga,t as _a,tc as Ge,u as ya,ub as Ra,v as va,vb as Pa,w as xd,wa as On,wb as as,zb as jd}from"./chunk-VJKZDLWZ.js";var Ma={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var ty=function(n,e){if(!n)throw ny(e)},ny=function(n){return new Error("Firebase Database ("+Ma.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var nf=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},iy=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=n[t++],a=n[t++],u=n[t++],h=((r&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[i++]=String.fromCharCode(55296+(h>>10)),e[i++]=String.fromCharCode(56320+(h&1023))}else{let s=n[t++],a=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|a&63)}}return e.join("")},rf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let s=n[r],a=r+1<n.length,u=a?n[r+1]:0,h=r+2<n.length,d=h?n[r+2]:0,p=s>>2,y=(s&3)<<4|u>>4,A=(u&15)<<2|d>>6,S=d&63;h||(S=64,a||(A=64)),i.push(t[p],t[y],t[A],t[S])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(nf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):iy(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let s=t[n.charAt(r++)],u=r<n.length?t[n.charAt(r)]:0;++r;let d=r<n.length?t[n.charAt(r)]:64;++r;let y=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||u==null||d==null||y==null)throw new Fa;let A=s<<2|u>>4;if(i.push(A),d!==64){let S=u<<4&240|d>>2;if(i.push(S),y!==64){let N=d<<6&192|y;i.push(N)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Fa=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},ry=function(n){let e=nf(n);return rf.encodeByteArray(e,!0)},qi=function(n){return ry(n).replace(/\./g,"")},$i=function(n){try{return rf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function e0(n){return sf(void 0,n)}function sf(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!sy(t)||(n[t]=sf(n[t],e[t]));return n}function sy(n){return n!=="__proto__"}function oy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var ay=()=>oy().__FIREBASE_DEFAULTS__,cy=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},uy=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&$i(n[1]);return e&&JSON.parse(e)},hs=()=>{try{return ay()||cy()||uy()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ua=n=>{var e,t;return(t=(e=hs())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},of=n=>{let e=Ua(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Ba=()=>{var n;return(n=hs())===null||n===void 0?void 0:n.config},ja=n=>{var e;return(e=hs())===null||e===void 0?void 0:e[`_${n}`]};var ls=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function af(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[qi(JSON.stringify(t)),qi(JSON.stringify(a)),""].join(".")}function me(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(me())}function ly(){var n;let e=(n=hs())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uf(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lf(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function hf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function df(){let n=me();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function t0(){return Ma.NODE_CLIENT===!0||Ma.NODE_ADMIN===!0}function ff(){return!ly()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qa(){try{return typeof indexedDB=="object"}catch{return!1}}function pf(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var hy="FirebaseError",Le=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=hy,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dt.prototype.create)}},dt=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],a=s?dy(s,i):"Error",u=`${this.serviceName}: ${a} (${r}).`;return new Le(r,u,i)}};function dy(n,e){return n.replace(fy,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var fy=/\{\$([^}]+)}/g;function Zd(n){return JSON.parse(n)}function n0(n){return JSON.stringify(n)}var mf=function(n){let e={},t={},i={},r="";try{let s=n.split(".");e=Zd($i(s[0])||""),t=Zd($i(s[1])||""),r=s[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:r}};var i0=function(n){let e=mf(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},r0=function(n){let e=mf(n).claims;return typeof e=="object"&&e.admin===!0};function s0(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function o0(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function gf(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function a0(n,e,t){let i={};for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function Zt(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let s=n[r],a=e[r];if(ef(s)&&ef(a)){if(!Zt(s,a))return!1}else if(s!==a)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function ef(n){return n!==null&&typeof n=="object"}function Gi(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}var tf=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let i=this.W_;if(typeof e=="string")for(let y=0;y<16;y++)i[y]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let y=0;y<16;y++)i[y]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let y=16;y<80;y++){let A=i[y-3]^i[y-8]^i[y-14]^i[y-16];i[y]=(A<<1|A>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],a=this.chain_[2],u=this.chain_[3],h=this.chain_[4],d,p;for(let y=0;y<80;y++){y<40?y<20?(d=u^s&(a^u),p=1518500249):(d=s^a^u,p=1859775393):y<60?(d=s&a|u&(s|a),p=2400959708):(d=s^a^u,p=3395469782);let A=(r<<5|r>>>27)+d+h+p+i[y]&4294967295;h=u,u=a,a=(s<<30|s>>>2)&4294967295,s=r,r=A}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let i=t-this.blockSize,r=0,s=this.buf_,a=this.inbuf_;for(;r<t;){if(a===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(s[a]=e.charCodeAt(r),++a,++r,a===this.blockSize){this.compress_(s),a=0;break}}else for(;r<t;)if(s[a]=e[r],++a,++r,a===this.blockSize){this.compress_(s),a=0;break}}this.inbuf_=a,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function _f(n,e){let t=new La(n,e);return t.subscribe.bind(t)}var La=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");py(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Va),r.error===void 0&&(r.error=Va),r.complete===void 0&&(r.complete=Va);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function py(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Va(){}function c0(n,e){return`${n} failed: ${e} argument `}var u0=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,ty(i<n.length,"Surrogate pair missing trail surrogate.");let a=n.charCodeAt(i)-56320;r=65536+(s<<10)+a}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},l0=function(n){let e=0;for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};var h0=4*60*60*1e3;function ke(n){return n&&n._delegate?n._delegate:n}var ze=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var en="[DEFAULT]";var $a=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new ls;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gy(e))try{this.getOrInitializeService({instanceIdentifier:en})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=en){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return v(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=en){return this.instances.has(e)}getOptions(e=en){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[s,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);i===u&&a.resolve(r)}return r}onInit(e,t){var i;let r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:my(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=en){return this.component?this.component.multipleInstances?e:en:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function my(n){return n===en?void 0:n}function gy(n){return n.instantiationMode==="EAGER"}var ds=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new $a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var _y=[],W=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(W||{}),yy={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},vy=W.INFO,Iy={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},Ey=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=Iy[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Nt=class{constructor(e){this.name=e,this._logLevel=vy,this._logHandler=Ey,this._userLogHandler=null,_y.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in W))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yy[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}};var wy=(n,e)=>e.some(t=>n instanceof t),yf,vf;function by(){return yf||(yf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ty(){return vf||(vf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var If=new WeakMap,za=new WeakMap,Ef=new WeakMap,Ga=new WeakMap,Ka=new WeakMap;function Ay(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Xe(n.result)),r()},a=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&If.set(t,n)}).catch(()=>{}),Ka.set(e,n),e}function Cy(n){if(za.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});za.set(n,e)}var Wa={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return za.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ef.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xe(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function wf(n){Wa=n(Wa)}function Sy(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(fs(this),e,...t);return Ef.set(i,e.sort?e.sort():[e]),Xe(i)}:Ty().includes(n)?function(...e){return n.apply(fs(this),e),Xe(If.get(this))}:function(...e){return Xe(n.apply(fs(this),e))}}function Dy(n){return typeof n=="function"?Sy(n):(n instanceof IDBTransaction&&Cy(n),wy(n,by())?new Proxy(n,Wa):n)}function Xe(n){if(n instanceof IDBRequest)return Ay(n);if(Ga.has(n))return Ga.get(n);let e=Dy(n);return e!==n&&(Ga.set(n,e),Ka.set(e,n)),e}var fs=n=>Ka.get(n);function Tf(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){let a=indexedDB.open(n,e),u=Xe(a);return i&&a.addEventListener("upgradeneeded",h=>{i(Xe(a.result),h.oldVersion,h.newVersion,Xe(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{s&&h.addEventListener("close",()=>s()),r&&h.addEventListener("versionchange",d=>r(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var Ry=["get","getKey","getAll","getAllKeys","count"],Py=["put","add","delete","clear"],Ha=new Map;function bf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ha.get(e))return Ha.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=Py.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Ry.includes(t)))return;let s=function(a,...u){return v(this,null,function*(){let h=this.transaction(a,r?"readwrite":"readonly"),d=h.store;return i&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),r&&h.done]))[0]})};return Ha.set(e,s),s}wf(n=>Ne(J({},n),{get:(e,t,i)=>bf(e,t)||n.get(e,t,i),has:(e,t)=>!!bf(e,t)||n.has(e,t)}));var Ya=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ky(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function ky(n){let e=n.getComponent();return e?.type==="VERSION"}var Ja="@firebase/app",Af="0.10.13";var ft=new Nt("@firebase/app"),Ny="@firebase/app-compat",Oy="@firebase/analytics-compat",xy="@firebase/analytics",Vy="@firebase/app-check-compat",My="@firebase/app-check",Fy="@firebase/auth",Ly="@firebase/auth-compat",Uy="@firebase/database",By="@firebase/data-connect",jy="@firebase/database-compat",qy="@firebase/functions",$y="@firebase/functions-compat",Gy="@firebase/installations",zy="@firebase/installations-compat",Wy="@firebase/messaging",Ky="@firebase/messaging-compat",Hy="@firebase/performance",Qy="@firebase/performance-compat",Yy="@firebase/remote-config",Jy="@firebase/remote-config-compat",Xy="@firebase/storage",Zy="@firebase/storage-compat",ev="@firebase/firestore",tv="@firebase/vertexai-preview",nv="@firebase/firestore-compat",iv="firebase",rv="10.14.1";var Xa="[DEFAULT]",sv={[Ja]:"fire-core",[Ny]:"fire-core-compat",[xy]:"fire-analytics",[Oy]:"fire-analytics-compat",[My]:"fire-app-check",[Vy]:"fire-app-check-compat",[Fy]:"fire-auth",[Ly]:"fire-auth-compat",[Uy]:"fire-rtdb",[By]:"fire-data-connect",[jy]:"fire-rtdb-compat",[qy]:"fire-fn",[$y]:"fire-fn-compat",[Gy]:"fire-iid",[zy]:"fire-iid-compat",[Wy]:"fire-fcm",[Ky]:"fire-fcm-compat",[Hy]:"fire-perf",[Qy]:"fire-perf-compat",[Yy]:"fire-rc",[Jy]:"fire-rc-compat",[Xy]:"fire-gcs",[Zy]:"fire-gcs-compat",[ev]:"fire-fst",[nv]:"fire-fst-compat",[tv]:"fire-vertex","fire-js":"fire-js",[iv]:"fire-js-all"};var zi=new Map,ov=new Map,Za=new Map;function Cf(n,e){try{n.container.addComponent(e)}catch(t){ft.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function xt(n){let e=n.name;if(Za.has(e))return ft.debug(`There were multiple attempts to register component ${e}.`),!1;Za.set(e,n);for(let t of zi.values())Cf(t,n);for(let t of ov.values())Cf(t,n);return!0}function Ki(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function pt(n){return n.settings!==void 0}var av={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ot=new dt("app","Firebase",av);var ec=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ze("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ot.create("app-deleted",{appName:this._name})}};var Vt=rv;function ic(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=Object.assign({name:Xa,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw Ot.create("bad-app-name",{appName:String(r)});if(t||(t=Ba()),!t)throw Ot.create("no-options");let s=zi.get(r);if(s){if(Zt(t,s.options)&&Zt(i,s.config))return s;throw Ot.create("duplicate-app",{appName:r})}let a=new ds(r);for(let h of Za.values())a.addComponent(h);let u=new ec(t,i,a);return zi.set(r,u),u}function Ln(n=Xa){let e=zi.get(n);if(!e&&n===Xa&&Ba())return ic();if(!e)throw Ot.create("no-app",{appName:n});return e}function ps(){return Array.from(zi.values())}function fe(n,e,t){var i;let r=(i=sv[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);let s=r.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let u=[`Unable to register library "${r}" with version "${e}":`];s&&u.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ft.warn(u.join(" "));return}xt(new ze(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var cv="firebase-heartbeat-database",uv=1,Wi="firebase-heartbeat-store",Qa=null;function Pf(){return Qa||(Qa=Tf(cv,uv,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Wi)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ot.create("idb-open",{originalErrorMessage:n.message})})),Qa}function lv(n){return v(this,null,function*(){try{let t=(yield Pf()).transaction(Wi),i=yield t.objectStore(Wi).get(kf(n));return yield t.done,i}catch(e){if(e instanceof Le)ft.warn(e.message);else{let t=Ot.create("idb-get",{originalErrorMessage:e?.message});ft.warn(t.message)}}})}function Sf(n,e){return v(this,null,function*(){try{let i=(yield Pf()).transaction(Wi,"readwrite");yield i.objectStore(Wi).put(e,kf(n)),yield i.done}catch(t){if(t instanceof Le)ft.warn(t.message);else{let i=Ot.create("idb-set",{originalErrorMessage:t?.message});ft.warn(i.message)}}})}function kf(n){return`${n.name}!${n.options.appId}`}var hv=1024,dv=30*24*60*60*1e3,tc=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new nc(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return v(this,null,function*(){var e,t;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Df();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=dv}),this._storage.overwrite(this._heartbeatsCache))}catch(i){ft.warn(i)}})}getHeartbeatsHeader(){return v(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Df(),{heartbeatsToSend:i,unsentEntries:r}=fv(this._heartbeatsCache.heartbeats),s=qi(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ft.warn(t),""}})}};function Df(){return new Date().toISOString().substring(0,10)}function fv(n,e=hv){let t=[],i=n.slice();for(let r of n){let s=t.find(a=>a.agent===r.agent);if(s){if(s.dates.push(r.date),Rf(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Rf(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var nc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return v(this,null,function*(){return qa()?pf().then(()=>!0).catch(()=>!1):!1})}read(){return v(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield lv(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return Sf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return Sf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function Rf(n){return qi(JSON.stringify({version:2,heartbeats:n})).length}function pv(n){xt(new ze("platform-logger",e=>new Ya(e),"PRIVATE")),xt(new ze("heartbeat",e=>new tc(e),"PRIVATE")),fe(Ja,Af,n),fe(Ja,Af,"esm2017"),fe("fire-js","")}pv("");var mv="firebase",gv="10.14.1";fe(mv,gv,"app");var rn=new us("ANGULARFIRE2_VERSION");function gs(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Hi=(n,e)=>{let t=e?[e]:ps(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(a=>{i.includes(a)||i.push(a)})}),i},Bn=class{constructor(){return Hi(_v)}},_v="app-check";function Un(){}var ms=class{zone;delegate;constructor(e,t=Od){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,s=function(a){r.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,i)}},rc=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Un,{},Un,Un)),t.pipe(es({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},jn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new ms(Zone.current)),this.insideAngular=t.run(()=>new ms(Zone.current,Nd)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(z(de))};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function _s(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function yv(n){return _s().ngZone.runOutsideAngular(()=>n())}function tn(n){return _s().ngZone.run(()=>n())}function vv(n){return Iv(_s())(n)}function Iv(n){return function(t){return t=t.lift(new rc(n.ngZone)),t.pipe(ya(n.outsideAngular),_a(n.insideAngular))}}var Ev=(n,e)=>function(){let i=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),tn(()=>n.apply(void 0,i))},Ue=(n,e)=>function(){let t,i=arguments;for(let s=0;s<arguments.length;s++)typeof i[s]=="function"&&(e&&(t||=tn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Un,{},Un,Un))),i[s]=Ev(i[s],t));let r=yv(()=>n.apply(this,i));if(!e)if(r instanceof Pt){let s=_s();return r.pipe(ya(s.outsideAngular),_a(s.insideAngular))}else return tn(()=>r);return r instanceof Pt?r.pipe(vv):r instanceof Promise?tn(()=>new Promise((s,a)=>r.then(u=>tn(()=>s(u)),u=>tn(()=>a(u))))):typeof r=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),r.apply(this,arguments)}:tn(()=>r)};var mt=class{constructor(e){return e}},sn=class{constructor(){return ps()}};function wv(n){return n&&n.length===1?n[0]:new mt(Ln())}var sc=new te("angularfire2._apps"),bv={provide:mt,useFactory:wv,deps:[[new $e,sc]]},Tv={provide:sn,deps:[[new $e,sc]]};function Av(n){return(e,t)=>{let i=t.get(ns);fe("angularfire",rn.full,"core"),fe("angularfire",rn.full,"app"),fe("angular",Hd.full,i.toString());let r=e.runOutsideAngular(()=>n(t));return new mt(r)}}function J0(n,...e){return Nn([bv,Tv,{provide:sc,useFactory:Av(n),multi:!0,deps:[de,ut,jn,...e]}])}var X0=Ue(ic,!0);function Wf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Kf=Wf,Hf=new dt("auth","Firebase",Wf());var bs=new Nt("@firebase/auth");function Cv(n,...e){bs.logLevel<=W.WARN&&bs.warn(`Auth (${Vt}): ${n}`,...e)}function vs(n,...e){bs.logLevel<=W.ERROR&&bs.error(`Auth (${Vt}): ${n}`,...e)}function Ft(n,...e){throw Ac(n,...e)}function an(n,...e){return Ac(n,...e)}function Qf(n,e,t){let i=Object.assign(Object.assign({},Kf()),{[e]:t});return new dt("auth","Firebase",i).create(e,{appName:n.name})}function on(n){return Qf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ac(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Hf.create(n,...e)}function L(n,e,...t){if(!n)throw Ac(e,...t)}function gt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw vs(e),new Error(e)}function Lt(n,e){n||gt(e)}function uc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Sv(){return Nf()==="http:"||Nf()==="https:"}function Nf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Dv(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Sv()||lf()||"connection"in navigator)?navigator.onLine:!0}function Rv(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var cn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Lt(t>e,"Short delay should be less than long delay!"),this.isMobile=cf()||hf()}get(){return Dv()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Cc(n,e){Lt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ts=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;gt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;gt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;gt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Pv={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var kv=new cn(3e4,6e4);function Sc(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function $n(s,a,u,h){return v(this,arguments,function*(n,e,t,i,r={}){return Yf(n,r,()=>v(this,null,function*(){let d={},p={};i&&(e==="GET"?p=i:d={body:JSON.stringify(i)});let y=Gi(Object.assign({key:n.config.apiKey},p)).slice(1),A=yield n._getAdditionalHeaders();A["Content-Type"]="application/json",n.languageCode&&(A["X-Firebase-Locale"]=n.languageCode);let S=Object.assign({method:e,headers:A},d);return uf()||(S.referrerPolicy="no-referrer"),Ts.fetch()(Jf(n,n.config.apiHost,t,y),S)}))})}function Yf(n,e,t){return v(this,null,function*(){n._canInitEmulator=!1;let i=Object.assign(Object.assign({},Pv),e);try{let r=new lc(n),s=yield Promise.race([t(),r.promise]);r.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw ys(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let u=s.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw ys(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw ys(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw ys(n,"user-disabled",a);let p=i[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Qf(n,p,d);Ft(n,p)}}catch(r){if(r instanceof Le)throw r;Ft(n,"network-request-failed",{message:String(r)})}})}function Nv(s,a,u,h){return v(this,arguments,function*(n,e,t,i,r={}){let d=yield $n(n,e,t,i,r);return"mfaPendingCredential"in d&&Ft(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function Jf(n,e,t,i){let r=`${e}${t}?${i}`;return n.config.emulator?Cc(n.config,r):`${n.config.apiScheme}://${r}`}var lc=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(an(this.auth,"network-request-failed")),kv.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function ys(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=an(n,e,i);return r.customData._tokenResponse=t,r}function Ov(n,e){return v(this,null,function*(){return $n(n,"POST","/v1/accounts:delete",e)})}function Xf(n,e){return v(this,null,function*(){return $n(n,"POST","/v1/accounts:lookup",e)})}function Qi(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Dc(n,e=!1){return v(this,null,function*(){let t=ke(n),i=yield t.getIdToken(e),r=Rc(i);L(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let s=typeof r.firebase=="object"?r.firebase:void 0,a=s?.sign_in_provider;return{claims:r,token:i,authTime:Qi(oc(r.auth_time)),issuedAtTime:Qi(oc(r.iat)),expirationTime:Qi(oc(r.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function oc(n){return Number(n)*1e3}function Rc(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return vs("JWT malformed, contained fewer than 3 sections"),null;try{let r=$i(t);return r?JSON.parse(r):(vs("Failed to decode base64 JWT payload"),null)}catch(r){return vs("Caught error parsing JWT payload as JSON",r?.toString()),null}}function Of(n){let e=Rc(n);return L(e,"internal-error"),L(typeof e.exp<"u","internal-error"),L(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ji(n,e,t=!1){return v(this,null,function*(){if(t)return e;try{return yield e}catch(i){throw i instanceof Le&&xv(i)&&n.auth.currentUser===n&&(yield n.auth.signOut()),i}})}function xv({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var hc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;let r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>v(this,null,function*(){yield this.iteration()}),t)}iteration(){return v(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Xi=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qi(this.lastLoginAt),this.creationTime=Qi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function As(n){return v(this,null,function*(){var e;let t=n.auth,i=yield n.getIdToken(),r=yield Ji(n,Xf(t,{idToken:i}));L(r?.users.length,t,"internal-error");let s=r.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Zf(s.providerUserInfo):[],u=Vv(n.providerData,a),h=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!u?.length,p=h?d:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new Xi(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,y)})}function Pc(n){return v(this,null,function*(){let e=ke(n);yield As(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Vv(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Zf(n){return n.map(e=>{var{providerId:t}=e,i=ga(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}function Mv(n,e){return v(this,null,function*(){let t=yield Yf(n,{},()=>v(this,null,function*(){let i=Gi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,a=Jf(n,r,"/v1/token",`key=${s}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Ts.fetch()(a,{method:"POST",headers:u,body:i})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function Fv(n,e){return v(this,null,function*(){return $n(n,"POST","/v2/accounts:revokeToken",Sc(n,e))})}var Yi=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){L(e.idToken,"internal-error"),L(typeof e.idToken<"u","internal-error"),L(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Of(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){L(e.length!==0,"internal-error");let t=Of(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return v(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(L(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return v(this,null,function*(){let{accessToken:i,refreshToken:r,expiresIn:s}=yield Mv(e,t);this.updateTokensAndExpiration(i,r,Number(s))})}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:s}=t,a=new n;return i&&(L(typeof i=="string","internal-error",{appName:e}),a.refreshToken=i),r&&(L(typeof r=="string","internal-error",{appName:e}),a.accessToken=r),s&&(L(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return gt("not implemented")}};function Mt(n,e){L(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var qn=class n{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=ga(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new hc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Xi(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return v(this,null,function*(){let t=yield Ji(this,this.stsTokenManager.getToken(this.auth,e));return L(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Dc(this,e)}reload(){return Pc(this)}_assign(e){this!==e&&(L(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){L(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return v(this,null,function*(){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield As(this)),yield this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)})}delete(){return v(this,null,function*(){if(pt(this.auth.app))return Promise.reject(on(this.auth));let e=yield this.getIdToken();return yield Ji(this,Ov(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,a,u,h,d,p;let y=(i=t.displayName)!==null&&i!==void 0?i:void 0,A=(r=t.email)!==null&&r!==void 0?r:void 0,S=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,N=(a=t.photoURL)!==null&&a!==void 0?a:void 0,O=(u=t.tenantId)!==null&&u!==void 0?u:void 0,P=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,q=(d=t.createdAt)!==null&&d!==void 0?d:void 0,$=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:G,emailVerified:ne,isAnonymous:De,providerData:X,stsTokenManager:E}=t;L(G&&E,e,"internal-error");let m=Yi.fromJSON(this.name,E);L(typeof G=="string",e,"internal-error"),Mt(y,e.name),Mt(A,e.name),L(typeof ne=="boolean",e,"internal-error"),L(typeof De=="boolean",e,"internal-error"),Mt(S,e.name),Mt(N,e.name),Mt(O,e.name),Mt(P,e.name),Mt(q,e.name),Mt($,e.name);let _=new n({uid:G,auth:e,email:A,emailVerified:ne,displayName:y,isAnonymous:De,photoURL:N,phoneNumber:S,tenantId:O,stsTokenManager:m,createdAt:q,lastLoginAt:$});return X&&Array.isArray(X)&&(_.providerData=X.map(I=>Object.assign({},I))),P&&(_._redirectEventId=P),_}static _fromIdTokenResponse(e,t,i=!1){return v(this,null,function*(){let r=new Yi;r.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield As(s),s})}static _fromGetAccountInfoResponse(e,t,i){return v(this,null,function*(){let r=t.users[0];L(r.localId!==void 0,"internal-error");let s=r.providerUserInfo!==void 0?Zf(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!s?.length,u=new Yi;u.updateFromIdToken(i);let h=new n({uid:r.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Xi(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(h,d),h})}};var xf=new Map;function _t(n){Lt(n instanceof Function,"Expected a class definition");let e=xf.get(n);return e?(Lt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,xf.set(n,e),e)}var Lv=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return v(this,null,function*(){return!0})}_set(t,i){return v(this,null,function*(){this.storage[t]=i})}_get(t){return v(this,null,function*(){let i=this.storage[t];return i===void 0?null:i})}_remove(t){return v(this,null,function*(){delete this.storage[t]})}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),dc=Lv;function Is(n,e,t){return`firebase:${n}:${e}:${t}`}var Cs=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:s}=this.auth;this.fullUserKey=Is(this.userKey,r.apiKey,s),this.fullPersistenceKey=Is("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return v(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?qn._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return v(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,i="authUser"){return v(this,null,function*(){if(!t.length)return new n(_t(dc),e,i);let r=(yield Promise.all(t.map(d=>v(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=r[0]||_t(dc),a=Is(i,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let y=qn._fromJSON(e,p);d!==s&&(u=y),s=d;break}}catch{}let h=r.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new n(s,e,i):(s=h[0],u&&(yield s._set(a,u.toJSON())),yield Promise.all(t.map(d=>v(this,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,i))})}};function Vf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ip(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ep(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sp(e))return"Blackberry";if(op(e))return"Webos";if(tp(e))return"Safari";if((e.includes("chrome/")||np(e))&&!e.includes("edge/"))return"Chrome";if(rp(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function ep(n=me()){return/firefox\//i.test(n)}function tp(n=me()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function np(n=me()){return/crios\//i.test(n)}function ip(n=me()){return/iemobile/i.test(n)}function rp(n=me()){return/android/i.test(n)}function sp(n=me()){return/blackberry/i.test(n)}function op(n=me()){return/webos/i.test(n)}function kc(n=me()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Uv(n=me()){var e;return kc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Bv(){return df()&&document.documentMode===10}function ap(n=me()){return kc(n)||rp(n)||op(n)||sp(n)||/windows phone/i.test(n)||ip(n)}function cp(n,e=[]){let t;switch(n){case"Browser":t=Vf(me());break;case"Worker":t=`${Vf(me())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vt}/${i}`}var fc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=s=>new Promise((a,u)=>{try{let h=e(s);a(h)}catch(h){u(h)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return v(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)yield i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})}};function jv(t){return v(this,arguments,function*(n,e={}){return $n(n,"GET","/v2/passwordPolicy",Sc(n,e))})}var qv=6,pc=class{constructor(e){var t,i,r,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:qv,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(i=h.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(r=h.containsLowercaseLetter)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var mc=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ss(this),this.idTokenSubscription=new Ss(this),this.beforeStateQueue=new fc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Hf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_t(t)),this._initializationPromise=this.queue(()=>v(this,null,function*(){var i,r;if(!this._deleted&&(this.persistenceManager=yield Cs.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return v(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return v(this,null,function*(){try{let t=yield Xf(this,{idToken:e}),i=yield qn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return v(this,null,function*(){var t;if(pt(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let i=yield this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=r?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(r=h.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(r)}catch(a){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return L(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return v(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return v(this,null,function*(){try{yield As(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=Rv()}_delete(){return v(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return v(this,null,function*(){if(pt(this.app))return Promise.reject(on(this));let t=e?ke(e):null;return t&&L(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return v(this,null,function*(){if(!this._deleted)return e&&L(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>v(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return v(this,null,function*(){return pt(this.app)?Promise.reject(on(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return pt(this.app)?Promise.reject(on(this)):this.queue(()=>v(this,null,function*(){yield this.assertedPersistence.setPersistence(_t(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return v(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return v(this,null,function*(){let e=yield jv(this),t=new pc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new dt("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}revokeAccessToken(e){return v(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),yield Fv(this,i)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return v(this,null,function*(){let i=yield this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return v(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&_t(e)||this._popupRedirectResolver;L(t,this,"argument-error"),this.redirectPersistenceManager=yield Cs.create(this,[_t(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return v(this,null,function*(){var t,i;return this._isInitialized&&(yield this.queue(()=>v(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return v(this,null,function*(){if(e===this.currentUser)return this.queue(()=>v(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(L(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,i,r);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return v(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return L(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=cp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return v(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let i=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();i&&(t["X-Firebase-Client"]=i);let r=yield this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t})}_getAppCheckToken(){return v(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Cv(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Nc(n){return ke(n)}var Ss=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=_f(t=>this.observer=t)}get next(){return L(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Oc={loadJS(){return v(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $v(n){Oc=n}function Gv(n){return Oc.loadJS(n)}function zv(){return Oc.gapiScript}function up(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function xc(n,e){let t=Ki(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),s=t.getOptions();if(Zt(s,e??{}))return r;Ft(r,"already-initialized")}return t.initialize({options:e})}function Wv(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(_t);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Vc(n,e,t){let i=Nc(n);L(i._canInitEmulator,i,"emulator-config-failed"),L(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,s=lp(e),{host:a,port:u}=Kv(e),h=u===null?"":`:${u}`;i.config.emulator={url:`${s}//${a}${h}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||Hv()}function lp(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Kv(n){let e=lp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let s=r[1];return{host:s,port:Mf(i.substr(s.length+1))}}else{let[s,a]=i.split(":");return{host:s,port:Mf(a)}}}function Mf(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Hv(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Ds=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return gt("not implemented")}_getIdTokenResponse(e){return gt("not implemented")}_linkToIdToken(e,t){return gt("not implemented")}_getReauthenticationResolver(e){return gt("not implemented")}};function ac(n,e){return v(this,null,function*(){return Nv(n,"POST","/v1/accounts:signInWithIdp",Sc(n,e))})}var Rs=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var gc=class extends Rs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Zi=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,i,r=!1){return v(this,null,function*(){let s=yield qn._fromIdTokenResponse(e,i,r),a=Ff(i);return new n({user:s,providerId:a,_tokenResponse:i,operationType:t})})}static _forOperation(e,t,i){return v(this,null,function*(){yield e._updateTokensIfNecessary(i,!0);let r=Ff(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})})}};function Ff(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var _c=class n extends Le{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function hp(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?_c._fromErrorAndOperation(n,s,e,i):s})}function Qv(n,e,t=!1){return v(this,null,function*(){let i=yield Ji(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Zi._forOperation(n,"link",i)})}function Yv(n,e,t=!1){return v(this,null,function*(){let{auth:i}=n;if(pt(i.app))return Promise.reject(on(i));let r="reauthenticate";try{let s=yield Ji(n,hp(i,r,e,n),t);L(s.idToken,i,"internal-error");let a=Rc(s.idToken);L(a,i,"internal-error");let{sub:u}=a;return L(n.uid===u,i,"user-mismatch"),Zi._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ft(i,"user-mismatch"),s}})}function Jv(n,e,t=!1){return v(this,null,function*(){if(pt(n.app))return Promise.reject(on(n));let i="signIn",r=yield hp(n,i,e),s=yield Zi._fromIdTokenResponse(n,i,r);return t||(yield n._updateCurrentUser(s.user)),s})}function Mc(n,e,t,i){return ke(n).onIdTokenChanged(e,t,i)}function Fc(n,e,t){return ke(n).beforeAuthStateChanged(e,t)}var Ps="__sak";var ks=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ps,"1"),this.storage.removeItem(Ps),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var Xv=1e3,Zv=10,eI=(()=>{class n extends ks{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ap(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),s=this.localCache[i];r!==s&&t(i,s,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let r=t.key;i?this.detachListener():this.stopPolling();let s=()=>{let u=this.storage.getItem(r);!i&&this.localCache[r]===u||this.notifyListeners(r,u)},a=this.storage.getItem(r);Bv()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,Zv):s()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},Xv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,i){return v(this,null,function*(){yield Rt(n.prototype,this,"_set").call(this,t,i),this.localCache[t]=JSON.stringify(i)})}_get(t){return v(this,null,function*(){let i=yield Rt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(i),i})}_remove(t){return v(this,null,function*(){yield Rt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),dp=eI;var tI=(()=>{class n extends ks{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),Lc=tI;function nI(n){return Promise.all(n.map(e=>v(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var iI=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(s=>s.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}handleEvent(t){return v(this,null,function*(){let i=t,{eventId:r,eventType:s,data:a}=i.data,u=this.handlersMap[s];if(!u?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:s});let h=Array.from(u).map(p=>v(this,null,function*(){return p(i.origin,a)})),d=yield nI(h);i.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:d})})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function fp(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var yc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,i=50){return v(this,null,function*(){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,a;return new Promise((u,h)=>{let d=fp("",20);r.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},i);a={messageChannel:r,onMessage(y){let A=y;if(A.data.eventId===d)switch(A.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(A.data.response);break;default:clearTimeout(p),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function Ze(){return window}function rI(n){Ze().location.href=n}function pp(){return typeof Ze().WorkerGlobalScope<"u"&&typeof Ze().importScripts=="function"}function sI(){return v(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function oI(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function aI(){return pp()?self:null}var mp="firebaseLocalStorageDb",cI=1,Ns="firebaseLocalStorage",gp="fbase_key",un=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function xs(n,e){return n.transaction([Ns],e?"readwrite":"readonly").objectStore(Ns)}function uI(){let n=indexedDB.deleteDatabase(mp);return new un(n).toPromise()}function vc(){let n=indexedDB.open(mp,cI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(Ns,{keyPath:gp})}catch(r){t(r)}}),n.addEventListener("success",()=>v(this,null,function*(){let i=n.result;i.objectStoreNames.contains(Ns)?e(i):(i.close(),yield uI(),e(yield vc()))}))})}function Lf(n,e,t){return v(this,null,function*(){let i=xs(n,!0).put({[gp]:e,value:t});return new un(i).toPromise()})}function lI(n,e){return v(this,null,function*(){let t=xs(n,!1).get(e),i=yield new un(t).toPromise();return i===void 0?null:i.value})}function Uf(n,e){let t=xs(n,!0).delete(e);return new un(t).toPromise()}var hI=800,dI=3,fI=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return v(this,null,function*(){return this.db?this.db:(this.db=yield vc(),this.db)})}_withRetries(t){return v(this,null,function*(){let i=0;for(;;)try{let r=yield this._openDb();return yield t(r)}catch(r){if(i++>dI)throw r;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return v(this,null,function*(){return pp()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return v(this,null,function*(){this.receiver=iI._getInstance(aI()),this.receiver._subscribe("keyChanged",(t,i)=>v(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(i.key)}})),this.receiver._subscribe("ping",(t,i)=>v(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return v(this,null,function*(){var t,i;if(this.activeServiceWorker=yield sI(),!this.activeServiceWorker)return;this.sender=new yc(this.activeServiceWorker);let r=yield this.sender._send("ping",{},800);r&&!((t=r[0])===null||t===void 0)&&t.fulfilled&&!((i=r[0])===null||i===void 0)&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return v(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||oI()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return v(this,null,function*(){try{if(!indexedDB)return!1;let t=yield vc();return yield Lf(t,Ps,"1"),yield Uf(t,Ps),!0}catch{}return!1})}_withPendingWrite(t){return v(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,i){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(r=>Lf(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)}))})}_get(t){return v(this,null,function*(){let i=yield this._withRetries(r=>lI(r,t));return this.localCache[t]=i,i})}_remove(t){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(i=>Uf(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return v(this,null,function*(){let t=yield this._withRetries(s=>{let a=xs(s,!1).getAll();return new un(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),i.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),i.push(s));return i})}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>v(this,null,function*(){return this._poll()}),hI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),_p=fI;var cC=up("rcb"),uC=new cn(3e4,6e4);function pI(n,e){return e?_t(e):(L(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var er=class extends Ds{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ac(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ac(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ac(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function mI(n){return Jv(n.auth,new er(n),n.bypassAuthState)}function gI(n){let{auth:e,user:t}=n;return L(t,e,"internal-error"),Yv(t,new er(n),n.bypassAuthState)}function _I(n){return v(this,null,function*(){let{auth:e,user:t}=n;return L(t,e,"internal-error"),Qv(t,new er(n),n.bypassAuthState)})}var Ic=class{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>v(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}}))}onAuthEvent(e){return v(this,null,function*(){let{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return mI;case"linkViaPopup":case"linkViaRedirect":return _I;case"reauthViaPopup":case"reauthViaRedirect":return gI;default:Ft(this.auth,"internal-error")}}resolve(e){Lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var lC=new cn(2e3,1e4);var yI="pendingRedirect",Es=new Map,Ec=class n extends Ic{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}execute(){return v(this,null,function*(){let e=Es.get(this.auth._key());if(!e){try{let i=(yield vI(this.resolver,this.auth))?yield Rt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Es.set(this.auth._key(),e)}return this.bypassAuthState||Es.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return v(this,null,function*(){if(e.type==="signInViaRedirect")return Rt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Rt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return v(this,null,function*(){})}cleanUp(){}};function vI(n,e){return v(this,null,function*(){let t=wI(e),i=EI(n);if(!(yield i._isAvailable()))return!1;let r=(yield i._get(t))==="true";return yield i._remove(t),r})}function II(n,e){Es.set(n._key(),e)}function EI(n){return _t(n._redirectPersistence)}function wI(n){return Is(yI,n.config.apiKey,n.name)}function bI(n,e,t=!1){return v(this,null,function*(){if(pt(n.app))return Promise.reject(on(n));let i=Nc(n),r=pI(i,e),a=yield new Ec(i,r,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield i._persistUserIfCurrent(a.user),yield i._setRedirectUser(null,e)),a})}var TI=10*60*1e3,wc=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!AI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!yp(e)){let r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(an(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=TI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bf(e))}saveEventToCache(e){this.cachedEventUids.add(Bf(e)),this.lastProcessedEventTime=Date.now()}};function Bf(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function yp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function AI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yp(n);default:return!1}}function CI(t){return v(this,arguments,function*(n,e={}){return $n(n,"GET","/v1/projects",e)})}var SI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DI=/^https?/;function RI(n){return v(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield CI(n);for(let t of e)try{if(PI(t))return}catch{}Ft(n,"unauthorized-domain")})}function PI(n){let e=uc(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===i}if(!DI.test(t))return!1;if(SI.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var kI=new cn(3e4,6e4);function jf(){let n=Ze().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function NI(n){return new Promise((e,t)=>{var i,r,s;function a(){jf(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{jf(),t(an(n,"network-request-failed"))},timeout:kI.get()})}if(!((r=(i=Ze().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=Ze().gapi)===null||s===void 0)&&s.load)a();else{let u=up("iframefcb");return Ze()[u]=()=>{gapi.load?a():t(an(n,"network-request-failed"))},Gv(`${zv()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw ws=null,e})}var ws=null;function OI(n){return ws=ws||NI(n),ws}var xI=new cn(5e3,15e3),VI="__/auth/iframe",MI="emulator/auth/iframe",FI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},LI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function UI(n){let e=n.config;L(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Cc(e,MI):`https://${n.config.authDomain}/${VI}`,i={apiKey:e.apiKey,appName:n.name,v:Vt},r=LI.get(n.config.apiHost);r&&(i.eid=r);let s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Gi(i).slice(1)}`}function BI(n){return v(this,null,function*(){let e=yield OI(n),t=Ze().gapi;return L(t,n,"internal-error"),e.open({where:document.body,url:UI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:FI,dontclear:!0},i=>new Promise((r,s)=>v(this,null,function*(){yield i.restyle({setHideOnLeave:!1});let a=an(n,"network-request-failed"),u=Ze().setTimeout(()=>{s(a)},xI.get());function h(){Ze().clearTimeout(u),r(i)}i.ping(h).then(h,()=>{s(a)})})))})}var jI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qI=500,$I=600,GI="_blank",zI="http://localhost",Os=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function WI(n,e,t,i=qI,r=$I){let s=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString(),u="",h=Object.assign(Object.assign({},jI),{width:i.toString(),height:r.toString(),top:s,left:a}),d=me().toLowerCase();t&&(u=np(d)?GI:t),ep(d)&&(e=e||zI,h.scrollbars="yes");let p=Object.entries(h).reduce((A,[S,N])=>`${A}${S}=${N},`,"");if(Uv(d)&&u!=="_self")return KI(e||"",u),new Os(null);let y=window.open(e||"",u,p);L(y,n,"popup-blocked");try{y.focus()}catch{}return new Os(y)}function KI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var HI="__/auth/handler",QI="emulator/auth/handler",YI=encodeURIComponent("fac");function qf(n,e,t,i,r,s){return v(this,null,function*(){L(n.config.authDomain,n,"auth-domain-config-required"),L(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Vt,eventId:r};if(e instanceof Rs){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",gf(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,y]of Object.entries(s||{}))a[p]=y}if(e instanceof gc){let p=e.getScopes().filter(y=>y!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let h=yield n._getAppCheckToken(),d=h?`#${YI}=${encodeURIComponent(h)}`:"";return`${JI(n)}?${Gi(u).slice(1)}${d}`})}function JI({config:n}){return n.emulator?Cc(n,QI):`https://${n.authDomain}/${HI}`}var cc="webStorageSupport",bc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Lc,this._completeRedirectFn=bI,this._overrideRedirectResult=II}_openPopup(e,t,i,r){return v(this,null,function*(){var s;Lt((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield qf(e,t,i,uc(),r);return WI(e,a,fp())})}_openRedirect(e,t,i,r){return v(this,null,function*(){yield this._originValidation(e);let s=yield qf(e,t,i,uc(),r);return rI(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Lt(s,"If manager is not set, promise should be"),s)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}initAndGetManager(e){return v(this,null,function*(){let t=yield BI(e),i=new wc(e);return t.register("authEvent",r=>(L(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(cc,{type:cc},r=>{var s;let a=(s=r?.[0])===null||s===void 0?void 0:s[cc];a!==void 0&&t(!!a),Ft(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=RI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ap()||tp()||kc()}},vp=bc;var $f="@firebase/auth",Gf="1.7.9";var Tc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return v(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){L(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function XI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ZI(n){xt(new ze("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=i.options;L(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:cp(n)},d=new mc(i,r,s,h);return Wv(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),xt(new ze("auth-internal",e=>{let t=Nc(e.getProvider("auth").getImmediate());return(i=>new Tc(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fe($f,Gf,XI(n)),fe($f,Gf,"esm2017")}var eE=5*60,tE=ja("authIdTokenMaxAge")||eE,zf=null,nE=n=>e=>v(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>tE)return;let r=t?.token;zf!==r&&(zf=r,yield fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});function Uc(n=Ln()){let e=Ki(n,"auth");if(e.isInitialized())return e.getImmediate();let t=xc(n,{popupRedirectResolver:vp,persistence:[_p,dp,Lc]}),i=ja("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(i,location.origin);if(location.origin===s.origin){let a=nE(s.toString());Fc(t,a,()=>a(t.currentUser)),Mc(t,u=>a(u))}}let r=Ua("auth");return r&&Vc(t,`http://${r}`),t}function iE(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}$v({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let s=an("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",iE().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ZI("Browser");var Ip="auth",tr=class{constructor(e){return e}},nr=class{constructor(){return Hi(Ip)}};var Bc=new te("angularfire2.auth-instances");function JE(n,e){let t=gs(Ip,n,e);return t&&new tr(t)}function XE(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new tr(i)}}var ZE={provide:nr,deps:[[new $e,Bc]]},ew={provide:tr,useFactory:JE,deps:[[new $e,Bc],mt]};function YC(n,...e){return fe("angularfire",rn.full,"auth"),Nn([ew,ZE,{provide:Bc,useFactory:XE(n),multi:!0,deps:[de,ut,jn,sn,[new $e,Bn],...e]}])}var JC=Ue(Uc,!0);var Ep=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},wp={};var Ut,jc;(function(){var n;function e(E,m){function _(){}_.prototype=m.prototype,E.D=m.prototype,E.prototype=new _,E.prototype.constructor=E,E.C=function(I,w,T){for(var g=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)g[ot-2]=arguments[ot];return m.prototype[w].apply(I,g)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(E,m,_){_||(_=0);var I=Array(16);if(typeof m=="string")for(var w=0;16>w;++w)I[w]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(w=0;16>w;++w)I[w]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=E.g[0],_=E.g[1],w=E.g[2];var T=E.g[3],g=m+(T^_&(w^T))+I[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=T+(w^m&(_^w))+I[1]+3905402710&4294967295,T=m+(g<<12&4294967295|g>>>20),g=w+(_^T&(m^_))+I[2]+606105819&4294967295,w=T+(g<<17&4294967295|g>>>15),g=_+(m^w&(T^m))+I[3]+3250441966&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(T^_&(w^T))+I[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(w^m&(_^w))+I[5]+1200080426&4294967295,T=m+(g<<12&4294967295|g>>>20),g=w+(_^T&(m^_))+I[6]+2821735955&4294967295,w=T+(g<<17&4294967295|g>>>15),g=_+(m^w&(T^m))+I[7]+4249261313&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(T^_&(w^T))+I[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(w^m&(_^w))+I[9]+2336552879&4294967295,T=m+(g<<12&4294967295|g>>>20),g=w+(_^T&(m^_))+I[10]+4294925233&4294967295,w=T+(g<<17&4294967295|g>>>15),g=_+(m^w&(T^m))+I[11]+2304563134&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(T^_&(w^T))+I[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(w^m&(_^w))+I[13]+4254626195&4294967295,T=m+(g<<12&4294967295|g>>>20),g=w+(_^T&(m^_))+I[14]+2792965006&4294967295,w=T+(g<<17&4294967295|g>>>15),g=_+(m^w&(T^m))+I[15]+1236535329&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(w^T&(_^w))+I[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^w&(m^_))+I[6]+3225465664&4294967295,T=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(T^m))+I[11]+643717713&4294967295,w=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(w^T))+I[0]+3921069994&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(w^T&(_^w))+I[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^w&(m^_))+I[10]+38016083&4294967295,T=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(T^m))+I[15]+3634488961&4294967295,w=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(w^T))+I[4]+3889429448&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(w^T&(_^w))+I[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^w&(m^_))+I[14]+3275163606&4294967295,T=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(T^m))+I[3]+4107603335&4294967295,w=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(w^T))+I[8]+1163531501&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(w^T&(_^w))+I[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^w&(m^_))+I[2]+4243563512&4294967295,T=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(T^m))+I[7]+1735328473&4294967295,w=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(w^T))+I[12]+2368359562&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(_^w^T)+I[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^w)+I[8]+2272392833&4294967295,T=m+(g<<11&4294967295|g>>>21),g=w+(T^m^_)+I[11]+1839030562&4294967295,w=T+(g<<16&4294967295|g>>>16),g=_+(w^T^m)+I[14]+4259657740&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(_^w^T)+I[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^w)+I[4]+1272893353&4294967295,T=m+(g<<11&4294967295|g>>>21),g=w+(T^m^_)+I[7]+4139469664&4294967295,w=T+(g<<16&4294967295|g>>>16),g=_+(w^T^m)+I[10]+3200236656&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(_^w^T)+I[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^w)+I[0]+3936430074&4294967295,T=m+(g<<11&4294967295|g>>>21),g=w+(T^m^_)+I[3]+3572445317&4294967295,w=T+(g<<16&4294967295|g>>>16),g=_+(w^T^m)+I[6]+76029189&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(_^w^T)+I[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^w)+I[12]+3873151461&4294967295,T=m+(g<<11&4294967295|g>>>21),g=w+(T^m^_)+I[15]+530742520&4294967295,w=T+(g<<16&4294967295|g>>>16),g=_+(w^T^m)+I[2]+3299628645&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(w^(_|~T))+I[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~w))+I[7]+1126891415&4294967295,T=m+(g<<10&4294967295|g>>>22),g=w+(m^(T|~_))+I[14]+2878612391&4294967295,w=T+(g<<15&4294967295|g>>>17),g=_+(T^(w|~m))+I[5]+4237533241&4294967295,_=w+(g<<21&4294967295|g>>>11),g=m+(w^(_|~T))+I[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~w))+I[3]+2399980690&4294967295,T=m+(g<<10&4294967295|g>>>22),g=w+(m^(T|~_))+I[10]+4293915773&4294967295,w=T+(g<<15&4294967295|g>>>17),g=_+(T^(w|~m))+I[1]+2240044497&4294967295,_=w+(g<<21&4294967295|g>>>11),g=m+(w^(_|~T))+I[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~w))+I[15]+4264355552&4294967295,T=m+(g<<10&4294967295|g>>>22),g=w+(m^(T|~_))+I[6]+2734768916&4294967295,w=T+(g<<15&4294967295|g>>>17),g=_+(T^(w|~m))+I[13]+1309151649&4294967295,_=w+(g<<21&4294967295|g>>>11),g=m+(w^(_|~T))+I[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~w))+I[11]+3174756917&4294967295,T=m+(g<<10&4294967295|g>>>22),g=w+(m^(T|~_))+I[2]+718787259&4294967295,w=T+(g<<15&4294967295|g>>>17),g=_+(T^(w|~m))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+m&4294967295,E.g[1]=E.g[1]+(w+(g<<21&4294967295|g>>>11))&4294967295,E.g[2]=E.g[2]+w&4294967295,E.g[3]=E.g[3]+T&4294967295}i.prototype.u=function(E,m){m===void 0&&(m=E.length);for(var _=m-this.blockSize,I=this.B,w=this.h,T=0;T<m;){if(w==0)for(;T<=_;)r(this,E,T),T+=this.blockSize;if(typeof E=="string"){for(;T<m;)if(I[w++]=E.charCodeAt(T++),w==this.blockSize){r(this,I),w=0;break}}else for(;T<m;)if(I[w++]=E[T++],w==this.blockSize){r(this,I),w=0;break}}this.h=w,this.o+=m},i.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var m=1;m<E.length-8;++m)E[m]=0;var _=8*this.o;for(m=E.length-8;m<E.length;++m)E[m]=_&255,_/=256;for(this.u(E),E=Array(16),m=_=0;4>m;++m)for(var I=0;32>I;I+=8)E[_++]=this.g[m]>>>I&255;return E};function s(E,m){var _=u;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=m(E)}function a(E,m){this.h=m;for(var _=[],I=!0,w=E.length-1;0<=w;w--){var T=E[w]|0;I&&T==m||(_[w]=T,I=!1)}this.g=_}var u={};function h(E){return-128<=E&&128>E?s(E,function(m){return new a([m|0],0>m?-1:0)}):new a([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return y;if(0>E)return P(d(-E));for(var m=[],_=1,I=0;E>=_;I++)m[I]=E/_|0,_*=4294967296;return new a(m,0)}function p(E,m){if(E.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(E.charAt(0)=="-")return P(p(E.substring(1),m));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),I=y,w=0;w<E.length;w+=8){var T=Math.min(8,E.length-w),g=parseInt(E.substring(w,w+T),m);8>T?(T=d(Math.pow(m,T)),I=I.j(T).add(d(g))):(I=I.j(_),I=I.add(d(g)))}return I}var y=h(0),A=h(1),S=h(16777216);n=a.prototype,n.m=function(){if(O(this))return-P(this).m();for(var E=0,m=1,_=0;_<this.g.length;_++){var I=this.i(_);E+=(0<=I?I:4294967296+I)*m,m*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(N(this))return"0";if(O(this))return"-"+P(this).toString(E);for(var m=d(Math.pow(E,6)),_=this,I="";;){var w=ne(_,m).g;_=q(_,w.j(m));var T=((0<_.g.length?_.g[0]:_.h)>>>0).toString(E);if(_=w,N(_))return T+I;for(;6>T.length;)T="0"+T;I=T+I}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function N(E){if(E.h!=0)return!1;for(var m=0;m<E.g.length;m++)if(E.g[m]!=0)return!1;return!0}function O(E){return E.h==-1}n.l=function(E){return E=q(this,E),O(E)?-1:N(E)?0:1};function P(E){for(var m=E.g.length,_=[],I=0;I<m;I++)_[I]=~E.g[I];return new a(_,~E.h).add(A)}n.abs=function(){return O(this)?P(this):this},n.add=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0,w=0;w<=m;w++){var T=I+(this.i(w)&65535)+(E.i(w)&65535),g=(T>>>16)+(this.i(w)>>>16)+(E.i(w)>>>16);I=g>>>16,T&=65535,g&=65535,_[w]=g<<16|T}return new a(_,_[_.length-1]&-2147483648?-1:0)};function q(E,m){return E.add(P(m))}n.j=function(E){if(N(this)||N(E))return y;if(O(this))return O(E)?P(this).j(P(E)):P(P(this).j(E));if(O(E))return P(this.j(P(E)));if(0>this.l(S)&&0>E.l(S))return d(this.m()*E.m());for(var m=this.g.length+E.g.length,_=[],I=0;I<2*m;I++)_[I]=0;for(I=0;I<this.g.length;I++)for(var w=0;w<E.g.length;w++){var T=this.i(I)>>>16,g=this.i(I)&65535,ot=E.i(w)>>>16,Ei=E.i(w)&65535;_[2*I+2*w]+=g*Ei,$(_,2*I+2*w),_[2*I+2*w+1]+=T*Ei,$(_,2*I+2*w+1),_[2*I+2*w+1]+=g*ot,$(_,2*I+2*w+1),_[2*I+2*w+2]+=T*ot,$(_,2*I+2*w+2)}for(I=0;I<m;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=m;I<2*m;I++)_[I]=0;return new a(_,0)};function $(E,m){for(;(E[m]&65535)!=E[m];)E[m+1]+=E[m]>>>16,E[m]&=65535,m++}function G(E,m){this.g=E,this.h=m}function ne(E,m){if(N(m))throw Error("division by zero");if(N(E))return new G(y,y);if(O(E))return m=ne(P(E),m),new G(P(m.g),P(m.h));if(O(m))return m=ne(E,P(m)),new G(P(m.g),m.h);if(30<E.g.length){if(O(E)||O(m))throw Error("slowDivide_ only works with positive integers.");for(var _=A,I=m;0>=I.l(E);)_=De(_),I=De(I);var w=X(_,1),T=X(I,1);for(I=X(I,2),_=X(_,2);!N(I);){var g=T.add(I);0>=g.l(E)&&(w=w.add(_),T=g),I=X(I,1),_=X(_,1)}return m=q(E,w.j(m)),new G(w,m)}for(w=y;0<=E.l(m);){for(_=Math.max(1,Math.floor(E.m()/m.m())),I=Math.ceil(Math.log(_)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),T=d(_),g=T.j(m);O(g)||0<g.l(E);)_-=I,T=d(_),g=T.j(m);N(T)&&(T=A),w=w.add(T),E=q(E,g)}return new G(w,E)}n.A=function(E){return ne(this,E).h},n.and=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)&E.i(I);return new a(_,this.h&E.h)},n.or=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)|E.i(I);return new a(_,this.h|E.h)},n.xor=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)^E.i(I);return new a(_,this.h^E.h)};function De(E){for(var m=E.g.length+1,_=[],I=0;I<m;I++)_[I]=E.i(I)<<1|E.i(I-1)>>>31;return new a(_,E.h)}function X(E,m){var _=m>>5;m%=32;for(var I=E.g.length-_,w=[],T=0;T<I;T++)w[T]=0<m?E.i(T+_)>>>m|E.i(T+_+1)<<32-m:E.i(T+_);return new a(w,E.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,jc=wp.Md5=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Ut=wp.Integer=a}).apply(typeof Ep<"u"?Ep:typeof self<"u"?self:typeof window<"u"?window:{});var Vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yt={};var qc,tw,Gn,$c,ir,Ms,Gc,zc,Wc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,l){return o==Array.prototype||o==Object.prototype||(o[c]=l.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vs=="object"&&Vs];for(var c=0;c<o.length;++c){var l=o[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var i=t(this);function r(o,c){if(c)e:{var l=i;o=o.split(".");for(var f=0;f<o.length-1;f++){var b=o[f];if(!(b in l))break e;l=l[b]}o=o[o.length-1],f=l[o],c=c(f),c!=f&&c!=null&&e(l,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var l=0,f=!1,b={next:function(){if(!f&&l<o.length){var C=l++;return{value:c(C,o[C]),done:!1}}return f=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}r("Array.prototype.values",function(o){return o||function(){return s(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function d(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,l){return o.call.apply(o.bind,arguments)}function y(o,c,l){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,f),o.apply(c,b)}}return function(){return o.apply(c,arguments)}}function A(o,c,l){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,A.apply(null,arguments)}function S(o,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function N(o,c){function l(){}l.prototype=c.prototype,o.aa=c.prototype,o.prototype=new l,o.prototype.constructor=o,o.Qb=function(f,b,C){for(var k=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)k[ee-2]=arguments[ee];return c.prototype[b].apply(f,k)}}function O(o){let c=o.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=o[f];return l}return[]}function P(o,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let b=o.length||0,C=f.length||0;o.length=b+C;for(let k=0;k<C;k++)o[b+k]=f[k]}else o.push(f)}}class q{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function $(o){return/^[\s\xa0]*$/.test(o)}function G(){var o=u.navigator;return o&&(o=o.userAgent)?o:""}function ne(o){return ne[" "](o),o}ne[" "]=function(){};var De=G().indexOf("Gecko")!=-1&&!(G().toLowerCase().indexOf("webkit")!=-1&&G().indexOf("Edge")==-1)&&!(G().indexOf("Trident")!=-1||G().indexOf("MSIE")!=-1)&&G().indexOf("Edge")==-1;function X(o,c,l){for(let f in o)c.call(l,o[f],f,o)}function E(o,c){for(let l in o)c.call(void 0,o[l],l,o)}function m(o){let c={};for(let l in o)c[l]=o[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(o,c){let l,f;for(let b=1;b<arguments.length;b++){f=arguments[b];for(l in f)o[l]=f[l];for(let C=0;C<_.length;C++)l=_[C],Object.prototype.hasOwnProperty.call(f,l)&&(o[l]=f[l])}}function w(o){var c=1;o=o.split(":");let l=[];for(;0<c&&o.length;)l.push(o.shift()),c--;return o.length&&l.push(o.join(":")),l}function T(o){u.setTimeout(()=>{throw o},0)}function g(){var o=zo;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class ot{constructor(){this.h=this.g=null}add(c,l){let f=Ei.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var Ei=new q(()=>new E_,o=>o.reset());class E_{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let wi,bi=!1,zo=new ot,Rh=()=>{let o=u.Promise.resolve(void 0);wi=()=>{o.then(w_)}};var w_=()=>{for(var o;o=g();){try{o.h.call(o.g)}catch(l){T(l)}var c=Ei;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}bi=!1};function At(){this.s=this.s,this.C=this.C}At.prototype.s=!1,At.prototype.ma=function(){this.s||(this.s=!0,this.N())},At.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var b_=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return o}();function Ti(o,c){if(ve.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var l=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(De){e:{try{ne(c.nodeName);var b=!0;break e}catch{}b=!1}b||(c=null)}}else l=="mouseover"?c=o.fromElement:l=="mouseout"&&(c=o.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:T_[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Ti.aa.h.call(this)}}N(Ti,ve);var T_={2:"touch",3:"pen",4:"mouse"};Ti.prototype.h=function(){Ti.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Ai="closure_listenable_"+(1e6*Math.random()|0),A_=0;function C_(o,c,l,f,b){this.listener=o,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=b,this.key=++A_,this.da=this.fa=!1}function xr(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Vr(o){this.src=o,this.g={},this.h=0}Vr.prototype.add=function(o,c,l,f,b){var C=o.toString();o=this.g[C],o||(o=this.g[C]=[],this.h++);var k=Ko(o,c,f,b);return-1<k?(c=o[k],l||(c.fa=!1)):(c=new C_(c,this.src,C,!!f,b),c.fa=l,o.push(c)),c};function Wo(o,c){var l=c.type;if(l in o.g){var f=o.g[l],b=Array.prototype.indexOf.call(f,c,void 0),C;(C=0<=b)&&Array.prototype.splice.call(f,b,1),C&&(xr(c),o.g[l].length==0&&(delete o.g[l],o.h--))}}function Ko(o,c,l,f){for(var b=0;b<o.length;++b){var C=o[b];if(!C.da&&C.listener==c&&C.capture==!!l&&C.ha==f)return b}return-1}var Ho="closure_lm_"+(1e6*Math.random()|0),Qo={};function Ph(o,c,l,f,b){if(f&&f.once)return Nh(o,c,l,f,b);if(Array.isArray(c)){for(var C=0;C<c.length;C++)Ph(o,c[C],l,f,b);return null}return l=Zo(l),o&&o[Ai]?o.K(c,l,d(f)?!!f.capture:!!f,b):kh(o,c,l,!1,f,b)}function kh(o,c,l,f,b,C){if(!c)throw Error("Invalid event type");var k=d(b)?!!b.capture:!!b,ee=Jo(o);if(ee||(o[Ho]=ee=new Vr(o)),l=ee.add(c,l,f,k,C),l.proxy)return l;if(f=S_(),l.proxy=f,f.src=o,f.listener=l,o.addEventListener)b_||(b=k),b===void 0&&(b=!1),o.addEventListener(c.toString(),f,b);else if(o.attachEvent)o.attachEvent(xh(c.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function S_(){function o(l){return c.call(o.src,o.listener,l)}let c=D_;return o}function Nh(o,c,l,f,b){if(Array.isArray(c)){for(var C=0;C<c.length;C++)Nh(o,c[C],l,f,b);return null}return l=Zo(l),o&&o[Ai]?o.L(c,l,d(f)?!!f.capture:!!f,b):kh(o,c,l,!0,f,b)}function Oh(o,c,l,f,b){if(Array.isArray(c))for(var C=0;C<c.length;C++)Oh(o,c[C],l,f,b);else f=d(f)?!!f.capture:!!f,l=Zo(l),o&&o[Ai]?(o=o.i,c=String(c).toString(),c in o.g&&(C=o.g[c],l=Ko(C,l,f,b),-1<l&&(xr(C[l]),Array.prototype.splice.call(C,l,1),C.length==0&&(delete o.g[c],o.h--)))):o&&(o=Jo(o))&&(c=o.g[c.toString()],o=-1,c&&(o=Ko(c,l,f,b)),(l=-1<o?c[o]:null)&&Yo(l))}function Yo(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[Ai])Wo(c.i,o);else{var l=o.type,f=o.proxy;c.removeEventListener?c.removeEventListener(l,f,o.capture):c.detachEvent?c.detachEvent(xh(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=Jo(c))?(Wo(l,o),l.h==0&&(l.src=null,c[Ho]=null)):xr(o)}}}function xh(o){return o in Qo?Qo[o]:Qo[o]="on"+o}function D_(o,c){if(o.da)o=!0;else{c=new Ti(c,this);var l=o.listener,f=o.ha||o.src;o.fa&&Yo(o),o=l.call(f,c)}return o}function Jo(o){return o=o[Ho],o instanceof Vr?o:null}var Xo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zo(o){return typeof o=="function"?o:(o[Xo]||(o[Xo]=function(c){return o.handleEvent(c)}),o[Xo])}function Ie(){At.call(this),this.i=new Vr(this),this.M=this,this.F=null}N(Ie,At),Ie.prototype[Ai]=!0,Ie.prototype.removeEventListener=function(o,c,l,f){Oh(this,o,c,l,f)};function Re(o,c){var l,f=o.F;if(f)for(l=[];f;f=f.F)l.push(f);if(o=o.M,f=c.type||c,typeof c=="string")c=new ve(c,o);else if(c instanceof ve)c.target=c.target||o;else{var b=c;c=new ve(f,o),I(c,b)}if(b=!0,l)for(var C=l.length-1;0<=C;C--){var k=c.g=l[C];b=Mr(k,f,!0,c)&&b}if(k=c.g=o,b=Mr(k,f,!0,c)&&b,b=Mr(k,f,!1,c)&&b,l)for(C=0;C<l.length;C++)k=c.g=l[C],b=Mr(k,f,!1,c)&&b}Ie.prototype.N=function(){if(Ie.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var l=o.g[c],f=0;f<l.length;f++)xr(l[f]);delete o.g[c],o.h--}}this.F=null},Ie.prototype.K=function(o,c,l,f){return this.i.add(String(o),c,!1,l,f)},Ie.prototype.L=function(o,c,l,f){return this.i.add(String(o),c,!0,l,f)};function Mr(o,c,l,f){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var b=!0,C=0;C<c.length;++C){var k=c[C];if(k&&!k.da&&k.capture==l){var ee=k.listener,_e=k.ha||k.src;k.fa&&Wo(o.i,k),b=ee.call(_e,f)!==!1&&b}}return b&&!f.defaultPrevented}function Vh(o,c,l){if(typeof o=="function")l&&(o=A(o,l));else if(o&&typeof o.handleEvent=="function")o=A(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(o,c||0)}function Mh(o){o.g=Vh(()=>{o.g=null,o.i&&(o.i=!1,Mh(o))},o.l);let c=o.h;o.h=null,o.m.apply(null,c)}class R_ extends At{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Mh(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ci(o){At.call(this),this.h=o,this.g={}}N(Ci,At);var Fh=[];function Lh(o){X(o.g,function(c,l){this.g.hasOwnProperty(l)&&Yo(c)},o),o.g={}}Ci.prototype.N=function(){Ci.aa.N.call(this),Lh(this)},Ci.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ea=u.JSON.stringify,P_=u.JSON.parse,k_=class{stringify(o){return u.JSON.stringify(o,void 0)}parse(o){return u.JSON.parse(o,void 0)}};function ta(){}ta.prototype.h=null;function Uh(o){return o.h||(o.h=o.i())}function Bh(){}var Si={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function na(){ve.call(this,"d")}N(na,ve);function ia(){ve.call(this,"c")}N(ia,ve);var Ht={},jh=null;function Fr(){return jh=jh||new Ie}Ht.La="serverreachability";function qh(o){ve.call(this,Ht.La,o)}N(qh,ve);function Di(o){let c=Fr();Re(c,new qh(c))}Ht.STAT_EVENT="statevent";function $h(o,c){ve.call(this,Ht.STAT_EVENT,o),this.stat=c}N($h,ve);function Pe(o){let c=Fr();Re(c,new $h(c,o))}Ht.Ma="timingevent";function Gh(o,c){ve.call(this,Ht.Ma,o),this.size=c}N(Gh,ve);function Ri(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){o()},c)}function Pi(){this.g=!0}Pi.prototype.xa=function(){this.g=!1};function N_(o,c,l,f,b,C){o.info(function(){if(o.g)if(C)for(var k="",ee=C.split("&"),_e=0;_e<ee.length;_e++){var Q=ee[_e].split("=");if(1<Q.length){var Ee=Q[0];Q=Q[1];var we=Ee.split("_");k=2<=we.length&&we[1]=="type"?k+(Ee+"="+Q+"&"):k+(Ee+"=redacted&")}}else k=null;else k=C;return"XMLHTTP REQ ("+f+") [attempt "+b+"]: "+c+`
`+l+`
`+k})}function O_(o,c,l,f,b,C,k){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+b+"]: "+c+`
`+l+`
`+C+" "+k})}function Sn(o,c,l,f){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+V_(o,l)+(f?" "+f:"")})}function x_(o,c){o.info(function(){return"TIMEOUT: "+c})}Pi.prototype.info=function(){};function V_(o,c){if(!o.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(o=0;o<l.length;o++)if(Array.isArray(l[o])){var f=l[o];if(!(2>f.length)){var b=f[1];if(Array.isArray(b)&&!(1>b.length)){var C=b[0];if(C!="noop"&&C!="stop"&&C!="close")for(var k=1;k<b.length;k++)b[k]=""}}}}return ea(l)}catch{return c}}var Lr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},zh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ra;function Ur(){}N(Ur,ta),Ur.prototype.g=function(){return new XMLHttpRequest},Ur.prototype.i=function(){return{}},ra=new Ur;function Ct(o,c,l,f){this.j=o,this.i=c,this.l=l,this.R=f||1,this.U=new Ci(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Wh}function Wh(){this.i=null,this.g="",this.h=!1}var Kh={},sa={};function oa(o,c,l){o.L=1,o.v=$r(at(c)),o.m=l,o.P=!0,Hh(o,null)}function Hh(o,c){o.F=Date.now(),Br(o),o.A=at(o.v);var l=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),cd(l.i,"t",f),o.C=0,l=o.j.J,o.h=new Wh,o.g=Cd(o.j,l?c:null,!o.m),0<o.O&&(o.M=new R_(A(o.Y,o,o.g),o.O)),c=o.U,l=o.g,f=o.ca;var b="readystatechange";Array.isArray(b)||(b&&(Fh[0]=b.toString()),b=Fh);for(var C=0;C<b.length;C++){var k=Ph(l,b[C],f||c.handleEvent,!1,c.h||c);if(!k)break;c.g[k.key]=k}c=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),Di(),N_(o.i,o.u,o.A,o.l,o.R,o.m)}Ct.prototype.ca=function(o){o=o.target;let c=this.M;c&&ct(o)==3?c.j():this.Y(o)},Ct.prototype.Y=function(o){try{if(o==this.g)e:{let we=ct(this.g);var c=this.g.Ba();let Pn=this.g.Z();if(!(3>we)&&(we!=3||this.g&&(this.h.h||this.g.oa()||md(this.g)))){this.J||we!=4||c==7||(c==8||0>=Pn?Di(3):Di(2)),aa(this);var l=this.g.Z();this.X=l;t:if(Qh(this)){var f=md(this.g);o="";var b=f.length,C=ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qt(this),ki(this);var k="";break t}this.h.i=new u.TextDecoder}for(c=0;c<b;c++)this.h.h=!0,o+=this.h.i.decode(f[c],{stream:!(C&&c==b-1)});f.length=0,this.h.g+=o,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=l==200,O_(this.i,this.u,this.A,this.l,this.R,we,l),this.o){if(this.T&&!this.K){t:{if(this.g){var ee,_e=this.g;if((ee=_e.g?_e.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(ee)){var Q=ee;break t}}Q=null}if(l=Q)Sn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ca(this,l);else{this.o=!1,this.s=3,Pe(12),Qt(this),ki(this);break e}}if(this.P){l=!0;let Ke;for(;!this.J&&this.C<k.length;)if(Ke=M_(this,k),Ke==sa){we==4&&(this.s=4,Pe(14),l=!1),Sn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ke==Kh){this.s=4,Pe(15),Sn(this.i,this.l,k,"[Invalid Chunk]"),l=!1;break}else Sn(this.i,this.l,Ke,null),ca(this,Ke);if(Qh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),we!=4||k.length!=0||this.h.h||(this.s=1,Pe(16),l=!1),this.o=this.o&&l,!l)Sn(this.i,this.l,k,"[Invalid Chunked Response]"),Qt(this),ki(this);else if(0<k.length&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.ba&&!Ee.M&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),pa(Ee),Ee.M=!0,Pe(11))}}else Sn(this.i,this.l,k,null),ca(this,k);we==4&&Qt(this),this.o&&!this.J&&(we==4?wd(this.j,this):(this.o=!1,Br(this)))}else Z_(this.g),l==400&&0<k.indexOf("Unknown SID")?(this.s=3,Pe(12)):(this.s=0,Pe(13)),Qt(this),ki(this)}}}catch{}finally{}};function Qh(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function M_(o,c){var l=o.C,f=c.indexOf(`
`,l);return f==-1?sa:(l=Number(c.substring(l,f)),isNaN(l)?Kh:(f+=1,f+l>c.length?sa:(c=c.slice(f,f+l),o.C=f+l,c)))}Ct.prototype.cancel=function(){this.J=!0,Qt(this)};function Br(o){o.S=Date.now()+o.I,Yh(o,o.I)}function Yh(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Ri(A(o.ba,o),c)}function aa(o){o.B&&(u.clearTimeout(o.B),o.B=null)}Ct.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(x_(this.i,this.A),this.L!=2&&(Di(),Pe(17)),Qt(this),this.s=2,ki(this)):Yh(this,this.S-o)};function ki(o){o.j.G==0||o.J||wd(o.j,o)}function Qt(o){aa(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,Lh(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function ca(o,c){try{var l=o.j;if(l.G!=0&&(l.g==o||ua(l.h,o))){if(!o.K&&ua(l.h,o)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var b=f;if(b[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<o.F)Hr(l),Wr(l);else break e;fa(l),Pe(18)}}else l.za=b[1],0<l.za-l.T&&37500>b[2]&&l.F&&l.v==0&&!l.C&&(l.C=Ri(A(l.Za,l),6e3));if(1>=Zh(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else Jt(l,11)}else if((o.K||l.g==o)&&Hr(l),!$(c))for(b=l.Da.g.parse(c),c=0;c<b.length;c++){let Q=b[c];if(l.T=Q[0],Q=Q[1],l.G==2)if(Q[0]=="c"){l.K=Q[1],l.ia=Q[2];let Ee=Q[3];Ee!=null&&(l.la=Ee,l.j.info("VER="+l.la));let we=Q[4];we!=null&&(l.Aa=we,l.j.info("SVER="+l.Aa));let Pn=Q[5];Pn!=null&&typeof Pn=="number"&&0<Pn&&(f=1.5*Pn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let Ke=o.g;if(Ke){let Yr=Ke.g?Ke.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yr){var C=f.h;C.g||Yr.indexOf("spdy")==-1&&Yr.indexOf("quic")==-1&&Yr.indexOf("h2")==-1||(C.j=C.l,C.g=new Set,C.h&&(la(C,C.h),C.h=null))}if(f.D){let ma=Ke.g?Ke.g.getResponseHeader("X-HTTP-Session-Id"):null;ma&&(f.ya=ma,ie(f.I,f.D,ma))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-o.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var k=o;if(f.qa=Ad(f,f.J?f.ia:null,f.W),k.K){ed(f.h,k);var ee=k,_e=f.L;_e&&(ee.I=_e),ee.B&&(aa(ee),Br(ee)),f.g=k}else Id(f);0<l.i.length&&Kr(l)}else Q[0]!="stop"&&Q[0]!="close"||Jt(l,7);else l.G==3&&(Q[0]=="stop"||Q[0]=="close"?Q[0]=="stop"?Jt(l,7):da(l):Q[0]!="noop"&&l.l&&l.l.ta(Q),l.v=0)}}Di(4)}catch{}}var F_=class{constructor(o,c){this.g=o,this.map=c}};function Jh(o){this.l=o||10,u.PerformanceNavigationTiming?(o=u.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xh(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Zh(o){return o.h?1:o.g?o.g.size:0}function ua(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function la(o,c){o.g?o.g.add(c):o.h=c}function ed(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Jh.prototype.cancel=function(){if(this.i=td(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function td(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(let l of o.g.values())c=c.concat(l.D);return c}return O(o.i)}function L_(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(h(o)){for(var c=[],l=o.length,f=0;f<l;f++)c.push(o[f]);return c}c=[],l=0;for(f in o)c[l++]=o[f];return c}function U_(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(h(o)||typeof o=="string"){var c=[];o=o.length;for(var l=0;l<o;l++)c.push(l);return c}c=[],l=0;for(let f in o)c[l++]=f;return c}}}function nd(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(h(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var l=U_(o),f=L_(o),b=f.length,C=0;C<b;C++)c.call(void 0,f[C],l&&l[C],o)}var id=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function B_(o,c){if(o){o=o.split("&");for(var l=0;l<o.length;l++){var f=o[l].indexOf("="),b=null;if(0<=f){var C=o[l].substring(0,f);b=o[l].substring(f+1)}else C=o[l];c(C,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function Yt(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Yt){this.h=o.h,jr(this,o.j),this.o=o.o,this.g=o.g,qr(this,o.s),this.l=o.l;var c=o.i,l=new xi;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),rd(this,l),this.m=o.m}else o&&(c=String(o).match(id))?(this.h=!1,jr(this,c[1]||"",!0),this.o=Ni(c[2]||""),this.g=Ni(c[3]||"",!0),qr(this,c[4]),this.l=Ni(c[5]||"",!0),rd(this,c[6]||"",!0),this.m=Ni(c[7]||"")):(this.h=!1,this.i=new xi(null,this.h))}Yt.prototype.toString=function(){var o=[],c=this.j;c&&o.push(Oi(c,sd,!0),":");var l=this.g;return(l||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Oi(c,sd,!0),"@"),o.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&o.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&o.push("/"),o.push(Oi(l,l.charAt(0)=="/"?$_:q_,!0))),(l=this.i.toString())&&o.push("?",l),(l=this.m)&&o.push("#",Oi(l,z_)),o.join("")};function at(o){return new Yt(o)}function jr(o,c,l){o.j=l?Ni(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function qr(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function rd(o,c,l){c instanceof xi?(o.i=c,W_(o.i,o.h)):(l||(c=Oi(c,G_)),o.i=new xi(c,o.h))}function ie(o,c,l){o.i.set(c,l)}function $r(o){return ie(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Ni(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Oi(o,c,l){return typeof o=="string"?(o=encodeURI(o).replace(c,j_),l&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function j_(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var sd=/[#\/\?@]/g,q_=/[#\?:]/g,$_=/[#\?]/g,G_=/[#\?@]/g,z_=/#/g;function xi(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function St(o){o.g||(o.g=new Map,o.h=0,o.i&&B_(o.i,function(c,l){o.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=xi.prototype,n.add=function(o,c){St(this),this.i=null,o=Dn(this,o);var l=this.g.get(o);return l||this.g.set(o,l=[]),l.push(c),this.h+=1,this};function od(o,c){St(o),c=Dn(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function ad(o,c){return St(o),c=Dn(o,c),o.g.has(c)}n.forEach=function(o,c){St(this),this.g.forEach(function(l,f){l.forEach(function(b){o.call(c,b,f,this)},this)},this)},n.na=function(){St(this);let o=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let b=o[f];for(let C=0;C<b.length;C++)l.push(c[f])}return l},n.V=function(o){St(this);let c=[];if(typeof o=="string")ad(this,o)&&(c=c.concat(this.g.get(Dn(this,o))));else{o=Array.from(this.g.values());for(let l=0;l<o.length;l++)c=c.concat(o[l])}return c},n.set=function(o,c){return St(this),this.i=null,o=Dn(this,o),ad(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function cd(o,c,l){od(o,c),0<l.length&&(o.i=null,o.g.set(Dn(o,c),O(l)),o.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let C=encodeURIComponent(String(f)),k=this.V(f);for(f=0;f<k.length;f++){var b=C;k[f]!==""&&(b+="="+encodeURIComponent(String(k[f]))),o.push(b)}}return this.i=o.join("&")};function Dn(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function W_(o,c){c&&!o.j&&(St(o),o.i=null,o.g.forEach(function(l,f){var b=f.toLowerCase();f!=b&&(od(this,f),cd(this,b,l))},o)),o.j=c}function K_(o,c){let l=new Pi;if(u.Image){let f=new Image;f.onload=S(Dt,l,"TestLoadImage: loaded",!0,c,f),f.onerror=S(Dt,l,"TestLoadImage: error",!1,c,f),f.onabort=S(Dt,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=S(Dt,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else c(!1)}function H_(o,c){let l=new Pi,f=new AbortController,b=setTimeout(()=>{f.abort(),Dt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:f.signal}).then(C=>{clearTimeout(b),C.ok?Dt(l,"TestPingServer: ok",!0,c):Dt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(b),Dt(l,"TestPingServer: error",!1,c)})}function Dt(o,c,l,f,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),f(l)}catch{}}function Q_(){this.g=new k_}function Y_(o,c,l){let f=l||"";try{nd(o,function(b,C){let k=b;d(b)&&(k=ea(b)),c.push(f+C+"="+encodeURIComponent(k))})}catch(b){throw c.push(f+"type="+encodeURIComponent("_badmap")),b}}function Vi(o){this.l=o.Ub||null,this.j=o.eb||!1}N(Vi,ta),Vi.prototype.g=function(){return new Gr(this.l,this.j)},Vi.prototype.i=function(o){return function(){return o}}({});function Gr(o,c){Ie.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(Gr,Ie),n=Gr.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Fi(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Mi(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Fi(this)),this.g&&(this.readyState=3,Fi(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ud(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function ud(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Mi(this):Fi(this),this.readyState==3&&ud(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,Mi(this))},n.Qa=function(o){this.g&&(this.response=o,Mi(this))},n.ga=function(){this.g&&Mi(this)};function Mi(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Fi(o)}n.setRequestHeader=function(o,c){this.u.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,o.push(l[0]+": "+l[1]),l=c.next();return o.join(`\r
`)};function Fi(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Gr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function ld(o){let c="";return X(o,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function ha(o,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=ld(l),typeof o=="string"?l!=null&&encodeURIComponent(String(l)):ie(o,c,l))}function ae(o){Ie.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(ae,Ie);var J_=/^https?$/i,X_=["POST","PUT"];n=ae.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ra.g(),this.v=this.o?Uh(this.o):Uh(ra),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(C){hd(this,C);return}if(o=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var b in f)l.set(b,f[b]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let C of f.keys())l.set(C,f.get(C));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(C=>C.toLowerCase()=="content-type"),b=u.FormData&&o instanceof u.FormData,!(0<=Array.prototype.indexOf.call(X_,c,void 0))||f||b||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[C,k]of l)this.g.setRequestHeader(C,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pd(this),this.u=!0,this.g.send(o),this.u=!1}catch(C){hd(this,C)}};function hd(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,dd(o),zr(o)}function dd(o){o.A||(o.A=!0,Re(o,"complete"),Re(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Re(this,"complete"),Re(this,"abort"),zr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zr(this,!0)),ae.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?fd(this):this.bb())},n.bb=function(){fd(this)};function fd(o){if(o.h&&typeof a<"u"&&(!o.v[1]||ct(o)!=4||o.Z()!=2)){if(o.u&&ct(o)==4)Vh(o.Ea,0,o);else if(Re(o,"readystatechange"),ct(o)==4){o.h=!1;try{let k=o.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=k===0){var b=String(o.D).match(id)[1]||null;!b&&u.self&&u.self.location&&(b=u.self.location.protocol.slice(0,-1)),f=!J_.test(b?b.toLowerCase():"")}l=f}if(l)Re(o,"complete"),Re(o,"success");else{o.m=6;try{var C=2<ct(o)?o.g.statusText:""}catch{C=""}o.l=C+" ["+o.Z()+"]",dd(o)}}finally{zr(o)}}}}function zr(o,c){if(o.g){pd(o);let l=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||Re(o,"ready");try{l.onreadystatechange=f}catch{}}}function pd(o){o.I&&(u.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function ct(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<ct(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),P_(c)}};function md(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Z_(o){let c={};o=(o.g&&2<=ct(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if($(o[f]))continue;var l=w(o[f]);let b=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let C=c[b]||[];c[b]=C,C.push(l)}E(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Li(o,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[o]||c}function gd(o){this.Aa=0,this.i=[],this.j=new Pi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Li("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Li("baseRetryDelayMs",5e3,o),this.cb=Li("retryDelaySeedMs",1e4,o),this.Wa=Li("forwardChannelMaxRetries",2,o),this.wa=Li("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Jh(o&&o.concurrentRequestLimit),this.Da=new Q_,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=gd.prototype,n.la=8,n.G=1,n.connect=function(o,c,l,f){Pe(0),this.W=o,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=Ad(this,null,this.W),Kr(this)};function da(o){if(_d(o),o.G==3){var c=o.U++,l=at(o.I);if(ie(l,"SID",o.K),ie(l,"RID",c),ie(l,"TYPE","terminate"),Ui(o,l),c=new Ct(o,o.j,c),c.L=2,c.v=$r(at(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=Cd(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Br(c)}Td(o)}function Wr(o){o.g&&(pa(o),o.g.cancel(),o.g=null)}function _d(o){Wr(o),o.u&&(u.clearTimeout(o.u),o.u=null),Hr(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&u.clearTimeout(o.s),o.s=null)}function Kr(o){if(!Xh(o.h)&&!o.s){o.s=!0;var c=o.Ga;wi||Rh(),bi||(wi(),bi=!0),zo.add(c,o),o.B=0}}function ey(o,c){return Zh(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Ri(A(o.Ga,o,c),bd(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let b=new Ct(this,this.j,o),C=this.o;if(this.S&&(C?(C=m(C),I(C,this.S)):C=this.S),this.m!==null||this.O||(b.H=C,C=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=vd(this,b,c),l=at(this.I),ie(l,"RID",o),ie(l,"CVER",22),this.D&&ie(l,"X-HTTP-Session-Id",this.D),Ui(this,l),C&&(this.O?c="headers="+encodeURIComponent(String(ld(C)))+"&"+c:this.m&&ha(l,this.m,C)),la(this.h,b),this.Ua&&ie(l,"TYPE","init"),this.P?(ie(l,"$req",c),ie(l,"SID","null"),b.T=!0,oa(b,l,null)):oa(b,l,c),this.G=2}}else this.G==3&&(o?yd(this,o):this.i.length==0||Xh(this.h)||yd(this))};function yd(o,c){var l;c?l=c.l:l=o.U++;let f=at(o.I);ie(f,"SID",o.K),ie(f,"RID",l),ie(f,"AID",o.T),Ui(o,f),o.m&&o.o&&ha(f,o.m,o.o),l=new Ct(o,o.j,l,o.B+1),o.m===null&&(l.H=o.o),c&&(o.i=c.D.concat(o.i)),c=vd(o,l,1e3),l.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),la(o.h,l),oa(l,f,c)}function Ui(o,c){o.H&&X(o.H,function(l,f){ie(c,f,l)}),o.l&&nd({},function(l,f){ie(c,f,l)})}function vd(o,c,l){l=Math.min(o.i.length,l);var f=o.l?A(o.l.Na,o.l,o):null;e:{var b=o.i;let C=-1;for(;;){let k=["count="+l];C==-1?0<l?(C=b[0].g,k.push("ofs="+C)):C=0:k.push("ofs="+C);let ee=!0;for(let _e=0;_e<l;_e++){let Q=b[_e].g,Ee=b[_e].map;if(Q-=C,0>Q)C=Math.max(0,b[_e].g-100),ee=!1;else try{Y_(Ee,k,"req"+Q+"_")}catch{f&&f(Ee)}}if(ee){f=k.join("&");break e}}}return o=o.i.splice(0,l),c.D=o,f}function Id(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;wi||Rh(),bi||(wi(),bi=!0),zo.add(c,o),o.v=0}}function fa(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Ri(A(o.Fa,o),bd(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,Ed(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Ri(A(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Pe(10),Wr(this),Ed(this))};function pa(o){o.A!=null&&(u.clearTimeout(o.A),o.A=null)}function Ed(o){o.g=new Ct(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=at(o.qa);ie(c,"RID","rpc"),ie(c,"SID",o.K),ie(c,"AID",o.T),ie(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&ie(c,"TO",o.ja),ie(c,"TYPE","xmlhttp"),Ui(o,c),o.m&&o.o&&ha(c,o.m,o.o),o.L&&(o.g.I=o.L);var l=o.g;o=o.ia,l.L=1,l.v=$r(at(c)),l.m=null,l.P=!0,Hh(l,o)}n.Za=function(){this.C!=null&&(this.C=null,Wr(this),fa(this),Pe(19))};function Hr(o){o.C!=null&&(u.clearTimeout(o.C),o.C=null)}function wd(o,c){var l=null;if(o.g==c){Hr(o),pa(o),o.g=null;var f=2}else if(ua(o.h,c))l=c.D,ed(o.h,c),f=1;else return;if(o.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var b=o.B;f=Fr(),Re(f,new Gh(f,l)),Kr(o)}else Id(o);else if(b=c.s,b==3||b==0&&0<c.X||!(f==1&&ey(o,c)||f==2&&fa(o)))switch(l&&0<l.length&&(c=o.h,c.i=c.i.concat(l)),b){case 1:Jt(o,5);break;case 4:Jt(o,10);break;case 3:Jt(o,6);break;default:Jt(o,2)}}}function bd(o,c){let l=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(l*=2),l*c}function Jt(o,c){if(o.j.info("Error code "+c),c==2){var l=A(o.fb,o),f=o.Xa;let b=!f;f=new Yt(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||jr(f,"https"),$r(f),b?K_(f.toString(),l):H_(f.toString(),l)}else Pe(2);o.G=0,o.l&&o.l.sa(c),Td(o),_d(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Pe(2)):(this.j.info("Failed to ping google.com"),Pe(1))};function Td(o){if(o.G=0,o.ka=[],o.l){let c=td(o.h);(c.length!=0||o.i.length!=0)&&(P(o.ka,c),P(o.ka,o.i),o.h.i.length=0,O(o.i),o.i.length=0),o.l.ra()}}function Ad(o,c,l){var f=l instanceof Yt?at(l):new Yt(l);if(f.g!="")c&&(f.g=c+"."+f.g),qr(f,f.s);else{var b=u.location;f=b.protocol,c=c?c+"."+b.hostname:b.hostname,b=+b.port;var C=new Yt(null);f&&jr(C,f),c&&(C.g=c),b&&qr(C,b),l&&(C.l=l),f=C}return l=o.D,c=o.ya,l&&c&&ie(f,l,c),ie(f,"VER",o.la),Ui(o,f),f}function Cd(o,c,l){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new ae(new Vi({eb:l})):new ae(o.pa),c.Ha(o.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sd(){}n=Sd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Qr(){}Qr.prototype.g=function(o,c){return new Me(o,c)};function Me(o,c){Ie.call(this),this.g=new gd(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!$(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!$(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Rn(this)}N(Me,Ie),Me.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Me.prototype.close=function(){da(this.g)},Me.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var l={};l.__data__=o,o=l}else this.u&&(l={},l.__data__=ea(o),o=l);c.i.push(new F_(c.Ya++,o)),c.G==3&&Kr(c)},Me.prototype.N=function(){this.g.l=null,delete this.j,da(this.g),delete this.g,Me.aa.N.call(this)};function Dd(o){na.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(let l in c){o=l;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}N(Dd,na);function Rd(){ia.call(this),this.status=1}N(Rd,ia);function Rn(o){this.g=o}N(Rn,Sd),Rn.prototype.ua=function(){Re(this.g,"a")},Rn.prototype.ta=function(o){Re(this.g,new Dd(o))},Rn.prototype.sa=function(o){Re(this.g,new Rd)},Rn.prototype.ra=function(){Re(this.g,"b")},Qr.prototype.createWebChannel=Qr.prototype.g,Me.prototype.send=Me.prototype.o,Me.prototype.open=Me.prototype.m,Me.prototype.close=Me.prototype.close,Wc=yt.createWebChannelTransport=function(){return new Qr},zc=yt.getStatEventTarget=function(){return Fr()},Gc=yt.Event=Ht,Ms=yt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Lr.NO_ERROR=0,Lr.TIMEOUT=8,Lr.HTTP_ERROR=6,ir=yt.ErrorCode=Lr,zh.COMPLETE="complete",$c=yt.EventType=zh,Bh.EventType=Si,Si.OPEN="a",Si.CLOSE="b",Si.ERROR="c",Si.MESSAGE="d",Ie.prototype.listen=Ie.prototype.K,Gn=yt.WebChannel=Bh,tw=yt.FetchXmlHttpFactory=Vi,ae.prototype.listenOnce=ae.prototype.L,ae.prototype.getLastError=ae.prototype.Ka,ae.prototype.getLastErrorCode=ae.prototype.Ba,ae.prototype.getStatus=ae.prototype.Z,ae.prototype.getResponseJson=ae.prototype.Oa,ae.prototype.getResponseText=ae.prototype.oa,ae.prototype.send=ae.prototype.ea,ae.prototype.setWithCredentials=ae.prototype.Ha,qc=yt.XhrIo=ae}).apply(typeof Vs<"u"?Vs:typeof self<"u"?self:typeof window<"u"?window:{});var bp="@firebase/firestore";var ge=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ge.UNAUTHENTICATED=new ge(null),ge.GOOGLE_CREDENTIALS=new ge("google-credentials-uid"),ge.FIRST_PARTY=new ge("first-party-uid"),ge.MOCK_USER=new ge("mock-user");var hi="10.14.0";var fn=new Nt("@firebase/firestore");function rr(){return fn.logLevel}function V(n,...e){if(fn.logLevel<=W.DEBUG){let t=e.map(Pl);fn.debug(`Firestore (${hi}): ${n}`,...t)}}function It(n,...e){if(fn.logLevel<=W.ERROR){let t=e.map(Pl);fn.error(`Firestore (${hi}): ${n}`,...t)}}function Xn(n,...e){if(fn.logLevel<=W.WARN){let t=e.map(Pl);fn.warn(`Firestore (${hi}): ${n}`,...t)}}function Pl(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function F(n="Unexpected state"){let e=`FIRESTORE (${hi}) INTERNAL ASSERTION FAILED: `+n;throw It(e),new Error(e)}function Z(n,e){n||F()}function U(n,e){return n}var D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends Le{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var vt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var js=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Jc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ge.UNAUTHENTICATED))}shutdown(){}},Xc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Zc=class{constructor(e){this.t=e,this.currentUser=ge.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Z(this.o===void 0);let i=this.i,r=h=>this.i!==i?(i=this.i,t(h)):Promise.resolve(),s=new vt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new vt,e.enqueueRetryable(()=>r(this.currentUser))};let a=()=>{let h=s;e.enqueueRetryable(()=>v(this,null,function*(){yield h.promise,yield r(this.currentUser)}))},u=h=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new vt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Z(typeof i.accessToken=="string"),new js(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string"),new ge(e)}},eu=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=ge.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},tu=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new eu(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ge.FIRST_PARTY))}shutdown(){}invalidateToken(){}},nu=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},iu=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Z(this.o===void 0);let i=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,V("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?r(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Z(typeof t.token=="string"),this.R=t.token,new nu(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function nw(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var qs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let r=nw(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}};function Y(n,e){return n<e?-1:n>e?1:0}function Zn(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var ye=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new x(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var j=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ye(0,0))}static max(){return new n(new ye(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var $s=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&F(),i===void 0?i=e.length-t:i>e.length-t&&F(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=e.get(r),a=t.get(r);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},oe=class n extends $s{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new x(D.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},iw=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Be=class n extends $s{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return iw.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new x(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},a=!1;for(;r<e.length;){let u=e[r];if(u==="\\"){if(r+1===e.length)throw new x(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[r+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new x(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=h,r+=2}else u==="`"?(a=!a,r++):u!=="."||a?(i+=u,r++):(s(),r++)}if(s(),a)throw new x(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var M=class n{constructor(e){this.path=e}static fromPath(e){return new n(oe.fromString(e))}static fromName(e){return new n(oe.fromString(e).popFirst(5))}static empty(){return new n(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new oe(e.slice()))}};var ru=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};ru.UNKNOWN_ID=-1;function rw(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=j.fromTimestamp(i===1e9?new ye(t+1,0):new ye(t,i));return new pn(r,M.empty(),e)}function sw(n){return new pn(n.readTime,n.key,-1)}var pn=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(j.min(),M.empty(),-1)}static max(){return new n(j.max(),M.empty(),-1)}};function ow(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=M.comparator(n.documentKey,e.documentKey),t!==0?t:Y(n.largestBatchId,e.largestBatchId))}var aw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",su=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function br(n){return v(this,null,function*(){if(n.code!==D.FAILED_PRECONDITION||n.message!==aw)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&F(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,a=!1;e.forEach(u=>{++r,u.next(()=>{++s,a&&s===r&&t()},h=>i(h))}),a=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,a=new Array(s),u=0;for(let h=0;h<s;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===s&&i(a)},p=>r(p))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};function cw(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Tr(n){return n.name==="IndexedDbTransactionError"}var sm=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ie(r),this.se=r=>i.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function yo(n){return n==null}function lr(n){return n===0&&1/n==-1/0}function uw(n){return typeof n=="number"&&Number.isInteger(n)&&!lr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var lw=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],hS=[...lw,"documentOverlays"],hw=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],dw=hw,fw=[...dw,"indexConfiguration","indexState","indexEntries"];var dS=[...fw,"globals"];function Tp(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function di(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function om(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ce=class n{constructor(e,t){this.comparator=e,this.root=t||nt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,nt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hn(this.root,e,this.comparator,!0)}},Hn=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},nt=class n{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new n(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw F();let e=this.left.check();if(e!==this.right.check())throw F();return e+(this.isRed()?0:1)}};nt.EMPTY=null,nt.RED=!0,nt.BLACK=!1;nt.EMPTY=new class{constructor(){this.size=0}get key(){throw F()}get value(){throw F()}get color(){throw F()}get left(){throw F()}get right(){throw F()}copy(e,t,i,r,s){return this}insert(e,t,i){return new nt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ce=class n{constructor(e){this.comparator=e,this.data=new ce(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Gs(this.data.getIterator())}getIteratorFrom(e){return new Gs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Gs=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var tt=class n{constructor(e){this.fields=e,e.sort(Be.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ce(Be.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Zn(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var zs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Se=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new zs("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(r){let s="";for(let a=0;a<r.length;++a)s+=String.fromCharCode(r[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Se.EMPTY_BYTE_STRING=new Se("");var pw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Et(n){if(Z(!!n),typeof n=="string"){let e=0,t=pw.exec(n);if(Z(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:re(n.seconds),nanos:re(n.nanos)}}function re(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function qt(n){return typeof n=="string"?Se.fromBase64String(n):Se.fromUint8Array(n)}function kl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Nl(n){let e=n.mapValue.fields.__previous_value__;return kl(e)?Nl(e):e}function hr(n){let e=Et(n.mapValue.fields.__local_write_time__.timestampValue);return new ye(e.seconds,e.nanos)}var ou=class{constructor(e,t,i,r,s,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d}},Ws=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Fs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function mn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?kl(n)?4:cm(n)?9007199254740991:am(n)?10:11:F()}function st(n,e){if(n===e)return!0;let t=mn(n);if(t!==mn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return hr(n).isEqual(hr(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;let a=Et(r.timestampValue),u=Et(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return qt(r.bytesValue).isEqual(qt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return re(r.geoPointValue.latitude)===re(s.geoPointValue.latitude)&&re(r.geoPointValue.longitude)===re(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return re(r.integerValue)===re(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){let a=re(r.doubleValue),u=re(s.doubleValue);return a===u?lr(a)===lr(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return Zn(n.arrayValue.values||[],e.arrayValue.values||[],st);case 10:case 11:return function(r,s){let a=r.mapValue.fields||{},u=s.mapValue.fields||{};if(Tp(a)!==Tp(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!st(a[h],u[h])))return!1;return!0}(n,e);default:return F()}}function dr(n,e){return(n.values||[]).find(t=>st(t,e))!==void 0}function ei(n,e){if(n===e)return 0;let t=mn(n),i=mn(e);if(t!==i)return Y(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Y(n.booleanValue,e.booleanValue);case 2:return function(s,a){let u=re(s.integerValue||s.doubleValue),h=re(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return Ap(n.timestampValue,e.timestampValue);case 4:return Ap(hr(n),hr(e));case 5:return Y(n.stringValue,e.stringValue);case 6:return function(s,a){let u=qt(s),h=qt(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let u=s.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=Y(u[d],h[d]);if(p!==0)return p}return Y(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let u=Y(re(s.latitude),re(a.latitude));return u!==0?u:Y(re(s.longitude),re(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Cp(n.arrayValue,e.arrayValue);case 10:return function(s,a){var u,h,d,p;let y=s.fields||{},A=a.fields||{},S=(u=y.value)===null||u===void 0?void 0:u.arrayValue,N=(h=A.value)===null||h===void 0?void 0:h.arrayValue,O=Y(((d=S?.values)===null||d===void 0?void 0:d.length)||0,((p=N?.values)===null||p===void 0?void 0:p.length)||0);return O!==0?O:Cp(S,N)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===Fs.mapValue&&a===Fs.mapValue)return 0;if(s===Fs.mapValue)return 1;if(a===Fs.mapValue)return-1;let u=s.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let y=0;y<h.length&&y<p.length;++y){let A=Y(h[y],p[y]);if(A!==0)return A;let S=ei(u[h[y]],d[p[y]]);if(S!==0)return S}return Y(h.length,p.length)}(n.mapValue,e.mapValue);default:throw F()}}function Ap(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Y(n,e);let t=Et(n),i=Et(e),r=Y(t.seconds,i.seconds);return r!==0?r:Y(t.nanos,i.nanos)}function Cp(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let s=ei(t[r],i[r]);if(s)return s}return Y(t.length,i.length)}function ti(n){return au(n)}function au(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let i=Et(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return qt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return M.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(let s of t.values||[])r?r=!1:i+=",",i+=au(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){let i=Object.keys(t.fields||{}).sort(),r="{",s=!0;for(let a of i)s?s=!1:r+=",",r+=`${a}:${au(t.fields[a])}`;return r+"}"}(n.mapValue):F()}function Sp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function cu(n){return!!n&&"integerValue"in n}function Ol(n){return!!n&&"arrayValue"in n}function Dp(n){return!!n&&"nullValue"in n}function Rp(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Us(n){return!!n&&"mapValue"in n}function am(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function or(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return di(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=or(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=or(n.arrayValue.values[t]);return e}return Object.assign({},n)}function cm(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var He=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Us(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=or(t)}setAll(e){let t=Be.emptyPath(),i={},r=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,i,r),i={},r=[],t=u.popLast()}a?i[u.lastSegment()]=or(a):r.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());Us(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return st(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Us(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){di(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n(or(this.value))}};function um(n){let e=[];return di(n.fields,(t,i)=>{let r=new Be([t]);if(Us(i)){let s=um(i.mapValue).fields;if(s.length===0)e.push(r);else for(let a of s)e.push(r.child(a))}else e.push(r)}),new tt(e)}var Qe=class n{constructor(e,t,i,r,s,a,u){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,j.min(),j.min(),j.min(),He.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,j.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,j.min(),j.min(),He.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,j.min(),j.min(),He.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=He.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=He.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ni=class{constructor(e,t){this.position=e,this.inclusive=t}};function Pp(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],a=n.position[r];if(s.field.isKeyField()?i=M.comparator(M.fromName(a.referenceValue),t.key):i=ei(a,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function kp(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!st(n.position[t],e.position[t]))return!1;return!0}var ii=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function mw(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ks=class{},he=class n extends Ks{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new lu(e,t,i):t==="array-contains"?new fu(e,i):t==="in"?new pu(e,i):t==="not-in"?new mu(e,i):t==="array-contains-any"?new gu(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new hu(e,i):new du(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ei(t,this.value)):t!==null&&mn(this.value)===mn(t)&&this.matchesComparison(ei(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return F()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ye=class n extends Ks{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return lm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function lm(n){return n.op==="and"}function hm(n){return gw(n)&&lm(n)}function gw(n){for(let e of n.filters)if(e instanceof Ye)return!1;return!0}function uu(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+ti(n.value);if(hm(n))return n.filters.map(e=>uu(e)).join(",");{let e=n.filters.map(t=>uu(t)).join(",");return`${n.op}(${e})`}}function dm(n,e){return n instanceof he?function(i,r){return r instanceof he&&i.op===r.op&&i.field.isEqual(r.field)&&st(i.value,r.value)}(n,e):n instanceof Ye?function(i,r){return r instanceof Ye&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,a,u)=>s&&dm(a,r.filters[u]),!0):!1}(n,e):void F()}function fm(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${ti(t.value)}`}(n):n instanceof Ye?function(t){return t.op.toString()+" {"+t.getFilters().map(fm).join(" ,")+"}"}(n):"Filter"}var lu=class extends he{constructor(e,t,i){super(e,t,i),this.key=M.fromName(i.referenceValue)}matches(e){let t=M.comparator(e.key,this.key);return this.matchesComparison(t)}},hu=class extends he{constructor(e,t){super(e,"in",t),this.keys=pm("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},du=class extends he{constructor(e,t){super(e,"not-in",t),this.keys=pm("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function pm(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>M.fromName(i.referenceValue))}var fu=class extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ol(t)&&dr(t.arrayValue,this.value)}},pu=class extends he{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&dr(this.value.arrayValue,t)}},mu=class extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(dr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!dr(this.value.arrayValue,t)}},gu=class extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ol(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>dr(this.value.arrayValue,i))}};var _u=class{constructor(e,t=null,i=[],r=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=a,this.endAt=u,this.ue=null}};function Np(n,e=null,t=[],i=[],r=null,s=null,a=null){return new _u(n,e,t,i,r,s,a)}function xl(n){let e=U(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>uu(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),yo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>ti(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>ti(i)).join(",")),e.ue=t}return e.ue}function Vl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!mw(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!dm(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!kp(n.startAt,e.startAt)&&kp(n.endAt,e.endAt)}function yu(n){return M.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var gn=class{constructor(e,t=null,i=[],r=[],s=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function _w(n,e,t,i,r,s,a,u){return new gn(n,e,t,i,r,s,a,u)}function Ml(n){return new gn(n)}function Op(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function mm(n){return n.collectionGroup!==null}function ar(n){let e=U(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Ce(Be.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new ii(s,i))}),t.has(Be.keyField().canonicalString())||e.ce.push(new ii(Be.keyField(),i))}return e.ce}function it(n){let e=U(n);return e.le||(e.le=yw(e,ar(n))),e.le}function yw(n,e){if(n.limitType==="F")return Np(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new ii(r.field,s)});let t=n.endAt?new ni(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new ni(n.startAt.position,n.startAt.inclusive):null;return Np(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function vu(n,e){let t=n.filters.concat([e]);return new gn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Iu(n,e,t){return new gn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function vo(n,e){return Vl(it(n),it(e))&&n.limitType===e.limitType}function gm(n){return`${xl(it(n))}|lt:${n.limitType}`}function zn(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>fm(r)).join(", ")}]`),yo(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>ti(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>ti(r)).join(",")),`Target(${i})`}(it(n))}; limitType=${n.limitType})`}function Io(n,e){return e.isFoundDocument()&&function(i,r){let s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):M.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(let s of ar(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,r){for(let s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(a,u,h){let d=Pp(a,u,h);return a.inclusive?d<=0:d<0}(i.startAt,ar(i),r)||i.endAt&&!function(a,u,h){let d=Pp(a,u,h);return a.inclusive?d>=0:d>0}(i.endAt,ar(i),r))}(n,e)}function vw(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function _m(n){return(e,t)=>{let i=!1;for(let r of ar(n)){let s=Iw(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Iw(n,e,t){let i=n.field.isKeyField()?M.comparator(e.key,t.key):function(s,a,u){let h=a.data.field(s),d=u.data.field(s);return h!==null&&d!==null?ei(h,d):F()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return F()}}var $t=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){di(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return om(this.inner)}size(){return this.innerSize}};var Ew=new ce(M.comparator);function wt(){return Ew}var ym=new ce(M.comparator);function sr(...n){let e=ym;for(let t of n)e=e.insert(t.key,t);return e}function vm(n){let e=ym;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function ln(){return cr()}function Im(){return cr()}function cr(){return new $t(n=>n.toString(),(n,e)=>n.isEqual(e))}var ww=new ce(M.comparator),bw=new Ce(M.comparator);function K(...n){let e=bw;for(let t of n)e=e.add(t);return e}var Tw=new Ce(Y);function Aw(){return Tw}function Fl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lr(e)?"-0":e}}function Em(n){return{integerValue:""+n}}function Cw(n,e){return uw(e)?Em(e):Fl(n,e)}var ri=class{constructor(){this._=void 0}};function Sw(n,e,t){return n instanceof si?function(r,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&kl(s)&&(s=Nl(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof _n?bm(n,e):n instanceof yn?Tm(n,e):function(r,s){let a=wm(r,s),u=xp(a)+xp(r.Pe);return cu(a)&&cu(r.Pe)?Em(u):Fl(r.serializer,u)}(n,e)}function Dw(n,e,t){return n instanceof _n?bm(n,e):n instanceof yn?Tm(n,e):t}function wm(n,e){return n instanceof oi?function(i){return cu(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}var si=class extends ri{},_n=class extends ri{constructor(e){super(),this.elements=e}};function bm(n,e){let t=Am(e);for(let i of n.elements)t.some(r=>st(r,i))||t.push(i);return{arrayValue:{values:t}}}var yn=class extends ri{constructor(e){super(),this.elements=e}};function Tm(n,e){let t=Am(e);for(let i of n.elements)t=t.filter(r=>!st(r,i));return{arrayValue:{values:t}}}var oi=class extends ri{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function xp(n){return re(n.integerValue||n.doubleValue)}function Am(n){return Ol(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Rw(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof _n&&r instanceof _n||i instanceof yn&&r instanceof yn?Zn(i.elements,r.elements,st):i instanceof oi&&r instanceof oi?st(i.Pe,r.Pe):i instanceof si&&r instanceof si}(n.transform,e.transform)}var Eu=class{constructor(e,t){this.version=e,this.transformResults=t}},Bt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Bs(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ai=class{};function Cm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new fr(n.key,Bt.none()):new vn(n.key,n.data,Bt.none());{let t=n.data,i=He.empty(),r=new Ce(Be.comparator);for(let s of e.fields)if(!r.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?i.delete(s):i.set(s,a),r=r.add(s)}return new bt(n.key,i,new tt(r.toArray()),Bt.none())}}function Pw(n,e,t){n instanceof vn?function(r,s,a){let u=r.value.clone(),h=Mp(r.fieldTransforms,s,a.transformResults);u.setAll(h),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof bt?function(r,s,a){if(!Bs(r.precondition,s))return void s.convertToUnknownDocument(a.version);let u=Mp(r.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(Sm(r)),h.setAll(u),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(r,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function ur(n,e,t,i){return n instanceof vn?function(s,a,u,h){if(!Bs(s.precondition,a))return u;let d=s.value.clone(),p=Fp(s.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,i):n instanceof bt?function(s,a,u,h){if(!Bs(s.precondition,a))return u;let d=Fp(s.fieldTransforms,h,a),p=a.data;return p.setAll(Sm(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(n,e,t,i):function(s,a,u){return Bs(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function kw(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=wm(i.transform,r||null);s!=null&&(t===null&&(t=He.empty()),t.set(i.field,s))}return t||null}function Vp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Zn(i,r,(s,a)=>Rw(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var vn=class extends ai{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},bt=class extends ai{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Sm(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function Mp(n,e,t){let i=new Map;Z(n.length===t.length);for(let r=0;r<t.length;r++){let s=n[r],a=s.transform,u=e.data.field(s.field);i.set(s.field,Dw(a,u,t[r]))}return i}function Fp(n,e,t){let i=new Map;for(let r of n){let s=r.transform,a=t.data.field(r.field);i.set(r.field,Sw(s,a,e))}return i}var fr=class extends ai{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},wu=class extends ai{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var bu=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];s.key.isEqual(e.key)&&Pw(s,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=ur(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=ur(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=Im();return this.mutations.forEach(r=>{let s=e.get(r.key),a=s.overlayedDocument,u=this.applyToLocalView(a,s.mutatedFields);u=t.has(r.key)?null:u;let h=Cm(a,u);h!==null&&i.set(r.key,h),a.isValidDocument()||a.convertToNoDocument(j.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),K())}isEqual(e){return this.batchId===e.batchId&&Zn(this.mutations,e.mutations,(t,i)=>Vp(t,i))&&Zn(this.baseMutations,e.baseMutations,(t,i)=>Vp(t,i))}},Tu=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Z(e.mutations.length===i.length);let r=function(){return ww}(),s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,i[a].version);return new n(e,t,i,r)}};var Au=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Cu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ue,H;function Nw(n){switch(n){default:return F();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0}}function Dm(n){if(n===void 0)return It("GRPC error has no .code"),D.UNKNOWN;switch(n){case ue.OK:return D.OK;case ue.CANCELLED:return D.CANCELLED;case ue.UNKNOWN:return D.UNKNOWN;case ue.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case ue.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case ue.INTERNAL:return D.INTERNAL;case ue.UNAVAILABLE:return D.UNAVAILABLE;case ue.UNAUTHENTICATED:return D.UNAUTHENTICATED;case ue.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case ue.NOT_FOUND:return D.NOT_FOUND;case ue.ALREADY_EXISTS:return D.ALREADY_EXISTS;case ue.PERMISSION_DENIED:return D.PERMISSION_DENIED;case ue.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case ue.ABORTED:return D.ABORTED;case ue.OUT_OF_RANGE:return D.OUT_OF_RANGE;case ue.UNIMPLEMENTED:return D.UNIMPLEMENTED;case ue.DATA_LOSS:return D.DATA_LOSS;default:return F()}}(H=ue||(ue={}))[H.OK=0]="OK",H[H.CANCELLED=1]="CANCELLED",H[H.UNKNOWN=2]="UNKNOWN",H[H.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",H[H.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",H[H.NOT_FOUND=5]="NOT_FOUND",H[H.ALREADY_EXISTS=6]="ALREADY_EXISTS",H[H.PERMISSION_DENIED=7]="PERMISSION_DENIED",H[H.UNAUTHENTICATED=16]="UNAUTHENTICATED",H[H.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",H[H.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",H[H.ABORTED=10]="ABORTED",H[H.OUT_OF_RANGE=11]="OUT_OF_RANGE",H[H.UNIMPLEMENTED=12]="UNIMPLEMENTED",H[H.INTERNAL=13]="INTERNAL",H[H.UNAVAILABLE=14]="UNAVAILABLE",H[H.DATA_LOSS=15]="DATA_LOSS";var Lp=null;function Ow(){return new TextEncoder}var xw=new Ut([4294967295,4294967295],0);function Up(n){let e=Ow().encode(n),t=new jc;return t.update(e),new Uint8Array(t.digest())}function Bp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ut([t,i],0),new Ut([r,s],0)]}var Su=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new hn(`Invalid padding: ${t}`);if(i<0)throw new hn(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new hn(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new hn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ut.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply(Ut.fromNumber(i)));return r.compare(xw)===1&&(r=new Ut([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Up(e),[i,r]=Bp(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(i,r,s);if(!this.de(a))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,r,t);return i.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=Up(e),[i,r]=Bp(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(i,r,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},hn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Hs=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,pr.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(j.min(),r,new ce(Y),wt(),K())}},pr=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,K(),K(),K())}};var Qn=class{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}},Qs=class{constructor(e,t){this.targetId=e,this.me=t}},Ys=class{constructor(e,t,i=Se.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},Js=class{constructor(){this.fe=0,this.ge=qp(),this.pe=Se.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=K(),t=K(),i=K();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:F()}}),new pr(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=qp()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Du=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=wt(),this.qe=jp(),this.Qe=new ce(Y)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:F()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.ze(r)&&t(r)})}He(e){let t=e.targetId,i=e.me.count,r=this.Je(t);if(r){let s=r.target;if(yu(s))if(i===0){let a=new M(s.path);this.Ue(t,a,Qe.newNoDocument(a,j.min()))}else Z(i===1);else{let a=this.Ye(t);if(a!==i){let u=this.Ze(e),h=u?this.Xe(u,e,a):1;if(h!==0){this.je(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}Lp?.et(function(p,y,A,S,N){var O,P,q,$,G,ne;let De={localCacheCount:p,existenceFilterCount:y.count,databaseId:A.database,projectId:A.projectId},X=y.unchangedNames;return X&&(De.bloomFilter={applied:N===0,hashCount:(O=X?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:($=(q=(P=X?.bits)===null||P===void 0?void 0:P.bitmap)===null||q===void 0?void 0:q.length)!==null&&$!==void 0?$:0,padding:(ne=(G=X?.bits)===null||G===void 0?void 0:G.padding)!==null&&ne!==void 0?ne:0,mightContain:E=>{var m;return(m=S?.mightContain(E))!==null&&m!==void 0&&m}}),De}(a,e.me,this.Le.tt(),u,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,a,u;try{a=qt(i).toUint8Array()}catch(h){if(h instanceof zs)return Xn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Su(a,r,s)}catch(h){return Xn(h instanceof hn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){let i=this.Le.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),r++)}),r}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let u=this.Je(a);if(u){if(s.current&&yu(u.target)){let h=new M(u.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,Qe.newNoDocument(h,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let i=K();this.qe.forEach((s,a)=>{let u=!0;a.forEachWhile(h=>{let d=this.Je(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(i=i.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let r=new Hs(e,t,this.Qe,this.ke,i);return this.ke=wt(),this.qe=jp(),this.Qe=new ce(Y),r}$e(e,t){if(!this.ze(e))return;let i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;let r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Js,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ce(Y),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Js),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function jp(){return new ce(M.comparator)}function qp(){return new ce(M.comparator)}var Vw={asc:"ASCENDING",desc:"DESCENDING"},Mw={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fw={and:"AND",or:"OR"},Ru=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Pu(n,e){return n.useProto3Json||yo(e)?e:{value:e}}function Xs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Rm(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Lw(n,e){return Xs(n,e.toTimestamp())}function rt(n){return Z(!!n),j.fromTimestamp(function(t){let i=Et(t);return new ye(i.seconds,i.nanos)}(n))}function Ll(n,e){return ku(n,e).canonicalString()}function ku(n,e){let t=function(r){return new oe(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Pm(n){let e=oe.fromString(n);return Z(Vm(e)),e}function Nu(n,e){return Ll(n.databaseId,e.path)}function Kc(n,e){let t=Pm(e);if(t.get(1)!==n.databaseId.projectId)throw new x(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new M(Nm(t))}function km(n,e){return Ll(n.databaseId,e)}function Uw(n){let e=Pm(n);return e.length===4?oe.emptyPath():Nm(e)}function Ou(n){return new oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Nm(n){return Z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function $p(n,e,t){return{name:Nu(n,e),fields:t.value.mapValue.fields}}function Bw(n,e){let t;if("targetChange"in e){e.targetChange;let i=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:F()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(Z(p===void 0||typeof p=="string"),Se.fromBase64String(p||"")):(Z(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Se.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?D.UNKNOWN:Dm(d.code);return new x(p,d.message||"")}(a);t=new Ys(i,r,s,u||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=Kc(n,i.document.name),s=rt(i.document.updateTime),a=i.document.createTime?rt(i.document.createTime):j.min(),u=new He({mapValue:{fields:i.document.fields}}),h=Qe.newFoundDocument(r,s,a,u),d=i.targetIds||[],p=i.removedTargetIds||[];t=new Qn(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=Kc(n,i.document),s=i.readTime?rt(i.readTime):j.min(),a=Qe.newNoDocument(r,s),u=i.removedTargetIds||[];t=new Qn([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=Kc(n,i.document),s=i.removedTargetIds||[];t=new Qn([],s,r,null)}else{if(!("filter"in e))return F();{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,a=new Cu(r,s),u=i.targetId;t=new Qs(u,a)}}return t}function jw(n,e){let t;if(e instanceof vn)t={update:$p(n,e.key,e.value)};else if(e instanceof fr)t={delete:Nu(n,e.key)};else if(e instanceof bt)t={update:$p(n,e.key,e.data),updateMask:Yw(e.fieldMask)};else{if(!(e instanceof wu))return F();t={verify:Nu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,a){let u=a.transform;if(u instanceof si)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof _n)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof yn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof oi)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw F()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:Lw(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:F()}(n,e.precondition)),t}function qw(n,e){return n&&n.length>0?(Z(e!==void 0),n.map(t=>function(r,s){let a=r.updateTime?rt(r.updateTime):rt(s);return a.isEqual(j.min())&&(a=rt(s)),new Eu(a,r.transformResults||[])}(t,e))):[]}function $w(n,e){return{documents:[km(n,e.path)]}}function Gw(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=km(n,r);let s=function(d){if(d.length!==0)return xm(Ye.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(p=>function(A){return{field:Wn(A.field),direction:Kw(A.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Pu(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:r}}function zw(n){let e=Uw(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){Z(i===1);let p=t.from[0];p.allDescendants?r=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(y){let A=Om(y);return A instanceof Ye&&hm(A)?A.getFilters():[A]}(t.where));let a=[];t.orderBy&&(a=function(y){return y.map(A=>function(N){return new ii(Kn(N.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(A))}(t.orderBy));let u=null;t.limit&&(u=function(y){let A;return A=typeof y=="object"?y.value:y,yo(A)?null:A}(t.limit));let h=null;t.startAt&&(h=function(y){let A=!!y.before,S=y.values||[];return new ni(S,A)}(t.startAt));let d=null;return t.endAt&&(d=function(y){let A=!y.before,S=y.values||[];return new ni(S,A)}(t.endAt)),_w(e,r,a,s,u,"F",h,d)}function Ww(n,e){let t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return F()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Om(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=Kn(t.unaryFilter.field);return he.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=Kn(t.unaryFilter.field);return he.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Kn(t.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Kn(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});default:return F()}}(n):n.fieldFilter!==void 0?function(t){return he.create(Kn(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return F()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ye.create(t.compositeFilter.filters.map(i=>Om(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return F()}}(t.compositeFilter.op))}(n):F()}function Kw(n){return Vw[n]}function Hw(n){return Mw[n]}function Qw(n){return Fw[n]}function Wn(n){return{fieldPath:n.canonicalString()}}function Kn(n){return Be.fromServerFormat(n.fieldPath)}function xm(n){return n instanceof he?function(t){if(t.op==="=="){if(Rp(t.value))return{unaryFilter:{field:Wn(t.field),op:"IS_NAN"}};if(Dp(t.value))return{unaryFilter:{field:Wn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Rp(t.value))return{unaryFilter:{field:Wn(t.field),op:"IS_NOT_NAN"}};if(Dp(t.value))return{unaryFilter:{field:Wn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wn(t.field),op:Hw(t.op),value:t.value}}}(n):n instanceof Ye?function(t){let i=t.getFilters().map(r=>xm(r));return i.length===1?i[0]:{compositeFilter:{op:Qw(t.op),filters:i}}}(n):F()}function Yw(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Vm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var mr=class n{constructor(e,t,i,r,s=j.min(),a=j.min(),u=Se.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var xu=class{constructor(e){this.ct=e}};function Jw(n){let e=zw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Iu(e,e.limit,"L"):e}var Zs=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(re(e.integerValue));else if("doubleValue"in e){let i=re(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),lr(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=Et(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(qt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?cm(e)?this.dt(t,Number.MAX_SAFE_INTEGER):am(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):F()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let i=e.fields||{};this.dt(t,55);for(let r of Object.keys(i))this.Vt(r,t),this.Tt(i[r],t)}wt(e,t){var i,r;let s=e.fields||{};this.dt(t,53);let a="value",u=((r=(i=s[a].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.dt(t,15),t.At(re(u)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){let i=e.values||[];this.dt(t,50);for(let r of i)this.Tt(r,t)}yt(e,t){this.dt(t,37),M.fromName(e).path.forEach(i=>{this.dt(t,60),this.Dt(i,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Zs.vt=new Zs;var Vu=class{constructor(){this.un=new Mu}addToCollectionParentIndex(e,t){return this.un.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(pn.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(pn.min())}updateCollectionGroup(e,t,i){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},Mu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Ce(oe.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Ce(oe.comparator)).toArray()}};var pS=new Uint8Array(0);var et=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};et.DEFAULT_COLLECTION_PERCENTILE=10,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,et.DEFAULT=new et(41943040,et.DEFAULT_COLLECTION_PERCENTILE,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),et.DISABLED=new et(-1,0,0);var gr=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Fu=class{constructor(){this.changes=new $t(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?R.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Lu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Uu=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&ur(i.mutation,r,tt.empty(),ye.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,K()).next(()=>i))}getLocalViewOfDocuments(e,t,i=K()){let r=ln();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let a=sr();return s.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let i=ln();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,K()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,i,r){let s=wt(),a=cr(),u=function(){return cr()}();return t.forEach((h,d)=>{let p=i.get(d.key);r.has(d.key)&&(p===void 0||p.mutation instanceof bt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),ur(p.mutation,d,p.mutation.getFieldMask(),ye.now())):a.set(d.key,tt.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var y;return u.set(d,new Lu(p,(y=a.get(d))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,t){let i=cr(),r=new ce((a,u)=>a-u),s=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=i.get(h)||tt.empty();p=u.applyToLocalView(d,p),i.set(h,p);let y=(r.get(u.batchId)||K()).add(h);r=r.insert(u.batchId,y)})}).next(()=>{let a=[],u=r.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,y=Im();p.forEach(A=>{if(!s.has(A)){let S=Cm(t.get(A),i.get(A));S!==null&&y.set(A,S),s=s.add(A)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,y))}return R.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(a){return M.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):R.resolve(ln()),u=-1,h=s;return a.next(d=>R.forEach(d,(p,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),s.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(A=>{h=h.insert(p,A)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,h,d,K())).next(p=>({batchId:u,changes:vm(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new M(t)).next(i=>{let r=sr();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,a=sr();return this.indexManager.getCollectionParents(e,s).next(u=>R.forEach(u,h=>{let d=function(y,A){return new gn(A,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,i,r).next(p=>{p.forEach((y,A)=>{a=a.insert(y,A)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(a=>{s.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,Qe.newInvalidDocument(p)))});let u=sr();return a.forEach((h,d)=>{let p=s.get(h);p!==void 0&&ur(p.mutation,d,tt.empty(),ye.now()),Io(t,d)&&(u=u.insert(h,d))}),u})}};var Bu=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return R.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:rt(r.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(r){return{name:r.name,query:Jw(r.bundledQuery),readTime:rt(r.readTime)}}(t)),R.resolve()}};var ju=class{constructor(){this.overlays=new ce(M.comparator),this.Ir=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let i=ln();return R.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.ht(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Ir.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(i)),R.resolve()}getOverlaysForCollection(e,t,i){let r=ln(),s=t.length+1,a=new M(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&h.largestBatchId>i&&r.set(h.getKey(),h)}return R.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new ce((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>i){let p=s.get(d.largestBatchId);p===null&&(p=ln(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=ln(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=r)););return R.resolve(u)}ht(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let a=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new Au(t,i));let s=this.Ir.get(t);s===void 0&&(s=K(),this.Ir.set(t,s)),this.Ir.set(t,s.add(i.key))}};var qu=class{constructor(){this.sessionToken=Se.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var _r=class{constructor(){this.Tr=new Ce(le.Er),this.dr=new Ce(le.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let i=new le(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Vr(new le(e,t))}mr(e,t){e.forEach(i=>this.removeReference(i,t))}gr(e){let t=new M(new oe([])),i=new le(t,e),r=new le(t,e+1),s=[];return this.dr.forEachInRange([i,r],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new M(new oe([])),i=new le(t,e),r=new le(t,e+1),s=K();return this.dr.forEachInRange([i,r],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new le(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},le=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return M.comparator(e.key,t.key)||Y(e.wr,t.wr)}static Ar(e,t){return Y(e.wr,t.wr)||M.comparator(e.key,t.key)}};var $u=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ce(le.Er)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new bu(s,t,i,r);this.mutationQueue.push(a);for(let u of r)this.br=this.br.add(new le(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.vr(i),s=r<0?0:r;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new le(t,0),r=new le(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([i,r],a=>{let u=this.Dr(a.wr);s.push(u)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ce(Y);return t.forEach(r=>{let s=new le(r,0),a=new le(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],u=>{i=i.add(u.wr)})}),R.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;M.isDocumentKey(s)||(s=s.child(""));let a=new le(new M(s),0),u=new Ce(Y);return this.br.forEachWhile(h=>{let d=h.key.path;return!!i.isPrefixOf(d)&&(d.length===r&&(u=u.add(h.wr)),!0)},a),R.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(i=>{let r=this.Dr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Z(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return R.forEach(t.mutations,r=>{let s=new le(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=i})}On(e){}containsKey(e,t){let i=new le(t,0),r=this.br.firstAfterOrEqual(i);return R.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Gu=class{constructor(e){this.Mr=e,this.docs=function(){return new ce(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,a=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return R.resolve(i?i.document.mutableCopy():Qe.newInvalidDocument(t))}getEntries(e,t){let i=wt();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Qe.newInvalidDocument(r))}),R.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=wt(),a=t.path,u=new M(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||ow(sw(p),i)<=0||(r.has(p.key)||Io(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,i,r){F()}Or(e,t){return R.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new zu(this)}getSize(e){return R.resolve(this.size)}},zu=class extends Fu{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(i)}),R.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Wu=class{constructor(e){this.persistence=e,this.Nr=new $t(t=>xl(t),Vl),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.Lr=0,this.Br=new _r,this.targetCount=0,this.kr=gr.Bn()}forEachTarget(e,t){return this.Nr.forEach((i,r)=>t(r)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),R.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new gr(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Kn(t),R.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&i.get(u.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),r++)}),R.waitFor(s).next(()=>r)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let i=this.Nr.get(t)||null;return R.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),R.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(a=>{s.push(r.markPotentiallyOrphaned(e,a))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let i=this.Br.yr(t);return R.resolve(i)}containsKey(e,t){return R.resolve(this.Br.containsKey(t))}};var Ku=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new sm(0),this.Kr=!1,this.Kr=!0,this.$r=new qu,this.referenceDelegate=e(this),this.Ur=new Wu(this),this.indexManager=new Vu,this.remoteDocumentCache=function(r){return new Gu(r)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new xu(t),this.Gr=new Bu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ju,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new $u(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){V("MemoryPersistence","Starting transaction:",e);let r=new Hu(this.Qr.next());return this.referenceDelegate.zr(),i(r).next(s=>this.referenceDelegate.jr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Hr(e,t){return R.or(Object.values(this.qr).map(i=>()=>i.containsKey(e,t)))}},Hu=class extends su{constructor(e){super(),this.currentSequenceNumber=e}},Qu=class n{constructor(e){this.persistence=e,this.Jr=new _r,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw F()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),R.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(r=>this.Xr.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Xr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Xr,i=>{let r=M.fromPath(i);return this.ei(e,r).next(s=>{s||t.removeEntry(r,j.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return R.or([()=>R.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Yu=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=r}static Wi(e,t){let i=K(),r=K();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new n(e,t.fromCache,i,r)}};var Ju=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Xu=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return ff()?8:cw(me())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,r,i).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new Ju;return this.Xi(e,t,a).next(u=>{if(s.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>s.result)}es(e,t,i,r){return i.documentReadCount<this.ji?(rr()<=W.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",zn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),R.resolve()):(rr()<=W.DEBUG&&V("QueryEngine","Query:",zn(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(rr()<=W.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",zn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,it(t))):R.resolve())}Yi(e,t){if(Op(t))return R.resolve(null);let i=it(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Iu(t,null,"F"),i=it(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let a=K(...s);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,i).next(h=>{let d=this.ts(t,u);return this.ns(t,d,a,h.readTime)?this.Yi(e,Iu(t,null,"F")):this.rs(e,d,t,h)}))})))}Zi(e,t,i,r){return Op(t)||r.isEqual(j.min())?R.resolve(null):this.Ji.getDocuments(e,i).next(s=>{let a=this.ts(t,s);return this.ns(t,a,i,r)?R.resolve(null):(rr()<=W.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),zn(t)),this.rs(e,a,t,rw(r,-1)).next(u=>u))})}ts(e,t){let i=new Ce(_m(e));return t.forEach((r,s)=>{Io(e,s)&&(i=i.add(s))}),i}ns(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Xi(e,t,i){return rr()<=W.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",zn(t)),this.Ji.getDocumentsMatchingQuery(e,t,pn.min(),i)}rs(e,t,i,r){return this.Ji.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Zu=class{constructor(e,t,i,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new ce(Y),this._s=new $t(s=>xl(s),Vl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Uu(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function Xw(n,e,t,i){return new Zu(n,e,t,i)}function Mm(n,e){return v(this,null,function*(){let t=U(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.ls(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{let a=[],u=[],h=K();for(let d of r){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of s){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(i,h).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function Zw(n,e){let t=U(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let y=d.batch,A=y.keys(),S=R.resolve();return A.forEach(N=>{S=S.next(()=>p.getEntry(h,N)).next(O=>{let P=d.docVersions.get(N);Z(P!==null),O.version.compareTo(P)<0&&(y.applyToRemoteDocument(O,d),O.isValidDocument()&&(O.setReadTime(d.commitVersion),p.addEntry(O)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(h,y))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(u){let h=K();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function Fm(n){let e=U(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function eb(n,e){let t=U(n),i=e.snapshotVersion,r=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});r=t.os;let u=[];e.targetChanges.forEach((p,y)=>{let A=r.get(y);if(!A)return;u.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,y).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,y)));let S=A.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(y)!==null?S=S.withResumeToken(Se.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,i)),r=r.insert(y,S),function(O,P,q){return O.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8?!0:q.addedDocuments.size+q.modifiedDocuments.size+q.removedDocuments.size>0}(A,S,p)&&u.push(t.Ur.updateTargetData(s,S))});let h=wt(),d=K();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(tb(s,a,e.documentUpdates).next(p=>{h=p.Ps,d=p.Is})),!i.isEqual(j.min())){let p=t.Ur.getLastRemoteSnapshotVersion(s).next(y=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,i));u.push(p)}return R.waitFor(u).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,h,d)).next(()=>h)}).then(s=>(t.os=r,s))}function tb(n,e,t){let i=K(),r=K();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let a=wt();return t.forEach((u,h)=>{let d=s.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(r=r.add(u)),h.isNoDocument()&&h.version.isEqual(j.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):V("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ps:a,Is:r}})}function nb(n,e){let t=U(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function ib(n,e){let t=U(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Ur.getTargetData(i,e).next(s=>s?(r=s,R.resolve(r)):t.Ur.allocateTargetId(i).next(a=>(r=new mr(e,a,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i})}function el(n,e,t){return v(this,null,function*(){let i=U(n),r=i.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,a=>i.persistence.referenceDelegate.removeTarget(a,r)))}catch(a){if(!Tr(a))throw a;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}i.os=i.os.remove(e),i._s.delete(r.target)})}function Gp(n,e,t){let i=U(n),r=j.min(),s=K();return i.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let y=U(h),A=y._s.get(p);return A!==void 0?R.resolve(y.os.get(A)):y.Ur.getTargetData(d,p)}(i,a,it(e)).next(u=>{if(u)return r=u.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(a,u.targetId).next(h=>{s=h})}).next(()=>i.ss.getDocumentsMatchingQuery(a,e,t?r:j.min(),t?s:K())).next(u=>(rb(i,vw(e),u),{documents:u,Ts:s})))}function rb(n,e,t){let i=n.us.get(e)||j.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.us.set(e,i)}var eo=class{constructor(){this.activeTargetIds=Aw()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var tl=class{constructor(){this.so=new eo,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new eo,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var nl=class{_o(e){}shutdown(){}};var to=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ls=null;function Hc(){return Ls===null?Ls=function(){return 268435456+Math.round(2147483648*Math.random())}():Ls++,"0x"+Ls.toString(16)}var sb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var il=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ae="WebChannelConnection",rl=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${r}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Fo(){return!1}Mo(t,i,r,s,a){let u=Hc(),h=this.xo(t,i.toUriEncodedString());V("RestConnection",`Sending RPC '${t}' ${u}:`,h,r);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,a),this.No(t,h,d,r).then(p=>(V("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw Xn("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",h,"request:",r),p})}Lo(t,i,r,s,a,u){return this.Mo(t,i,r,s,a)}Oo(t,i,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+hi}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,a)=>t[a]=s),r&&r.headers.forEach((s,a)=>t[a]=s)}xo(t,i){let r=sb[t];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,r){let s=Hc();return new Promise((a,u)=>{let h=new qc;h.setWithCredentials(!0),h.listenOnce($c.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ir.NO_ERROR:let p=h.getResponseJson();V(Ae,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case ir.TIMEOUT:V(Ae,`RPC '${e}' ${s} timed out`),u(new x(D.DEADLINE_EXCEEDED,"Request time out"));break;case ir.HTTP_ERROR:let y=h.getStatus();if(V(Ae,`RPC '${e}' ${s} failed with status:`,y,"response text:",h.getResponseText()),y>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);let S=A?.error;if(S&&S.status&&S.message){let N=function(P){let q=P.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(q)>=0?q:D.UNKNOWN}(S.status);u(new x(N,S.message))}else u(new x(D.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new x(D.UNAVAILABLE,"Connection failed."));break;default:F()}}finally{V(Ae,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(r);V(Ae,`RPC '${e}' ${s} sending request:`,r),h.send(t,"POST",d,i,15)})}Bo(e,t,i){let r=Hc(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Wc(),u=zc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Oo(h.initMessageHeaders,t,i),h.encodeInitMessageHeaders=!0;let p=s.join("");V(Ae,`Creating RPC '${e}' stream ${r}: ${p}`,h);let y=a.createWebChannel(p,h),A=!1,S=!1,N=new il({Io:P=>{S?V(Ae,`Not sending because RPC '${e}' stream ${r} is closed:`,P):(A||(V(Ae,`Opening RPC '${e}' stream ${r} transport.`),y.open(),A=!0),V(Ae,`RPC '${e}' stream ${r} sending:`,P),y.send(P))},To:()=>y.close()}),O=(P,q,$)=>{P.listen(q,G=>{try{$(G)}catch(ne){setTimeout(()=>{throw ne},0)}})};return O(y,Gn.EventType.OPEN,()=>{S||(V(Ae,`RPC '${e}' stream ${r} transport opened.`),N.yo())}),O(y,Gn.EventType.CLOSE,()=>{S||(S=!0,V(Ae,`RPC '${e}' stream ${r} transport closed`),N.So())}),O(y,Gn.EventType.ERROR,P=>{S||(S=!0,Xn(Ae,`RPC '${e}' stream ${r} transport errored:`,P),N.So(new x(D.UNAVAILABLE,"The operation could not be completed")))}),O(y,Gn.EventType.MESSAGE,P=>{var q;if(!S){let $=P.data[0];Z(!!$);let G=$,ne=G.error||((q=G[0])===null||q===void 0?void 0:q.error);if(ne){V(Ae,`RPC '${e}' stream ${r} received error:`,ne);let De=ne.status,X=function(_){let I=ue[_];if(I!==void 0)return Dm(I)}(De),E=ne.message;X===void 0&&(X=D.INTERNAL,E="Unknown error status: "+De+" with message "+ne.message),S=!0,N.So(new x(X,E)),y.close()}else V(Ae,`RPC '${e}' stream ${r} received:`,$),N.bo($)}}),O(u,Gc.STAT_EVENT,P=>{P.stat===Ms.PROXY?V(Ae,`RPC '${e}' stream ${r} detected buffering proxy`):P.stat===Ms.NOPROXY&&V(Ae,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}};function Qc(){return typeof document<"u"?document:null}function Eo(n){return new Ru(n,!0)}var no=class{constructor(e,t,i=1e3,r=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=r,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-i);r>0&&V("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var io=class{constructor(e,t,i,r,s,a,u,h){this.ui=e,this.Ho=i,this.Jo=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new no(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return v(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return v(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return v(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===D.RESOURCE_EXHAUSTED?(It(t.toString()),It("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Yo===t&&this.P_(i,r)},i=>{e(()=>{let r=new x(D.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)})})}P_(e,t){let i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{i(()=>this.I_(r))}),this.stream.onMessage(r=>{i(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(()=>v(this,null,function*(){this.state=0,this.start()}))}I_(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},sl=class extends io{constructor(e,t,i,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=Bw(this.serializer,e),i=function(s){if(!("targetChange"in s))return j.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?rt(a.readTime):j.min()}(e);return this.listener.d_(t,i)}A_(e){let t={};t.database=Ou(this.serializer),t.addTarget=function(s,a){let u,h=a.target;if(u=yu(h)?{documents:$w(s,h)}:{query:Gw(s,h)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Rm(s,a.resumeToken);let d=Pu(s,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(j.min())>0){u.readTime=Xs(s,a.snapshotVersion.toTimestamp());let d=Pu(s,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let i=Ww(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){let t={};t.database=Ou(this.serializer),t.removeTarget=e,this.a_(t)}},ol=class extends io{constructor(e,t,i,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Z(!!e.streamToken),this.lastStreamToken=e.streamToken,Z(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=qw(e.writeResults,e.commitTime),i=rt(e.commitTime);return this.listener.g_(i,t)}p_(){let e={};e.database=Ou(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>jw(this.serializer,i))};this.a_(t)}};var al=class extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new x(D.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,ku(t,i),r,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new x(D.UNKNOWN,s.toString())})}Lo(e,t,i,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,ku(t,i),r,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(D.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},cl=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(It(t),this.D_=!1):V("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var ul=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{i.enqueueAndForget(()=>v(this,null,function*(){En(this)&&(V("RemoteStore","Restarting streams for network reachability change."),yield function(h){return v(this,null,function*(){let d=U(h);d.L_.add(4),yield Ar(d),d.q_.set("Unknown"),d.L_.delete(4),yield wo(d)})}(this))}))}),this.q_=new cl(i,r)}};function wo(n){return v(this,null,function*(){if(En(n))for(let e of n.B_)yield e(!0)})}function Ar(n){return v(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Lm(n,e){let t=U(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),ql(t)?jl(t):fi(t).r_()&&Bl(t,e))}function Ul(n,e){let t=U(n),i=fi(t);t.N_.delete(e),i.r_()&&Um(t,e),t.N_.size===0&&(i.r_()?i.o_():En(t)&&t.q_.set("Unknown"))}function Bl(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}fi(n).A_(e)}function Um(n,e){n.Q_.xe(e),fi(n).R_(e)}function jl(n){n.Q_=new Du({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),fi(n).start(),n.q_.v_()}function ql(n){return En(n)&&!fi(n).n_()&&n.N_.size>0}function En(n){return U(n).L_.size===0}function Bm(n){n.Q_=void 0}function ob(n){return v(this,null,function*(){n.q_.set("Online")})}function ab(n){return v(this,null,function*(){n.N_.forEach((e,t)=>{Bl(n,e)})})}function cb(n,e){return v(this,null,function*(){Bm(n),ql(n)?(n.q_.M_(e),jl(n)):n.q_.set("Unknown")})}function ub(n,e,t){return v(this,null,function*(){if(n.q_.set("Online"),e instanceof Ys&&e.state===2&&e.cause)try{yield function(r,s){return v(this,null,function*(){let a=s.cause;for(let u of s.targetIds)r.N_.has(u)&&(yield r.remoteSyncer.rejectListen(u,a),r.N_.delete(u),r.Q_.removeTarget(u))})}(n,e)}catch(i){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield ro(n,i)}else if(e instanceof Qn?n.Q_.Ke(e):e instanceof Qs?n.Q_.He(e):n.Q_.We(e),!t.isEqual(j.min()))try{let i=yield Fm(n.localStore);t.compareTo(i)>=0&&(yield function(s,a){let u=s.Q_.rt(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=s.N_.get(h);if(!p)return;s.N_.set(h,p.withResumeToken(Se.EMPTY_BYTE_STRING,p.snapshotVersion)),Um(s,h);let y=new mr(p.target,h,d,p.sequenceNumber);Bl(s,y)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(i){V("RemoteStore","Failed to raise snapshot:",i),yield ro(n,i)}})}function ro(n,e,t){return v(this,null,function*(){if(!Tr(e))throw e;n.L_.add(1),yield Ar(n),n.q_.set("Offline"),t||(t=()=>Fm(n.localStore)),n.asyncQueue.enqueueRetryable(()=>v(this,null,function*(){V("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield wo(n)}))})}function jm(n,e){return e().catch(t=>ro(n,t,e))}function bo(n){return v(this,null,function*(){let e=U(n),t=Gt(e),i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;lb(e);)try{let r=yield nb(e.localStore,i);if(r===null){e.O_.length===0&&t.o_();break}i=r.batchId,hb(e,r)}catch(r){yield ro(e,r)}qm(e)&&$m(e)})}function lb(n){return En(n)&&n.O_.length<10}function hb(n,e){n.O_.push(e);let t=Gt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function qm(n){return En(n)&&!Gt(n).n_()&&n.O_.length>0}function $m(n){Gt(n).start()}function db(n){return v(this,null,function*(){Gt(n).p_()})}function fb(n){return v(this,null,function*(){let e=Gt(n);for(let t of n.O_)e.m_(t.mutations)})}function pb(n,e,t){return v(this,null,function*(){let i=n.O_.shift(),r=Tu.from(i,e,t);yield jm(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield bo(n)})}function mb(n,e){return v(this,null,function*(){e&&Gt(n).V_&&(yield function(i,r){return v(this,null,function*(){if(function(a){return Nw(a)&&a!==D.ABORTED}(r.code)){let s=i.O_.shift();Gt(i).s_(),yield jm(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),yield bo(i)}})}(n,e)),qm(n)&&$m(n)})}function zp(n,e){return v(this,null,function*(){let t=U(n);t.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");let i=En(t);t.L_.add(3),yield Ar(t),i&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield wo(t)})}function gb(n,e){return v(this,null,function*(){let t=U(n);e?(t.L_.delete(2),yield wo(t)):e||(t.L_.add(2),yield Ar(t),t.q_.set("Unknown"))})}function fi(n){return n.K_||(n.K_=function(t,i,r){let s=U(t);return s.w_(),new sl(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:ob.bind(null,n),Ro:ab.bind(null,n),mo:cb.bind(null,n),d_:ub.bind(null,n)}),n.B_.push(e=>v(this,null,function*(){e?(n.K_.s_(),ql(n)?jl(n):n.q_.set("Unknown")):(yield n.K_.stop(),Bm(n))}))),n.K_}function Gt(n){return n.U_||(n.U_=function(t,i,r){let s=U(t);return s.w_(),new ol(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:db.bind(null,n),mo:mb.bind(null,n),f_:fb.bind(null,n),g_:pb.bind(null,n)}),n.B_.push(e=>v(this,null,function*(){e?(n.U_.s_(),yield bo(n)):(yield n.U_.stop(),n.O_.length>0&&(V("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var ll=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new vt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let a=Date.now()+i,u=new n(e,t,a,r,s);return u.start(i),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function $l(n,e){if(It("AsyncQueue",`${e}: ${n}`),Tr(n))return new x(D.UNAVAILABLE,`${e}: ${n}`);throw n}var so=class n{constructor(e){this.comparator=e?(t,i)=>e(t,i)||M.comparator(t.key,i.key):(t,i)=>M.comparator(t.key,i.key),this.keyedMap=sr(),this.sortedSet=new ce(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var oo=class{constructor(){this.W_=new ce(M.comparator)}track(e){let t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):F():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,i)=>{e.push(i)}),e}},ci=class n{constructor(e,t,i,r,s,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,i,r,s){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,so.emptySet(t),a,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var hl=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},dl=class{constructor(){this.queries=Wp(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){let r=U(t),s=r.queries;r.queries=Wp(),s.forEach((a,u)=>{for(let h of u.j_)h.onError(i)})})(this,new x(D.ABORTED,"Firestore shutting down"))}};function Wp(){return new $t(n=>gm(n),vo)}function _b(n,e){return v(this,null,function*(){let t=U(n),i=3,r=e.query,s=t.queries.get(r);s?!s.H_()&&e.J_()&&(i=2):(s=new hl,i=e.J_()?0:1);try{switch(i){case 0:s.z_=yield t.onListen(r,!0);break;case 1:s.z_=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(a){let u=$l(a,`Initialization of query '${zn(e.query)}' failed`);return void e.onError(u)}t.queries.set(r,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Gl(t)})}function yb(n,e){return v(this,null,function*(){let t=U(n),i=e.query,r=3,s=t.queries.get(i);if(s){let a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?r=e.J_()?0:1:!s.H_()&&e.J_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function vb(n,e){let t=U(n),i=!1;for(let r of e){let s=r.query,a=t.queries.get(s);if(a){for(let u of a.j_)u.X_(r)&&(i=!0);a.z_=r}}i&&Gl(t)}function Ib(n,e,t){let i=U(n),r=i.queries.get(e);if(r)for(let s of r.j_)s.onError(t);i.queries.delete(e)}function Gl(n){n.Y_.forEach(e=>{e.next()})}var fl,Kp;(Kp=fl||(fl={})).ea="default",Kp.Cache="cache";var pl=class{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new ci(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ci.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==fl.Cache}};var ao=class{constructor(e){this.key=e}},co=class{constructor(e){this.key=e}},ml=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=K(),this.mutatedKeys=K(),this.Aa=_m(e),this.Ra=new so(this.Aa)}get Va(){return this.Ta}ma(e,t){let i=t?t.fa:new oo,r=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,a=r,u=!1,h=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,d=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((p,y)=>{let A=r.get(p),S=Io(this.query,y)?y:null,N=!!A&&this.mutatedKeys.has(A.key),O=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),P=!1;A&&S?A.data.isEqual(S.data)?N!==O&&(i.track({type:3,doc:S}),P=!0):this.ga(A,S)||(i.track({type:2,doc:S}),P=!0,(h&&this.Aa(S,h)>0||d&&this.Aa(S,d)<0)&&(u=!0)):!A&&S?(i.track({type:0,doc:S}),P=!0):A&&!S&&(i.track({type:1,doc:A}),P=!0,(h||d)&&(u=!0)),P&&(S?(a=a.add(S),s=O?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),i.track({type:1,doc:p})}return{Ra:a,fa:i,ns:u,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,y)=>function(S,N){let O=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return F()}};return O(S)-O(N)}(p.type,y.type)||this.Aa(p.doc,y.doc)),this.pa(i),r=r!=null&&r;let u=t&&!r?this.ya():[],h=this.da.size===0&&this.current&&!r?1:0,d=h!==this.Ea;return this.Ea=h,a.length!==0||d?{snapshot:new ci(this.query,e.Ra,s,a,e.mutatedKeys,h===0,d,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new oo,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=K(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});let t=[];return e.forEach(i=>{this.da.has(i)||t.push(new co(i))}),this.da.forEach(i=>{e.has(i)||t.push(new ao(i))}),t}ba(e){this.Ta=e.Ts,this.da=K();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ci.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},gl=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},_l=class{constructor(e){this.key=e,this.va=!1}},yl=class{constructor(e,t,i,r,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new $t(u=>gm(u),vo),this.Ma=new Map,this.xa=new Set,this.Oa=new ce(M.comparator),this.Na=new Map,this.La=new _r,this.Ba={},this.ka=new Map,this.qa=gr.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function Eb(n,e,t=!0){return v(this,null,function*(){let i=Qm(n),r,s=i.Fa.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Da()):r=yield Gm(i,e,t,!0),r})}function wb(n,e){return v(this,null,function*(){let t=Qm(n);yield Gm(t,e,!0,!1)})}function Gm(n,e,t,i){return v(this,null,function*(){let r=yield ib(n.localStore,it(e)),s=r.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),u;return i&&(u=yield bb(n,e,s,a==="current",r.resumeToken)),n.isPrimaryClient&&t&&Lm(n.remoteStore,r),u})}function bb(n,e,t,i,r){return v(this,null,function*(){n.Ka=(y,A,S)=>function(O,P,q,$){return v(this,null,function*(){let G=P.view.ma(q);G.ns&&(G=yield Gp(O.localStore,P.query,!1).then(({documents:E})=>P.view.ma(E,G)));let ne=$&&$.targetChanges.get(P.targetId),De=$&&$.targetMismatches.get(P.targetId)!=null,X=P.view.applyChanges(G,O.isPrimaryClient,ne,De);return Qp(O,P.targetId,X.wa),X.snapshot})}(n,y,A,S);let s=yield Gp(n.localStore,e,!0),a=new ml(e,s.Ts),u=a.ma(s.documents),h=pr.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),d=a.applyChanges(u,n.isPrimaryClient,h);Qp(n,t,d.wa);let p=new gl(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function Tb(n,e,t){return v(this,null,function*(){let i=U(n),r=i.Fa.get(e),s=i.Ma.get(r.targetId);if(s.length>1)return i.Ma.set(r.targetId,s.filter(a=>!vo(a,e))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield el(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Ul(i.remoteStore,r.targetId),vl(i,r.targetId)}).catch(br))):(vl(i,r.targetId),yield el(i.localStore,r.targetId,!0))})}function Ab(n,e){return v(this,null,function*(){let t=U(n),i=t.Fa.get(e),r=t.Ma.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Ul(t.remoteStore,i.targetId))})}function Cb(n,e,t){return v(this,null,function*(){let i=Ob(n);try{let r=yield function(a,u){let h=U(a),d=ye.now(),p=u.reduce((S,N)=>S.add(N.key),K()),y,A;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let N=wt(),O=K();return h.cs.getEntries(S,p).next(P=>{N=P,N.forEach((q,$)=>{$.isValidDocument()||(O=O.add(q))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,N)).next(P=>{y=P;let q=[];for(let $ of u){let G=kw($,y.get($.key).overlayedDocument);G!=null&&q.push(new bt($.key,G,um(G.value.mapValue),Bt.exists(!0)))}return h.mutationQueue.addMutationBatch(S,d,q,u)}).next(P=>{A=P;let q=P.applyToLocalDocumentSet(y,O);return h.documentOverlayCache.saveOverlays(S,P.batchId,q)})}).then(()=>({batchId:A.batchId,changes:vm(y)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(a,u,h){let d=a.Ba[a.currentUser.toKey()];d||(d=new ce(Y)),d=d.insert(u,h),a.Ba[a.currentUser.toKey()]=d}(i,r.batchId,t),yield Cr(i,r.changes),yield bo(i.remoteStore)}catch(r){let s=$l(r,"Failed to persist write");t.reject(s)}})}function zm(n,e){return v(this,null,function*(){let t=U(n);try{let i=yield eb(t.localStore,e);e.targetChanges.forEach((r,s)=>{let a=t.Na.get(s);a&&(Z(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?a.va=!0:r.modifiedDocuments.size>0?Z(a.va):r.removedDocuments.size>0&&(Z(a.va),a.va=!1))}),yield Cr(t,i,e)}catch(i){yield br(i)}})}function Hp(n,e,t){let i=U(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Fa.forEach((s,a)=>{let u=a.view.Z_(e);u.snapshot&&r.push(u.snapshot)}),function(a,u){let h=U(a);h.onlineState=u;let d=!1;h.queries.forEach((p,y)=>{for(let A of y.j_)A.Z_(u)&&(d=!0)}),d&&Gl(h)}(i.eventManager,e),r.length&&i.Ca.d_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function Sb(n,e,t){return v(this,null,function*(){let i=U(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Na.get(e),s=r&&r.key;if(s){let a=new ce(M.comparator);a=a.insert(s,Qe.newNoDocument(s,j.min()));let u=K().add(s),h=new Hs(j.min(),new Map,new ce(Y),a,u);yield zm(i,h),i.Oa=i.Oa.remove(s),i.Na.delete(e),zl(i)}else yield el(i.localStore,e,!1).then(()=>vl(i,e,t)).catch(br)})}function Db(n,e){return v(this,null,function*(){let t=U(n),i=e.batch.batchId;try{let r=yield Zw(t.localStore,e);Km(t,i,null),Wm(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield Cr(t,r)}catch(r){yield br(r)}})}function Rb(n,e,t){return v(this,null,function*(){let i=U(n);try{let r=yield function(a,u){let h=U(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(y=>(Z(y!==null),p=y.keys(),h.mutationQueue.removeMutationBatch(d,y))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(i.localStore,e);Km(i,e,t),Wm(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield Cr(i,r)}catch(r){yield br(r)}})}function Wm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Km(n,e,t){let i=U(n),r=i.Ba[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Ba[i.currentUser.toKey()]=r}}function vl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(i=>{n.La.containsKey(i)||Hm(n,i)})}function Hm(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Ul(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),zl(n))}function Qp(n,e,t){for(let i of t)i instanceof ao?(n.La.addReference(i.key,e),Pb(n,i)):i instanceof co?(V("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||Hm(n,i.key)):F()}function Pb(n,e){let t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(V("SyncEngine","New document in limbo: "+t),n.xa.add(i),zl(n))}function zl(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new M(oe.fromString(e)),i=n.qa.next();n.Na.set(i,new _l(t)),n.Oa=n.Oa.insert(t,i),Lm(n.remoteStore,new mr(it(Ml(t.path)),i,"TargetPurposeLimboResolution",sm.oe))}}function Cr(n,e,t){return v(this,null,function*(){let i=U(n),r=[],s=[],a=[];i.Fa.isEmpty()||(i.Fa.forEach((u,h)=>{a.push(i.Ka(h,e,t).then(d=>{var p;if((d||t)&&i.isPrimaryClient){let y=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;i.sharedClientState.updateQueryState(h.targetId,y?"current":"not-current")}if(d){r.push(d);let y=Yu.Wi(h.targetId,d);s.push(y)}}))}),yield Promise.all(a),i.Ca.d_(r),yield function(h,d){return v(this,null,function*(){let p=U(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>R.forEach(d,A=>R.forEach(A.$i,S=>p.persistence.referenceDelegate.addReference(y,A.targetId,S)).next(()=>R.forEach(A.Ui,S=>p.persistence.referenceDelegate.removeReference(y,A.targetId,S)))))}catch(y){if(!Tr(y))throw y;V("LocalStore","Failed to update sequence numbers: "+y)}for(let y of d){let A=y.targetId;if(!y.fromCache){let S=p.os.get(A),N=S.snapshotVersion,O=S.withLastLimboFreeSnapshotVersion(N);p.os=p.os.insert(A,O)}}})}(i.localStore,s))})}function kb(n,e){return v(this,null,function*(){let t=U(n);if(!t.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());let i=yield Mm(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(u=>{u.forEach(h=>{h.reject(new x(D.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield Cr(t,i.hs)}})}function Nb(n,e){let t=U(n),i=t.Na.get(e);if(i&&i.va)return K().add(i.key);{let r=K(),s=t.Ma.get(e);if(!s)return r;for(let a of s){let u=t.Fa.get(a);r=r.unionWith(u.view.Va)}return r}}function Qm(n){let e=U(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=zm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Nb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Sb.bind(null,e),e.Ca.d_=vb.bind(null,e.eventManager),e.Ca.$a=Ib.bind(null,e.eventManager),e}function Ob(n){let e=U(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Db.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Rb.bind(null,e),e}var Yp=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return v(this,null,function*(){this.serializer=Eo(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,i){return null}Ha(t,i){return null}za(t){return Xw(this.persistence,new Xu,t.initialUser,this.serializer)}Ga(t){return new Ku(Qu.Zr,this.serializer)}Wa(t){return new tl}terminate(){return v(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var xb=(()=>{class n{initialize(t,i){return v(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Hp(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=kb.bind(null,this.syncEngine),yield gb(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new dl}()}createDatastore(t){let i=Eo(t.databaseInfo.databaseId),r=function(a){return new rl(a)}(t.databaseInfo);return function(a,u,h,d){return new al(a,u,h,d)}(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return function(r,s,a,u,h){return new ul(r,s,a,u,h)}(this.localStore,this.datastore,t.asyncQueue,i=>Hp(this.syncEngine,i,0),function(){return to.D()?new to:new nl}())}createSyncEngine(t,i){return function(s,a,u,h,d,p,y){let A=new yl(s,a,u,h,d,p);return y&&(A.Qa=!0),A}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return v(this,null,function*(){var t,i;yield function(s){return v(this,null,function*(){let a=U(s);V("RemoteStore","RemoteStore shutting down."),a.L_.add(5),yield Ar(a),a.k_.shutdown(),a.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}return n.provider={build:()=>new n},n})();var Il=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):It("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var El=class{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=ge.UNAUTHENTICATED,this.clientId=qs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,a=>v(this,null,function*(){V("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(i,a=>(V("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new vt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=$l(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function Yc(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>v(this,null,function*(){i.isEqual(r)||(yield Mm(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Jp(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Vb(n);V("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>zp(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>zp(e.remoteStore,r)),n._onlineComponents=e})}function Vb(n){return v(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Yc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(r){return r.name==="FirebaseError"?r.code===D.FAILED_PRECONDITION||r.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Xn("Error using user provided cache. Falling back to memory cache: "+t),yield Yc(n,new Yp)}}else V("FirestoreClient","Using default OfflineComponentProvider"),yield Yc(n,new Yp);return n._offlineComponents})}function Ym(n){return v(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V("FirestoreClient","Using user provided OnlineComponentProvider"),yield Jp(n,n._uninitializedComponentsProvider._online)):(V("FirestoreClient","Using default OnlineComponentProvider"),yield Jp(n,new xb))),n._onlineComponents})}function Mb(n){return Ym(n).then(e=>e.syncEngine)}function Xp(n){return v(this,null,function*(){let e=yield Ym(n),t=e.eventManager;return t.onListen=Eb.bind(null,e.syncEngine),t.onUnlisten=Tb.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wb.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Ab.bind(null,e.syncEngine),t})}function Jm(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Zp=new Map;function Xm(n,e,t){if(!t)throw new x(D.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Fb(n,e,t,i){if(e===!0&&i===!0)throw new x(D.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function em(n){if(!M.isDocumentKey(n))throw new x(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function tm(n){if(M.isDocumentKey(n))throw new x(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function To(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":F()}function Yn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=To(n);throw new x(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var uo=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new x(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new x(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Fb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Jm((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new x(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new x(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new x(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ui=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uo({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uo(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Jc;switch(i.type){case"firstParty":return new tu(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new x(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return v(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let i=Zp.get(t);i&&(V("ComponentProvider","Removing Datastore"),Zp.delete(t),i.terminate())}(this),Promise.resolve()}};function Zm(n,e,t,i={}){var r;let s=(n=Yn(n,ui))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Xn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),i.mockUserToken){let u,h;if(typeof i.mockUserToken=="string")u=i.mockUserToken,h=ge.MOCK_USER;else{u=af(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let d=i.mockUserToken.sub||i.mockUserToken.user_id;if(!d)throw new x(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ge(d)}n._authCredentials=new Xc(new js(u,h))}}var li=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},je=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},jt=class n extends li{constructor(e,t,i){super(e,t,Ml(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new je(this.firestore,null,new M(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function eg(n,e,...t){if(n=ke(n),Xm("collection","path",e),n instanceof ui){let i=oe.fromString(e,...t);return tm(i),new jt(n,null,i)}{if(!(n instanceof je||n instanceof jt))throw new x(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(oe.fromString(e,...t));return tm(i),new jt(n.firestore,null,i)}}function Wl(n,e,...t){if(n=ke(n),arguments.length===1&&(e=qs.newId()),Xm("doc","path",e),n instanceof ui){let i=oe.fromString(e,...t);return em(i),new je(n,null,new M(i))}{if(!(n instanceof je||n instanceof jt))throw new x(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(oe.fromString(e,...t));return em(i),new je(n.firestore,n instanceof jt?n.converter:null,new M(i))}}var lo=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new no(this,"async_queue_retry"),this.Vu=()=>{let i=Qc();i&&V("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;let t=Qc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Qc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new vt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return v(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Tr(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(i=>{this.Eu=i,this.du=!1;let r=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(i);throw It("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let r=ll.createAndSchedule(this,e,t,i,s=>this.yu(s));return this.Tu.push(r),r}fu(){this.Eu&&F()}verifyOperationInProgress(){}wu(){return v(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function nm(n){return function(t,i){if(typeof t!="object"||t===null)return!1;let r=t;for(let s of i)if(s in r&&typeof r[s]=="function")return!0;return!1}(n,["next","error","complete"])}var In=class extends ui{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new lo,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return v(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new lo(e),this._firestoreClient=void 0,yield e}})}};function tg(n,e){let t=typeof n=="object"?n:Ln(),i=typeof n=="string"?n:e||"(default)",r=Ki(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let s=of("firestore");s&&Zm(r,...s)}return r}function ng(n){if(n._terminated)throw new x(D.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Lb(n),n._firestoreClient}function Lb(n){var e,t,i;let r=n._freezeSettings(),s=function(u,h,d,p){return new ou(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Jm(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new El(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(u){let h=u?._online.build();return{_offline:u?._offline.build(h),_online:h}}(n._componentsProvider))}var yr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Se.fromBase64String(e))}catch(t){throw new x(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Se.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var vr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Be(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ho=class{constructor(e){this._methodName=e}};var Ir=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}};var Er=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,e._values)}};var Ub=/^__.*__$/,wl=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new bt(e,this.data,this.fieldMask,t,this.fieldTransforms):new vn(e,this.data,t,this.fieldTransforms)}};function ig(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F()}}var bl=class n{constructor(e,t,i,r,s,a){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.Ou(e),r}Nu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return fo(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(ig(this.Cu)&&Ub.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Tl=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Eo(e)}Qu(e,t,i,r=!1){return new bl({Cu:e,methodName:t,qu:i,path:Be.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function rg(n){let e=n._freezeSettings(),t=Eo(n._databaseId);return new Tl(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Bb(n,e,t,i,r,s={}){let a=n.Qu(s.merge||s.mergeFields?2:0,e,t,r);ag("Data must be an object, but it was:",a,i);let u=sg(i,a),h,d;if(s.merge)h=new tt(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let y of s.mergeFields){let A=qb(e,y,t);if(!a.contains(A))throw new x(D.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);Gb(p,A)||p.push(A)}h=new tt(p),d=a.fieldTransforms.filter(y=>h.covers(y.field))}else h=null,d=a.fieldTransforms;return new wl(new He(u),h,d)}function jb(n,e,t,i=!1){return Kl(t,n.Qu(i?4:3,e))}function Kl(n,e){if(og(n=ke(n)))return ag("Unsupported field value:",e,n),sg(n,e);if(n instanceof ho)return function(i,r){if(!ig(r.Cu))throw r.Bu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${i._methodName}() is not currently supported inside arrays`);let s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(i,r){let s=[],a=0;for(let u of i){let h=Kl(u,r.Lu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if((i=ke(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Cw(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let s=ye.fromDate(i);return{timestampValue:Xs(r.serializer,s)}}if(i instanceof ye){let s=new ye(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Xs(r.serializer,s)}}if(i instanceof Ir)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof yr)return{bytesValue:Rm(r.serializer,i._byteString)};if(i instanceof je){let s=r.databaseId,a=i.firestore._databaseId;if(!a.isEqual(s))throw r.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ll(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Er)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Bu("VectorValues must only contain numeric values.");return Fl(u.serializer,h)})}}}}}}(i,r);throw r.Bu(`Unsupported field value: ${To(i)}`)}(n,e)}function sg(n,e){let t={};return om(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):di(n,(i,r)=>{let s=Kl(r,e.Mu(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function og(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ye||n instanceof Ir||n instanceof yr||n instanceof je||n instanceof ho||n instanceof Er)}function ag(n,e,t){if(!og(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let i=To(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function qb(n,e,t){if((e=ke(e))instanceof vr)return e._internalPath;if(typeof e=="string")return cg(n,e);throw fo("Field path arguments must be of type string or ",n,!1,void 0,t)}var $b=new RegExp("[~\\*/\\[\\]]");function cg(n,e,t){if(e.search($b)>=0)throw fo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new vr(...e.split("."))._internalPath}catch{throw fo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fo(n,e,t,i,r){let s=i&&!i.isEmpty(),a=r!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${i}`),a&&(h+=` in document ${r}`),h+=")"),new x(D.INVALID_ARGUMENT,u+n+h)}function Gb(n,e){return n.some(t=>t.isEqual(e))}var po=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Al(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Hl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Al=class extends po{data(){return super.data()}};function Hl(n,e){return typeof e=="string"?cg(n,e):e instanceof vr?e._internalPath:e._delegate._internalPath}function zb(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var wr=class{},Cl=class extends wr{};function ug(n,e,...t){let i=[];e instanceof wr&&i.push(e),i=i.concat(t),function(s){let a=s.filter(h=>h instanceof Sl).length,u=s.filter(h=>h instanceof mo).length;if(a>1||a>0&&u>0)throw new x(D.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(let r of i)n=r._apply(n);return n}var mo=class n extends Cl{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return hg(e._query,t),new li(e.firestore,e.converter,vu(e._query,t))}_parse(e){let t=rg(e.firestore);return function(s,a,u,h,d,p,y){let A;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new x(D.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){rm(y,p);let S=[];for(let N of y)S.push(im(h,s,N));A={arrayValue:{values:S}}}else A=im(h,s,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||rm(y,p),A=jb(u,a,y,p==="in"||p==="not-in");return he.create(d,p,A)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function lg(n,e,t){let i=e,r=Hl("where",n);return mo._create(r,i,t)}var Sl=class n extends wr{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Ye.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let a=r,u=s.getFlattenedFilters();for(let h of u)hg(a,h),a=vu(a,h)}(e._query,t),new li(e.firestore,e.converter,vu(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function im(n,e,t){if(typeof(t=ke(t))=="string"){if(t==="")throw new x(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mm(e)&&t.indexOf("/")!==-1)throw new x(D.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(oe.fromString(t));if(!M.isDocumentKey(i))throw new x(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Sp(n,new M(i))}if(t instanceof je)return Sp(n,t._key);throw new x(D.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${To(t)}.`)}function rm(n,e){if(!Array.isArray(n)||n.length===0)throw new x(D.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hg(n,e){let t=function(r,s){for(let a of r)for(let u of a.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new x(D.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new x(D.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Dl=class{convertValue(e,t="none"){switch(mn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return re(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(qt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw F()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return di(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,r;let s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(a=>re(a.doubleValue));return new Er(s)}convertGeoPoint(e){return new Ir(re(e.latitude),re(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Nl(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(hr(e));default:return null}}convertTimestamp(e){let t=Et(e);return new ye(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=oe.fromString(e);Z(Vm(i));let r=new Ws(i.get(1),i.get(3)),s=new M(i.popFirst(5));return r.isEqual(t)||It(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Wb(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var dn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},go=class extends po{constructor(e,t,i,r,s,a){super(e,t,i,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Jn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(Hl("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},Jn=class extends go{data(e={}){return super.data(e)}},Rl=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new dn(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Jn(this._firestore,this._userDataWriter,i.key,i,new dn(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(u=>{let h=new Jn(r._firestore,r._userDataWriter,u.doc.key,u.doc,new dn(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let h=new Jn(r._firestore,r._userDataWriter,u.doc.key,u.doc,new dn(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:Kb(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Kb(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return F()}}var _o=class extends Dl{constructor(e){super(),this.firestore=e}convertBytes(e){return new yr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,t)}};function dg(n){return pg(Yn(n.firestore,In),[new fr(n._key,Bt.none())])}function fg(n,e){let t=Yn(n.firestore,In),i=Wl(n),r=Wb(n.converter,e);return pg(t,[Bb(rg(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Bt.exists(!1))]).then(()=>i)}function Ql(n,...e){var t,i,r;n=ke(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||nm(e[a])||(s=e[a],a++);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(nm(e[a])){let y=e[a];e[a]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[a+1]=(i=y.error)===null||i===void 0?void 0:i.bind(y),e[a+2]=(r=y.complete)===null||r===void 0?void 0:r.bind(y)}let h,d,p;if(n instanceof je)d=Yn(n.firestore,In),p=Ml(n._key.path),h={next:y=>{e[a]&&e[a](Hb(d,n,y))},error:e[a+1],complete:e[a+2]};else{let y=Yn(n,li);d=Yn(y.firestore,In),p=y._query;let A=new _o(d);h={next:S=>{e[a]&&e[a](new Rl(d,A,y,S))},error:e[a+1],complete:e[a+2]},zb(n._query)}return function(A,S,N,O){let P=new Il(O),q=new pl(S,P,N);return A.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return _b(yield Xp(A),q)})),()=>{P.Za(),A.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return yb(yield Xp(A),q)}))}}(ng(d),p,u,h)}function pg(n,e){return function(i,r){let s=new vt;return i.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return Cb(yield Mb(i),r,s)})),s.promise}(ng(n),e)}function Hb(n,e,t){let i=t.docs.get(e._key),r=new _o(n);return new go(n,r,e._key,i,new dn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){hi=r})(Vt),xt(new ze("firestore",(i,{instanceIdentifier:r,options:s})=>{let a=i.getProvider("app").getImmediate(),u=new In(new Zc(i.getProvider("auth-internal")),new iu(i.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new x(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ws(d.options.projectId,p)}(a,r),a);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),fe(bp,"4.7.3",e),fe(bp,"4.7.3","esm2017")})();var Ao=function(){return Ao=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ao.apply(this,arguments)};var Jb={includeMetadataChanges:!1};function mg(n,e){return e===void 0&&(e=Jb),new Pt(function(t){var i=Ql(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:i}})}function gg(n,e){var t;e===void 0&&(e={});var i=n.data(e);return!n.exists()||typeof i!="object"||i===null||!e.idField?i:Ao(Ao({},i),(t={},t[e.idField]=n.id,t))}function _g(n){return mg(n,{includeMetadataChanges:!0}).pipe(Je(function(e){return e.docs}))}function yg(n,e){return e===void 0&&(e={}),_g(n).pipe(Je(function(t){return t.map(function(i){return gg(i,e)})}))}var Sr=class{constructor(e){return e}},vg="firestore",Yl=class{constructor(){return Hi(vg)}};var Jl=new te("angularfire2.firestore-instances");function Xb(n,e){let t=gs(vg,n,e);return t&&new Sr(t)}function Zb(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Sr(i)}}var eT={provide:Yl,deps:[[new $e,Jl]]},tT={provide:Sr,useFactory:Xb,deps:[[new $e,Jl],mt]};function WD(n,...e){return fe("angularfire",rn.full,"fst"),Nn([tT,eT,{provide:Jl,useFactory:Zb(n),multi:!0,deps:[de,ut,jn,sn,[new $e,nr],[new $e,Bn],...e]}])}var KD=Ue(yg,!0);var HD=Ue(fg,!0);var QD=Ue(eg,!0);var YD=Ue(dg,!0);var JD=Ue(Wl,!0);var XD=Ue(tg,!0);var ZD=Ue(ug,!0);var eR=Ue(lg,!0);var Sg=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(i){return new(i||n)(B(Ca),B(Ve))}}static{this.\u0275dir=pe({type:n})}}return n})(),nT=(()=>{class n extends Sg{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ld(n)))(r||n)}})()}static{this.\u0275dir=pe({type:n,features:[lt]})}}return n})(),ih=new te("");var iT={provide:ih,useExisting:kn(()=>Dg),multi:!0};function rT(){let n=xa()?xa().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var sT=new te(""),Dg=(()=>{class n extends Sg{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!rT())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(i){return new(i||n)(B(Ca),B(Ve),B(sT,8))}}static{this.\u0275dir=pe({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&Vn("input",function(a){return r._handleInput(a.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(a){return r._compositionEnd(a.target.value)})},features:[kt([iT]),lt]})}}return n})();function zt(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function Rg(n){return n!=null&&typeof n.length=="number"}var Mo=new te(""),Fo=new te(""),oT=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Ig=class{static min(e){return aT(e)}static max(e){return cT(e)}static required(e){return uT(e)}static requiredTrue(e){return lT(e)}static email(e){return hT(e)}static minLength(e){return dT(e)}static maxLength(e){return fT(e)}static pattern(e){return pT(e)}static nullValidator(e){return Pg(e)}static compose(e){return Mg(e)}static composeAsync(e){return Fg(e)}};function aT(n){return e=>{if(zt(e.value)||zt(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function cT(n){return e=>{if(zt(e.value)||zt(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function uT(n){return zt(n.value)?{required:!0}:null}function lT(n){return n.value===!0?null:{required:!0}}function hT(n){return zt(n.value)||oT.test(n.value)?null:{email:!0}}function dT(n){return e=>zt(e.value)||!Rg(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function fT(n){return e=>Rg(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function pT(n){if(!n)return Pg;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(zt(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function Pg(n){return null}function kg(n){return n!=null}function Ng(n){return Qd(n)?va(n):n}function Og(n){let e={};return n.forEach(t=>{e=t!=null?J(J({},e),t):e}),Object.keys(e).length===0?null:e}function xg(n,e){return e.map(t=>t(n))}function mT(n){return!n.validate}function Vg(n){return n.map(e=>mT(e)?e:t=>e.validate(t))}function Mg(n){if(!n)return null;let e=n.filter(kg);return e.length==0?null:function(t){return Og(xg(t,e))}}function rh(n){return n!=null?Mg(Vg(n)):null}function Fg(n){if(!n)return null;let e=n.filter(kg);return e.length==0?null:function(t){let i=xg(t,e).map(Ng);return Fd(i).pipe(Je(Og))}}function sh(n){return n!=null?Fg(Vg(n)):null}function Eg(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Lg(n){return n._rawValidators}function Ug(n){return n._rawAsyncValidators}function Xl(n){return n?Array.isArray(n)?n:[n]:[]}function Do(n,e){return Array.isArray(n)?n.includes(e):n===e}function wg(n,e){let t=Xl(e);return Xl(n).forEach(r=>{Do(t,r)||t.push(r)}),t}function bg(n,e){return Xl(e).filter(t=>!Do(n,t))}var Ro=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=rh(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=sh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Wt=class extends Ro{get formDirective(){return null}get path(){return null}},wn=class extends Ro{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Po=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},gT={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},yR=Ne(J({},gT),{"[class.ng-submitted]":"isSubmitted"}),vR=(()=>{class n extends Po{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||n)(B(wn,2))}}static{this.\u0275dir=pe({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Xt("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[lt]})}}return n})(),IR=(()=>{class n extends Po{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||n)(B(Wt,10))}}static{this.\u0275dir=pe({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Xt("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[lt]})}}return n})();var Dr="VALID",Co="INVALID",pi="PENDING",Rr="DISABLED",Kt=class{},ko=class extends Kt{constructor(e,t){super(),this.value=e,this.source=t}},kr=class extends Kt{constructor(e,t){super(),this.pristine=e,this.source=t}},Nr=class extends Kt{constructor(e,t){super(),this.touched=e,this.source=t}},mi=class extends Kt{constructor(e,t){super(),this.status=e,this.source=t}},Zl=class extends Kt{constructor(e){super(),this.source=e}},eh=class extends Kt{constructor(e){super(),this.source=e}};function oh(n){return(Lo(n)?n.validators:n)||null}function _T(n){return Array.isArray(n)?rh(n):n||null}function ah(n,e){return(Lo(e)?e.asyncValidators:n)||null}function yT(n){return Array.isArray(n)?sh(n):n||null}function Lo(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function Bg(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new ts(1e3,"");if(!i[t])throw new ts(1001,"")}function jg(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new ts(1002,"")})}var gi=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Fn(()=>this.statusReactive()),this.statusReactive=xn(void 0),this._pristine=Fn(()=>this.pristineReactive()),this.pristineReactive=xn(!0),this._touched=Fn(()=>this.touchedReactive()),this.touchedReactive=xn(!1),this._events=new Oe,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return ht(this.statusReactive)}set status(e){ht(()=>this.statusReactive.set(e))}get valid(){return this.status===Dr}get invalid(){return this.status===Co}get pending(){return this.status==pi}get disabled(){return this.status===Rr}get enabled(){return this.status!==Rr}get pristine(){return ht(this.pristineReactive)}set pristine(e){ht(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return ht(this.touchedReactive)}set touched(e){ht(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(wg(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(wg(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(bg(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(bg(e,this._rawAsyncValidators))}hasValidator(e){return Do(this._rawValidators,e)}hasAsyncValidator(e){return Do(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Ne(J({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Nr(!0,i))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new Nr(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Ne(J({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new kr(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new kr(!0,i))}markAsPending(e={}){this.status=pi;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new mi(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Ne(J({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Rr,this.errors=null,this._forEachChild(r=>{r.disable(Ne(J({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ko(this.value,i)),this._events.next(new mi(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Ne(J({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Dr,this._forEachChild(i=>{i.enable(Ne(J({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Ne(J({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Dr||this.status===pi)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ko(this.value,t)),this._events.next(new mi(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Ne(J({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Rr:Dr}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=pi,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let i=Ng(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new mi(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new Fe,this.statusChanges=new Fe}_calculateStatus(){return this._allControlsDisabled()?Rr:this.errors?Co:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(pi)?pi:this._anyControlsHaveStatus(Co)?Co:Dr}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new kr(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Nr(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Lo(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=_T(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=yT(this._rawAsyncValidators)}},_i=class extends gi{constructor(e,t,i){super(oh(t),ah(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){jg(this,!0,e),Object.keys(e).forEach(i=>{Bg(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var th=class extends _i{};var Uo=new te("CallSetDisabledState",{providedIn:"root",factory:()=>ch}),ch="always";function vT(n,e){return[...e.path,n]}function No(n,e,t=ch){uh(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),ET(n,e),bT(n,e),wT(n,e),IT(n,e)}function Oo(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),Vo(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function xo(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function IT(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function uh(n,e){let t=Lg(n);e.validator!==null?n.setValidators(Eg(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=Ug(n);e.asyncValidator!==null?n.setAsyncValidators(Eg(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();xo(e._rawValidators,r),xo(e._rawAsyncValidators,r)}function Vo(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=Lg(n);if(Array.isArray(r)&&r.length>0){let s=r.filter(a=>a!==e.validator);s.length!==r.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let r=Ug(n);if(Array.isArray(r)&&r.length>0){let s=r.filter(a=>a!==e.asyncValidator);s.length!==r.length&&(t=!0,n.setAsyncValidators(s))}}}let i=()=>{};return xo(e._rawValidators,i),xo(e._rawAsyncValidators,i),t}function ET(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&qg(n,e)})}function wT(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&qg(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function qg(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function bT(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function $g(n,e){n==null,uh(n,e)}function TT(n,e){return Vo(n,e)}function Gg(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function AT(n){return Object.getPrototypeOf(n.constructor)===nT}function zg(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function Wg(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(s=>{s.constructor===Dg?t=s:AT(s)?i=s:r=s}),r||i||t||null}function CT(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var ST={provide:Wt,useExisting:kn(()=>DT)},Pr=Promise.resolve(),DT=(()=>{class n extends Wt{get submitted(){return ht(this.submittedReactive)}constructor(t,i,r){super(),this.callSetDisabledState=r,this._submitted=Fn(()=>this.submittedReactive()),this.submittedReactive=xn(!1),this._directives=new Set,this.ngSubmit=new Fe,this.form=new _i({},rh(t),sh(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Pr.then(()=>{let i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),No(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Pr.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Pr.then(()=>{let i=this._findContainer(t.path),r=new _i({});$g(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Pr.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){Pr.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),zg(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(i){return new(i||n)(B(Mo,10),B(Fo,10),B(Uo,8))}}static{this.\u0275dir=pe({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){i&1&&Vn("submit",function(a){return r.onSubmit(a)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[kt([ST]),lt]})}}return n})();function Tg(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Ag(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var So=class extends gi{constructor(e=null,t,i){super(oh(t),ah(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Lo(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Ag(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Tg(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Tg(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Ag(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var RT=n=>n instanceof So;var wR=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=pe({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})();var lh=new te(""),PT={provide:wn,useExisting:kn(()=>kT)},kT=(()=>{class n extends wn{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,i,r,s,a){super(),this._ngModelWarningConfig=s,this.callSetDisabledState=a,this.update=new Fe,this._ngModelWarningSent=!1,this._setValidators(t),this._setAsyncValidators(i),this.valueAccessor=Wg(this,r)}ngOnChanges(t){if(this._isControlChanged(t)){let i=t.form.previousValue;i&&Oo(i,this,!1),No(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}Gg(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Oo(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}static{this.\u0275fac=function(i){return new(i||n)(B(Mo,10),B(Fo,10),B(ih,10),B(lh,8),B(Uo,8))}}static{this.\u0275dir=pe({type:n,selectors:[["","formControl",""]],inputs:{form:[0,"formControl","form"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[kt([PT]),lt,On]})}}return n})(),NT={provide:Wt,useExisting:kn(()=>OT)},OT=(()=>{class n extends Wt{get submitted(){return ht(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}constructor(t,i,r){super(),this.callSetDisabledState=r,this._submitted=Fn(()=>this._submittedReactive()),this._submittedReactive=xn(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Fe,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Vo(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let i=this.form.get(t.path);return No(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){Oo(t.control||null,t,!1),CT(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this._submittedReactive.set(!0),zg(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Zl(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new eh(this.form))}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(Oo(i||null,t),RT(r)&&(No(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);$g(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&TT(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){uh(this.form,this),this._oldForm&&Vo(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(i){return new(i||n)(B(Mo,10),B(Fo,10),B(Uo,8))}}static{this.\u0275dir=pe({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&Vn("submit",function(a){return r.onSubmit(a)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[kt([NT]),lt,On]})}}return n})();var xT={provide:wn,useExisting:kn(()=>VT)},VT=(()=>{class n extends wn{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,i,r,s,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new Fe,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=Wg(this,s)}ngOnChanges(t){this._added||this._setUpControl(),Gg(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return vT(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(i){return new(i||n)(B(Wt,13),B(Mo,10),B(Fo,10),B(ih,10),B(lh,8))}}static{this.\u0275dir=pe({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[kt([xT]),lt,On]})}}return n})();var MT=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Te({type:n})}static{this.\u0275inj=be({})}}return n})(),nh=class extends gi{constructor(e,t,i){super(oh(t),ah(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){jg(this,!1,e),e.forEach((i,r)=>{Bg(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Cg(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var bR=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),s={};return Cg(i)?s=i:i!==null&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new _i(r,s)}record(t,i=null){let r=this._reduceControls(t);return new th(r,i)}control(t,i,r){let s={};return this.useNonNullable?(Cg(i)?s=i:(s.validators=i,s.asyncValidators=r),new So(t,Ne(J({},s),{nonNullable:!0}))):new So(t,i,r)}array(t,i,r){let s=t.map(a=>this._createControl(a));return new nh(s,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof So)return t;if(t instanceof gi)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(i,r,s)}else return this.control(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var TR=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:lh,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Uo,useValue:t.callSetDisabledState??ch}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Te({type:n})}static{this.\u0275inj=be({imports:[MT]})}}return n})();var dh;try{dh=typeof Intl<"u"&&Intl.v8BreakIterator}catch{dh=!1}var qe=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Xd(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||dh)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(i){return new(i||n)(z(ns))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var yi,Kg=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function NR(){if(yi)return yi;if(typeof document!="object"||!document)return yi=new Set(Kg),yi;let n=document.createElement("input");return yi=new Set(Kg.filter(e=>(n.setAttribute("type",e),n.type===e))),yi}var Or;function FT(){if(Or==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Or=!0}))}finally{Or=Or||!1}return Or}function vi(n){return FT()?n:!!n.capture}var bn;function OR(){if(bn==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return bn=!1,bn;if("scrollBehavior"in document.documentElement.style)bn=!0;else{let n=Element.prototype.scrollTo;n?bn=!/\{\s*\[native code\]\s*\}/.test(n.toString()):bn=!1}}return bn}var hh;function LT(){if(hh==null){let n=typeof document<"u"?document.head:null;hh=!!(n&&(n.createShadowRoot||n.attachShadow))}return hh}function Hg(n){if(LT()){let e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function Qg(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){let e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function Tt(n){return n.composedPath?n.composedPath()[0]:n.target}function Yg(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Bo(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function UT(n){return n!=null&&`${n}`!="false"}function ph(n){return Array.isArray(n)?n:[n]}function MR(n){return n==null?"":typeof n=="string"?n:`${n}px`}function Tn(n){return n instanceof Ve?n.nativeElement:n}function FR(n,e=/\s+/){let t=[];if(n!=null){let i=Array.isArray(n)?n:`${n}`.split(e);for(let r of i){let s=`${r}`.trim();s&&t.push(s)}}return t}var BT=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Jg=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Te({type:n})}static{this.\u0275inj=be({providers:[BT]})}}return n})();var Xg=new Set,An,jT=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):$T}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&qT(t,this._nonce),this._matchMedia(t)}static{this.\u0275fac=function(i){return new(i||n)(z(qe),z(Ud,8))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function qT(n,e){if(!Xg.has(n))try{An||(An=document.createElement("style"),e&&An.setAttribute("nonce",e),An.setAttribute("type","text/css"),document.head.appendChild(An)),An.sheet&&(An.sheet.insertRule(`@media ${n} {body{ }}`,0),Xg.add(n))}catch(t){console.error(t)}}function $T(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var e_=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new Oe}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return Zg(ph(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=Zg(ph(t)).map(a=>this._registerQuery(a).observable),s=Vd(r);return s=Md(s.pipe(Ea(1)),s.pipe(Xr(1),Jr(0))),s.pipe(Je(a=>{let u={matches:!1,breakpoints:{}};return a.forEach(({matches:h,query:d})=>{u.matches=u.matches||h,u.breakpoints[d]=h}),u}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),s={observable:new Pt(a=>{let u=h=>this._zone.run(()=>a.next(h));return i.addListener(u),()=>{i.removeListener(u)}}).pipe(ba(i),Je(({matches:a})=>({query:t,matches:a})),Zr(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static{this.\u0275fac=function(i){return new(i||n)(z(jT),z(de))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Zg(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var s_=" ";function fP(n,e,t){let i=o_(n,e);t=t.trim(),!i.some(r=>r.trim()===t)&&(i.push(t),n.setAttribute(e,i.join(s_)))}function pP(n,e,t){let i=o_(n,e);t=t.trim();let r=i.filter(s=>s!==t);r.length?n.setAttribute(e,r.join(s_)):n.removeAttribute(e)}function o_(n,e){return n.getAttribute(e)?.match(/\S+/g)??[]}var cA=200,gh=class{constructor(e,t){this._letterKeyStream=new Oe,this._items=[],this._selectedItemIndex=-1,this._pressedLetters=[],this._selectedItem=new Oe,this.selectedItem=this._selectedItem;let i=typeof t?.debounceInterval=="number"?t.debounceInterval:cA;t?.skipPredicate&&(this._skipPredicateFn=t.skipPredicate),this.setItems(e),this._setupKeyHandler(i)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(e){this._selectedItemIndex=e}setItems(e){this._items=e}handleKey(e){let t=e.keyCode;e.key&&e.key.length===1?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(e){this._letterKeyStream.pipe(es(t=>this._pressedLetters.push(t)),Jr(e),Ia(()=>this._pressedLetters.length>0),Je(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(t=>{for(let i=1;i<this._items.length+1;i++){let r=(this._selectedItemIndex+i)%this._items.length,s=this._items[r];if(!this._skipPredicateFn?.(s)&&s.getLabel?.().toLocaleUpperCase().trim().indexOf(t)===0){this._selectedItem.next(s);break}}this._pressedLetters=[]})}},_h=class{constructor(e,t){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._typeaheadSubscription=Pd.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=i=>i.disabled,this.tabOut=new Oe,this.change=new Oe,e instanceof Aa?this._itemChangesSubscription=e.changes.subscribe(i=>this._itemsChanged(i.toArray())):Sa(e)&&(this._effectRef=Jd(()=>this._itemsChanged(e()),{injector:t}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){this._typeaheadSubscription.unsubscribe();let t=this._getItemsArray();return this._typeahead=new gh(t,{debounceInterval:typeof e=="number"?e:void 0,skipPredicate:i=>this._skipPredicateFn(i)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(i=>{this.setActiveItem(i)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){let t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){let t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:this.tabOut.next();return;case 40:if(this._vertical&&r){this.setNextItemActive();break}else return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&r){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&r){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&r){let s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&r){let s=this._activeItemIndex+this._pageUpAndDown.delta,a=this._getItemsArray().length;this._setActiveItemByIndex(s<a?s:a-1,-1);break}else return;default:(r||Bo(e,"shiftKey"))&&this._typeahead?.handleKey(e);return}this._typeahead?.reset(),e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){let t=this._getItemsArray(),i=typeof e=="number"?e:t.indexOf(e),r=t[i];this._activeItem=r??null,this._activeItemIndex=i,this._typeahead?.setCurrentSelectedItemIndex(i)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){let t=this._getItemsArray();for(let i=1;i<=t.length;i++){let r=(this._activeItemIndex+e*i+t.length)%t.length,s=t[r];if(!this._skipPredicateFn(s)){this.setActiveItem(r);return}}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){let i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(e+=t,!i[e])return;this.setActiveItem(e)}}_getItemsArray(){return Sa(this._items)?this._items():this._items instanceof Aa?this._items.toArray():this._items}_itemsChanged(e){if(this._typeahead?.setItems(e),this._activeItem){let t=e.indexOf(this._activeItem);t>-1&&t!==this._activeItemIndex&&(this._activeItemIndex=t,this._typeahead?.setCurrentSelectedItemIndex(t))}}},t_=class extends _h{setActiveItem(e){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(e),this.activeItem&&this.activeItem.setActiveStyles()}};var uA=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return hA(t)&&getComputedStyle(t).visibility==="visible"}isTabbable(t){if(!this._platform.isBrowser)return!1;let i=lA(vA(t));if(i&&(n_(i)===-1||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=n_(t);return t.hasAttribute("contenteditable")?s!==-1:r==="iframe"||r==="object"||this._platform.WEBKIT&&this._platform.IOS&&!_A(t)?!1:r==="audio"?t.hasAttribute("controls")?s!==-1:!1:r==="video"?s===-1?!1:s!==null?!0:this._platform.FIREFOX||t.hasAttribute("controls"):t.tabIndex>=0}isFocusable(t,i){return yA(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}static{this.\u0275fac=function(i){return new(i||n)(z(qe))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function lA(n){try{return n.frameElement}catch{return null}}function hA(n){return!!(n.offsetWidth||n.offsetHeight||typeof n.getClientRects=="function"&&n.getClientRects().length)}function dA(n){let e=n.nodeName.toLowerCase();return e==="input"||e==="select"||e==="button"||e==="textarea"}function fA(n){return mA(n)&&n.type=="hidden"}function pA(n){return gA(n)&&n.hasAttribute("href")}function mA(n){return n.nodeName.toLowerCase()=="input"}function gA(n){return n.nodeName.toLowerCase()=="a"}function a_(n){if(!n.hasAttribute("tabindex")||n.tabIndex===void 0)return!1;let e=n.getAttribute("tabindex");return!!(e&&!isNaN(parseInt(e,10)))}function n_(n){if(!a_(n))return null;let e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}function _A(n){let e=n.nodeName.toLowerCase(),t=e==="input"&&n.type;return t==="text"||t==="password"||e==="select"||e==="textarea"}function yA(n){return fA(n)?!1:dA(n)||pA(n)||n.hasAttribute("contenteditable")||a_(n)}function vA(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}var yh=class{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,i,r,s=!1,a){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._injector=a,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){let e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){let t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return e=="start"?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){let t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){let i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){let t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){let t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children;for(let i=0;i<t.length;i++){let r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children;for(let i=t.length-1;i>=0;i--){let r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){let e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._injector?Bd(e,{injector:this._injector}):setTimeout(e)}},IA=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._injector=xe(ut),this._document=r}create(t,i=!1){return new yh(t,this._checker,this._ngZone,this._document,i,this._injector)}static{this.\u0275fac=function(i){return new(i||n)(z(uA),z(de),z(Ge))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),mP=(()=>{class n{get enabled(){return this.focusTrap?.enabled||!1}set enabled(t){this.focusTrap&&(this.focusTrap.enabled=t)}constructor(t,i,r){this._elementRef=t,this._focusTrapFactory=i,this._previouslyFocusedElement=null,xe(qe).isBrowser&&(this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0))}ngOnDestroy(){this.focusTrap?.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap?.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap&&!this.focusTrap.hasAttached()&&this.focusTrap.attachAnchors()}ngOnChanges(t){let i=t.autoCapture;i&&!i.firstChange&&this.autoCapture&&this.focusTrap?.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=Qg(),this.focusTrap?.focusInitialElementWhenReady()}static{this.\u0275fac=function(i){return new(i||n)(B(Ve),B(IA),B(Ge))}}static{this.\u0275dir=pe({type:n,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:[2,"cdkTrapFocus","enabled",Mn],autoCapture:[2,"cdkTrapFocusAutoCapture","autoCapture",Mn]},exportAs:["cdkTrapFocus"],standalone:!0,features:[ji,On]})}}return n})();function vh(n){return n.buttons===0||n.detail===0}function Ih(n){let e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var EA=new te("cdk-input-modality-detector-options"),wA={ignoreKeys:[18,17,224,91,16]},c_=650,Ii=vi({passive:!0,capture:!0}),bA=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new kd(null),this._lastTouchMs=0,this._onKeydown=a=>{this._options?.ignoreKeys?.some(u=>u===a.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Tt(a))},this._onMousedown=a=>{Date.now()-this._lastTouchMs<c_||(this._modality.next(vh(a)?"keyboard":"mouse"),this._mostRecentTarget=Tt(a))},this._onTouchstart=a=>{if(Ih(a)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Tt(a)},this._options=J(J({},wA),s),this.modalityDetected=this._modality.pipe(Xr(1)),this.modalityChanged=this.modalityDetected.pipe(wa()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Ii),r.addEventListener("mousedown",this._onMousedown,Ii),r.addEventListener("touchstart",this._onTouchstart,Ii)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Ii),document.removeEventListener("mousedown",this._onMousedown,Ii),document.removeEventListener("touchstart",this._onTouchstart,Ii))}static{this.\u0275fac=function(i){return new(i||n)(z(qe),z(de),z(Ge),z(EA,8))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),TA=new te("liveAnnouncerElement",{providedIn:"root",factory:AA});function AA(){return null}var CA=new te("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),SA=0,gP=(()=>{class n{constructor(t,i,r,s){this._ngZone=i,this._defaultOptions=s,this._document=r,this._liveElement=t||this._createLiveElement()}announce(t,...i){let r=this._defaultOptions,s,a;return i.length===1&&typeof i[0]=="number"?a=i[0]:[s,a]=i,this.clear(),clearTimeout(this._previousTimeout),s||(s=r&&r.politeness?r.politeness:"polite"),a==null&&r&&(a=r.duration),this._liveElement.setAttribute("aria-live",s),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(u=>this._currentResolve=u)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,typeof a=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),a)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let t="cdk-live-announcer-element",i=this._document.getElementsByClassName(t),r=this._document.createElement("div");for(let s=0;s<i.length;s++)i[s].remove();return r.classList.add(t),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),r.id=`cdk-live-announcer-${SA++}`,this._document.body.appendChild(r),r}_exposeAnnouncerToModals(t){let i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<i.length;r++){let s=i[r],a=s.getAttribute("aria-owns");a?a.indexOf(t)===-1&&s.setAttribute("aria-owns",a+" "+t):s.setAttribute("aria-owns",t)}}static{this.\u0275fac=function(i){return new(i||n)(z(TA,8),z(de),z(Ge),z(CA,8))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var qo=function(n){return n[n.IMMEDIATE=0]="IMMEDIATE",n[n.EVENTUAL=1]="EVENTUAL",n}(qo||{}),DA=new te("cdk-focus-monitor-default-options"),jo=vi({passive:!0,capture:!0}),RA=(()=>{class n{constructor(t,i,r,s,a){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Oe,this._rootNodeFocusAndBlurListener=u=>{let h=Tt(u);for(let d=h;d;d=d.parentElement)u.type==="focus"?this._onFocus(u,d):this._onBlur(u,d)},this._document=s,this._detectionMode=a?.detectionMode||qo.IMMEDIATE}monitor(t,i=!1){let r=Tn(t);if(!this._platform.isBrowser||r.nodeType!==1)return xd();let s=Hg(r)||this._getDocument(),a=this._elementInfo.get(r);if(a)return i&&(a.checkChildren=!0),a.subject;let u={checkChildren:i,subject:new Oe,rootNode:s};return this._elementInfo.set(r,u),this._registerGlobalListeners(u),u.subject}stopMonitoring(t){let i=Tn(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){let s=Tn(t),a=this._getDocument().activeElement;s===a?this._getClosestElementsInfo(s).forEach(([u,h])=>this._originChanged(u,i,h)):(this._setOrigin(i),typeof s.focus=="function"&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===qo.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused",i==="touch"),t.classList.toggle("cdk-keyboard-focused",i==="keyboard"),t.classList.toggle("cdk-mouse-focused",i==="mouse"),t.classList.toggle("cdk-program-focused",i==="program")}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=t,this._originFromTouchInteraction=t==="touch"&&i,this._detectionMode===qo.IMMEDIATE){clearTimeout(this._originTimeoutId);let r=this._originFromTouchInteraction?c_:1;this._originTimeoutId=setTimeout(()=>this._origin=null,r)}})}_onFocus(t,i){let r=this._elementInfo.get(i),s=Tt(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){let r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;let i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,jo),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,jo)}),this._rootNodeFocusListenerCount.set(i,r+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Zr(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){let i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){let r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,jo),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,jo),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){let i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){let{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if(r!=="mouse"||!i||i===t||t.nodeName!=="INPUT"&&t.nodeName!=="TEXTAREA"||t.disabled)return!1;let s=t.labels;if(s){for(let a=0;a<s.length;a++)if(s[a].contains(i))return!0}return!1}static{this.\u0275fac=function(i){return new(i||n)(z(de),z(qe),z(bA),z(Ge,8),z(DA,8))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),_P=(()=>{class n{constructor(t,i){this._elementRef=t,this._focusMonitor=i,this._focusOrigin=null,this.cdkFocusChange=new Fe}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){let t=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(t,t.nodeType===1&&t.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(i=>{this._focusOrigin=i,this.cdkFocusChange.emit(i)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||n)(B(Ve),B(RA))}}static{this.\u0275dir=pe({type:n,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"],standalone:!0})}}return n})(),Cn=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(Cn||{}),i_="cdk-high-contrast-black-on-white",r_="cdk-high-contrast-white-on-black",mh="cdk-high-contrast-active",Eh=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=xe(e_).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Cn.NONE;let t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);let i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Cn.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Cn.BLACK_ON_WHITE}return Cn.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let t=this._document.body.classList;t.remove(mh,i_,r_),this._hasCheckedHighContrastMode=!0;let i=this.getHighContrastMode();i===Cn.BLACK_ON_WHITE?t.add(mh,i_):i===Cn.WHITE_ON_BLACK&&t.add(mh,r_)}}static{this.\u0275fac=function(i){return new(i||n)(z(qe),z(Ge))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),yP=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}static{this.\u0275fac=function(i){return new(i||n)(z(Eh))}}static{this.\u0275mod=Te({type:n})}static{this.\u0275inj=be({imports:[Jg]})}}return n})();var kA=new te("cdk-dir-doc",{providedIn:"root",factory:NA});function NA(){return xe(Ge)}var OA=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function xA(n){let e=n?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?OA.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var RP=(()=>{class n{constructor(t){if(this.value="ltr",this.change=new Fe,t){let i=t.body?t.body.dir:null,r=t.documentElement?t.documentElement.dir:null;this.value=xA(i||r||"ltr")}}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(i){return new(i||n)(z(kA,8))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var wh=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Te({type:n})}static{this.\u0275inj=be({})}}return n})();var FA=["text"],LA=[[["mat-icon"]],"*"],UA=["mat-icon","*"];function BA(n,e){if(n&1&&as(0,"mat-pseudo-checkbox",1),n&2){let t=cs();ss("disabled",t.disabled)("state",t.selected?"checked":"unchecked")}}function jA(n,e){if(n&1&&as(0,"mat-pseudo-checkbox",3),n&2){let t=cs();ss("disabled",t.disabled)}}function qA(n,e){if(n&1&&(Ra(0,"span",4),Wd(1),Pa()),n&2){let t=cs();Bi(),Kd("(",t.group.label,")")}}function $A(){return!0}var GA=new te("mat-sanity-checks",{providedIn:"root",factory:$A}),Go=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return Yg()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[t]}static{this.\u0275fac=function(i){return new(i||n)(z(Eh),z(GA,8),z(Ge))}}static{this.\u0275mod=Te({type:n})}static{this.\u0275inj=be({imports:[wh,wh]})}}return n})();var u_=class{constructor(e,t,i,r,s){this._defaultMatcher=e,this.ngControl=t,this._parentFormGroup=i,this._parentForm=r,this._stateChanges=s,this.errorState=!1}updateErrorState(){let e=this.errorState,t=this._parentFormGroup||this._parentForm,i=this.matcher||this._defaultMatcher,r=this.ngControl?this.ngControl.control:null,s=i?.isErrorState(r,t)??!1;s!==e&&(this.errorState=s,this._stateChanges.next())}};var JP=new te("MAT_DATE_LOCALE",{providedIn:"root",factory:zA});function zA(){return xe(Yd)}var l_=class{constructor(){this._localeChanges=new Oe,this.localeChanges=this._localeChanges}getValidDateOrNull(e){return this.isDateInstance(e)&&this.isValid(e)?e:null}deserialize(e){return e==null||this.isDateInstance(e)&&this.isValid(e)?e:this.invalid()}setLocale(e){this.locale=e,this._localeChanges.next()}compareDate(e,t){return this.getYear(e)-this.getYear(t)||this.getMonth(e)-this.getMonth(t)||this.getDate(e)-this.getDate(t)}sameDate(e,t){if(e&&t){let i=this.isValid(e),r=this.isValid(t);return i&&r?!this.compareDate(e,t):i==r}return e==t}clampDate(e,t,i){return t&&this.compareDate(e,t)<0?t:i&&this.compareDate(e,i)>0?i:e}},XP=new te("mat-date-formats");var ZP=(()=>{class n{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var We=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(We||{}),Ah=class{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=We.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},h_=vi({passive:!0,capture:!0}),Ch=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let t=Tt(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){let s=this._events.get(t);if(s){let a=s.get(i);a?a.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,h_)})}removeHandler(e,t,i){let r=this._events.get(e);if(!r)return;let s=r.get(t);s&&(s.delete(i),s.size===0&&r.delete(t),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,h_)))}},d_={enterDuration:225,exitDuration:150},WA=800,f_=vi({passive:!0,capture:!0}),p_=["mousedown","touchstart"],m_=["mouseup","mouseleave","touchend","touchcancel"],Sh=class n{static{this._eventManager=new Ch}constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Tn(i))}fadeInRipple(e,t,i={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=J(J({},d_),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);let a=i.radius||KA(e,t,r),u=e-r.left,h=t-r.top,d=s.enterDuration,p=document.createElement("div");p.classList.add("mat-ripple-element"),p.style.left=`${u-a}px`,p.style.top=`${h-a}px`,p.style.height=`${a*2}px`,p.style.width=`${a*2}px`,i.color!=null&&(p.style.backgroundColor=i.color),p.style.transitionDuration=`${d}ms`,this._containerElement.appendChild(p);let y=window.getComputedStyle(p),A=y.transitionProperty,S=y.transitionDuration,N=A==="none"||S==="0s"||S==="0s, 0s"||r.width===0&&r.height===0,O=new Ah(this,p,i,N);p.style.transform="scale3d(1, 1, 1)",O.state=We.FADING_IN,i.persistent||(this._mostRecentTransientRipple=O);let P=null;return!N&&(d||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let q=()=>{P&&(P.fallbackTimer=null),clearTimeout(G),this._finishRippleTransition(O)},$=()=>this._destroyRipple(O),G=setTimeout($,d+100);p.addEventListener("transitionend",q),p.addEventListener("transitioncancel",$),P={onTransitionEnd:q,onTransitionCancel:$,fallbackTimer:G}}),this._activeRipples.set(O,P),(N||!d)&&this._finishRippleTransition(O),O}fadeOutRipple(e){if(e.state===We.FADING_OUT||e.state===We.HIDDEN)return;let t=e.element,i=J(J({},d_),e.config.animation);t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=We.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let t=Tn(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,p_.forEach(i=>{n._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{m_.forEach(t=>{this._triggerElement.addEventListener(t,this,f_)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===We.FADING_IN?this._startFadeOutTransition(e):e.state===We.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=We.VISIBLE,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=We.HIDDEN,t!==null&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel),t.fallbackTimer!==null&&clearTimeout(t.fallbackTimer)),e.element.remove()}_onMousedown(e){let t=vh(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+WA;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!Ih(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let t=e.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let t=e.state===We.VISIBLE||e.config.terminateOnPointerUp&&e.state===We.FADING_IN;!e.config.persistent&&t&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(p_.forEach(t=>n._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(m_.forEach(t=>e.removeEventListener(t,this,f_)),this._pointerUpEventsRegistered=!1))}};function KA(n,e,t){let i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}var v_=new te("mat-ripple-global-options"),I_=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,a){this._elementRef=t,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new Sh(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:J(J(J({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return typeof t=="number"?this._rippleRenderer.fadeInRipple(t,i,J(J({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,J(J({},this.rippleConfig),t))}static{this.\u0275fac=function(i){return new(i||n)(B(Ve),B(de),B(qe),B(v_,8),B(is,8))}}static{this.\u0275dir=pe({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){i&2&&Xt("mat-ripple-unbounded",r.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}}return n})(),HA=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Te({type:n})}static{this.\u0275inj=be({imports:[Go,Go]})}}return n})(),QA=(()=>{class n{constructor(t){this._animationMode=t,this.state="unchecked",this.disabled=!1,this.appearance="full"}static{this.\u0275fac=function(i){return new(i||n)(B(is,8))}}static{this.\u0275cmp=Ta({type:n,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(i,r){i&2&&Xt("mat-pseudo-checkbox-indeterminate",r.state==="indeterminate")("mat-pseudo-checkbox-checked",r.state==="checked")("mat-pseudo-checkbox-disabled",r.disabled)("mat-pseudo-checkbox-minimal",r.appearance==="minimal")("mat-pseudo-checkbox-full",r.appearance==="full")("_mat-animation-noopable",r._animationMode==="NoopAnimations")},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},standalone:!0,features:[Na],decls:0,vars:0,template:function(i,r){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color, var(--mat-app-primary))}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color)}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color, var(--mat-app-on-surface-variant));border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color, var(--mat-app-primary));border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color, var(--mat-app-on-primary))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color, var(--mat-app-surface))}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0})}}return n})(),YA=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Te({type:n})}static{this.\u0275inj=be({imports:[Go]})}}return n})(),JA=new te("MAT_OPTION_PARENT_COMPONENT");var XA=new te("MatOptgroup");var ZA=0,Dh=class{constructor(e,t=!1){this.source=e,this.isUserInput=t}},ek=(()=>{class n{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(t){this._disabled=t}get disableRipple(){return!!(this._parent&&this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!!(this._parent&&this._parent.hideSingleSelectionIndicator)}constructor(t,i,r,s){this._element=t,this._changeDetectorRef=i,this._parent=r,this.group=s,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id=`mat-option-${ZA++}`,this.onSelectionChange=new Fe,this._stateChanges=new Oe}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(t=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),t&&this._emitSelectionChangeEvent())}deselect(t=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),t&&this._emitSelectionChangeEvent())}focus(t,i){let r=this._getHostElement();typeof r.focus=="function"&&r.focus(i)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(t){(t.keyCode===13||t.keyCode===32)&&!Bo(t)&&(this._selectViaInteraction(),t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=this.multiple?!this._selected:!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){let t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=t)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(t=!1){this.onSelectionChange.emit(new Dh(this,t))}static{this.\u0275fac=function(i){return new(i||n)(B(Ve),B(Oa),B(JA,8),B(XA,8))}}static{this.\u0275cmp=Ta({type:n,selectors:[["mat-option"]],viewQuery:function(i,r){if(i&1&&$d(FA,7),i&2){let s;Gd(s=zd())&&(r._text=s.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(i,r){i&1&&Vn("click",function(){return r._selectViaInteraction()})("keydown",function(a){return r._handleKeydown(a)}),i&2&&(jd("id",r.id),rs("aria-selected",r.selected)("aria-disabled",r.disabled.toString()),Xt("mdc-list-item--selected",r.selected)("mat-mdc-option-multiple",r.multiple)("mat-mdc-option-active",r.active)("mdc-list-item--disabled",r.disabled))},inputs:{value:"value",id:"id",disabled:[2,"disabled","disabled",Mn]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],standalone:!0,features:[ji,Na],ngContentSelectors:UA,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(i,r){i&1&&(qd(LA),Da(0,BA,1,2,"mat-pseudo-checkbox",1),ka(1),Ra(2,"span",2,0),ka(4,1),Pa(),Da(5,jA,1,1,"mat-pseudo-checkbox",3)(6,qA,2,1,"span",4),as(7,"div",5)),i&2&&(os(r.multiple?0:-1),Bi(5),os(!r.multiple&&r.selected&&!r.hideSingleSelectionIndicator?5:-1),Bi(),os(r.group&&r.group._inert?6:-1),Bi(),ss("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disabled||r.disableRipple))},dependencies:[QA,I_],styles:['.mat-mdc-option{-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;min-height:48px;padding:0 16px;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color, var(--mat-app-on-surface));font-family:var(--mat-option-label-text-font, var(--mat-app-label-large-font));line-height:var(--mat-option-label-text-line-height, var(--mat-app-label-large-line-height));font-size:var(--mat-option-label-text-size, var(--mat-app-body-large-size));letter-spacing:var(--mat-option-label-text-tracking, var(--mat-app-label-large-tracking));font-weight:var(--mat-option-label-text-weight, var(--mat-app-body-large-weight))}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color)}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color);outline:0}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color, var(--mat-app-on-secondary-container))}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color, var(--mat-app-secondary-container))}.mat-mdc-option .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-option-selected-state-label-text-color, var(--mat-app-on-secondary-container))}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return n})();function tk(n,e,t){if(t.length){let i=e.toArray(),r=t.toArray(),s=0;for(let a=0;a<n+1;a++)i[a].group&&i[a].group===r[s]&&s++;return s}return 0}function nk(n,e,t,i){return n<t?n:n+e>t+i?Math.max(0,n-i+e):t}var ik=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Te({type:n})}static{this.\u0275inj=be({imports:[HA,Go,YA]})}}return n})(),g_={capture:!0},__=["focus","mousedown","mouseenter","touchstart"],bh="mat-ripple-loader-uninitialized",Th="mat-ripple-loader-class-name",y_="mat-ripple-loader-centered",$o="mat-ripple-loader-disabled",rk=(()=>{class n{constructor(){this._document=xe(Ge,{optional:!0}),this._animationMode=xe(is,{optional:!0}),this._globalRippleOptions=xe(v_,{optional:!0}),this._platform=xe(qe),this._ngZone=xe(de),this._hosts=new Map,this._onInteraction=t=>{let i=Tt(t);if(i instanceof HTMLElement){let r=i.closest(`[${bh}="${this._globalRippleOptions?.namespace??""}"]`);r&&this._createRipple(r)}},this._ngZone.runOutsideAngular(()=>{for(let t of __)this._document?.addEventListener(t,this._onInteraction,g_)})}ngOnDestroy(){let t=this._hosts.keys();for(let i of t)this.destroyRipple(i);for(let i of __)this._document?.removeEventListener(i,this._onInteraction,g_)}configureRipple(t,i){t.setAttribute(bh,this._globalRippleOptions?.namespace??""),(i.className||!t.hasAttribute(Th))&&t.setAttribute(Th,i.className||""),i.centered&&t.setAttribute(y_,""),i.disabled&&t.setAttribute($o,"")}getRipple(t){return this._hosts.get(t)||this._createRipple(t)}setDisabled(t,i){let r=this._hosts.get(t);if(r){r.disabled=i;return}i?t.setAttribute($o,""):t.removeAttribute($o)}_createRipple(t){if(!this._document)return;let i=this._hosts.get(t);if(i)return i;t.querySelector(".mat-ripple")?.remove();let r=this._document.createElement("span");r.classList.add("mat-ripple",t.getAttribute(Th)),t.append(r);let s=new I_(new Ve(r),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return s._isInitialized=!0,s.trigger=t,s.centered=t.hasAttribute(y_),s.disabled=t.hasAttribute($o),this.attachRipple(t,s),s}attachRipple(t,i){t.removeAttribute(bh),this._hosts.set(t,i)}destroyRipple(t){let i=this._hosts.get(t);i&&(i.ngOnDestroy(),this._hosts.delete(t))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{ty as a,ny as b,rf as c,ry as d,e0 as e,of as f,ls as g,af as h,cf as i,hf as j,t0 as k,Zd as l,n0 as m,i0 as n,r0 as o,s0 as p,o0 as q,gf as r,a0 as s,Gi as t,tf as u,c0 as v,u0 as w,l0 as x,ke as y,ze as z,W as A,Nt as B,xt as C,Ki as D,Vt as E,Ln as F,fe as G,rn as H,gs as I,Hi as J,Bn as K,jn as L,Ue as M,mt as N,sn as O,J0 as P,X0 as Q,nr as R,YC as S,JC as T,Sr as U,WD as V,KD as W,HD as X,QD as Y,YD as Z,JD as _,XD as $,ZD as aa,eR as ba,ih as ca,Dg as da,Mo as ea,Ig as fa,wn as ga,vR as ha,IR as ia,DT as ja,So as ka,wR as la,kT as ma,OT as na,VT as oa,bR as pa,TR as qa,qe as ra,NR as sa,vi as ta,OR as ua,Qg as va,Tt as wa,Yg as xa,Bo as ya,UT as za,ph as Aa,MR as Ba,Tn as Ca,FR as Da,Jg as Ea,fP as Fa,pP as Ga,t_ as Ha,mP as Ia,gP as Ja,RA as Ka,_P as La,yP as Ma,RP as Na,wh as Oa,Go as Pa,u_ as Qa,JP as Ra,l_ as Sa,XP as Ta,ZP as Ua,HA as Va,JA as Wa,XA as Xa,ek as Ya,tk as Za,nk as _a,ik as $a,rk as ab};
