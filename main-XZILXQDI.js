import{c as na}from"./chunk-57RXDUMQ.js";import{e as ea,j as ta}from"./chunk-YQALSJKM.js";import{$ as Qo,A as Mo,B as bo,C as Do,D as No,E as Ro,F as Po,G as Vt,H as Ao,I as Oo,J as xo,K as Fo,L as Lo,M as Yo,N as Wo,O as Uo,P as Ho,Pa as ut,Q as Vo,R as Go,Ra as Fs,S as Bo,Sa as Ls,T as jo,Ta as Jo,U as $o,V as zo,W as qo,X as Ko,Y as Os,a as S,b as ct,c as _o,d as mo,e as po,f as go,fa as xs,g as Ns,h as yo,i as Rs,j as vo,k as ye,l as On,m as $,n as wo,o as Co,p as ve,pa as Zo,q as Ve,qa as Xo,r as Ps,s as Ut,t as So,u as To,v as Eo,w as Io,x as Ht,y as As,z as ko}from"./chunk-7AUTWQVO.js";import{a as co,b as uo,c as ho,f as fo}from"./chunk-HEHDJ4NV.js";import"./chunk-OJQ37XWR.js";import{$a as io,Da as Jr,Ga as Pn,Oa as eo,Ta as Ds,Ua as to,Vb as An,Wa as no,Ya as so,bb as ro,c as Kr,ca as Zr,e as Jd,ea as Lt,f as Qr,fa as ot,gc as ao,h as bn,ha as at,ja as Dn,ka as Yt,la as Wt,oa as Nn,pa as lt,ra as Rn,sa as Xr,tc as lo,wb as oo}from"./chunk-VJKZDLWZ.js";var Xi=Jd((Zi,It)=>{"use strict";(function(s,t){typeof Zi=="object"&&typeof It<"u"?It.exports=t():typeof define=="function"&&define.amd?define(t):s.moment=t()})(Zi,function(){"use strict";var s;function t(){return s.apply(null,arguments)}function e(n){s=n}function i(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function o(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function c(n,r){return Object.prototype.hasOwnProperty.call(n,r)}function u(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var r;for(r in n)if(c(n,r))return!1;return!0}function d(n){return n===void 0}function _(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function m(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function y(n,r){var a=[],l,h=n.length;for(l=0;l<h;++l)a.push(r(n[l],l));return a}function g(n,r){for(var a in r)c(r,a)&&(n[a]=r[a]);return c(r,"toString")&&(n.toString=r.toString),c(r,"valueOf")&&(n.valueOf=r.valueOf),n}function w(n,r,a,l){return kr(n,r,a,l,!0).utc()}function M(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function C(n){return n._pf==null&&(n._pf=M()),n._pf}var B;Array.prototype.some?B=Array.prototype.some:B=function(n){var r=Object(this),a=r.length>>>0,l;for(l=0;l<a;l++)if(l in r&&n.call(this,r[l],l,r))return!0;return!1};function q(n){var r=null,a=!1,l=n._d&&!isNaN(n._d.getTime());if(l&&(r=C(n),a=B.call(r.parsedDateParts,function(h){return h!=null}),l=r.overflow<0&&!r.empty&&!r.invalidEra&&!r.invalidMonth&&!r.invalidWeekday&&!r.weekdayMismatch&&!r.nullInput&&!r.invalidFormat&&!r.userInvalidated&&(!r.meridiem||r.meridiem&&a),n._strict&&(l=l&&r.charsLeftOver===0&&r.unusedTokens.length===0&&r.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=l;else return l;return n._isValid}function Re(n){var r=w(NaN);return n!=null?g(C(r),n):C(r).userInvalidated=!0,r}var Le=t.momentProperties=[],Ye=!1;function kt(n,r){var a,l,h,f=Le.length;if(d(r._isAMomentObject)||(n._isAMomentObject=r._isAMomentObject),d(r._i)||(n._i=r._i),d(r._f)||(n._f=r._f),d(r._l)||(n._l=r._l),d(r._strict)||(n._strict=r._strict),d(r._tzm)||(n._tzm=r._tzm),d(r._isUTC)||(n._isUTC=r._isUTC),d(r._offset)||(n._offset=r._offset),d(r._pf)||(n._pf=C(r)),d(r._locale)||(n._locale=r._locale),f>0)for(a=0;a<f;a++)l=Le[a],h=r[l],d(h)||(n[l]=h);return n}function Mt(n){kt(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Ye===!1&&(Ye=!0,t.updateOffset(this),Ye=!1)}function ce(n){return n instanceof Mt||n!=null&&n._isAMomentObject!=null}function tr(n){t.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function se(n,r){var a=!0;return g(function(){if(t.deprecationHandler!=null&&t.deprecationHandler(null,n),a){var l=[],h,f,p,T=arguments.length;for(f=0;f<T;f++){if(h="",typeof arguments[f]=="object"){h+=`
[`+f+"] ";for(p in arguments[0])c(arguments[0],p)&&(h+=p+": "+arguments[0][p]+", ");h=h.slice(0,-2)}else h=arguments[f];l.push(h)}tr(n+`
Arguments: `+Array.prototype.slice.call(l).join("")+`
`+new Error().stack),a=!1}return r.apply(this,arguments)},r)}var nr={};function sr(n,r){t.deprecationHandler!=null&&t.deprecationHandler(n,r),nr[n]||(tr(r),nr[n]=!0)}t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;function me(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function tc(n){var r,a;for(a in n)c(n,a)&&(r=n[a],me(r)?this[a]=r:this["_"+a]=r);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ts(n,r){var a=g({},n),l;for(l in r)c(r,l)&&(o(n[l])&&o(r[l])?(a[l]={},g(a[l],n[l]),g(a[l],r[l])):r[l]!=null?a[l]=r[l]:delete a[l]);for(l in n)c(n,l)&&!c(r,l)&&o(n[l])&&(a[l]=g({},a[l]));return a}function ns(n){n!=null&&this.set(n)}var ss;Object.keys?ss=Object.keys:ss=function(n){var r,a=[];for(r in n)c(n,r)&&a.push(r);return a};var nc={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function sc(n,r,a){var l=this._calendar[n]||this._calendar.sameElse;return me(l)?l.call(r,a):l}function pe(n,r,a){var l=""+Math.abs(n),h=r-l.length,f=n>=0;return(f?a?"+":"":"-")+Math.pow(10,Math.max(0,h)).toString().substr(1)+l}var is=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ln=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,rs={},Ze={};function I(n,r,a,l){var h=l;typeof l=="string"&&(h=function(){return this[l]()}),n&&(Ze[n]=h),r&&(Ze[r[0]]=function(){return pe(h.apply(this,arguments),r[1],r[2])}),a&&(Ze[a]=function(){return this.localeData().ordinal(h.apply(this,arguments),n)})}function ic(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function rc(n){var r=n.match(is),a,l;for(a=0,l=r.length;a<l;a++)Ze[r[a]]?r[a]=Ze[r[a]]:r[a]=ic(r[a]);return function(h){var f="",p;for(p=0;p<l;p++)f+=me(r[p])?r[p].call(h,n):r[p];return f}}function cn(n,r){return n.isValid()?(r=ir(r,n.localeData()),rs[r]=rs[r]||rc(r),rs[r](n)):n.localeData().invalidDate()}function ir(n,r){var a=5;function l(h){return r.longDateFormat(h)||h}for(ln.lastIndex=0;a>=0&&ln.test(n);)n=n.replace(ln,l),ln.lastIndex=0,a-=1;return n}var oc={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ac(n){var r=this._longDateFormat[n],a=this._longDateFormat[n.toUpperCase()];return r||!a?r:(this._longDateFormat[n]=a.match(is).map(function(l){return l==="MMMM"||l==="MM"||l==="DD"||l==="dddd"?l.slice(1):l}).join(""),this._longDateFormat[n])}var lc="Invalid date";function cc(){return this._invalidDate}var uc="%d",hc=/\d{1,2}/;function dc(n){return this._ordinal.replace("%d",n)}var fc={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function _c(n,r,a,l){var h=this._relativeTime[a];return me(h)?h(n,r,a,l):h.replace(/%d/i,n)}function mc(n,r){var a=this._relativeTime[n>0?"future":"past"];return me(a)?a(r):a.replace(/%s/i,r)}var rr={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ie(n){return typeof n=="string"?rr[n]||rr[n.toLowerCase()]:void 0}function os(n){var r={},a,l;for(l in n)c(n,l)&&(a=ie(l),a&&(r[a]=n[l]));return r}var pc={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function gc(n){var r=[],a;for(a in n)c(n,a)&&r.push({unit:a,priority:pc[a]});return r.sort(function(l,h){return l.priority-h.priority}),r}var or=/\d/,te=/\d\d/,ar=/\d{3}/,as=/\d{4}/,un=/[+-]?\d{6}/,Y=/\d\d?/,lr=/\d\d\d\d?/,cr=/\d\d\d\d\d\d?/,hn=/\d{1,3}/,ls=/\d{1,4}/,dn=/[+-]?\d{1,6}/,Xe=/\d+/,fn=/[+-]?\d+/,yc=/Z|[+-]\d\d:?\d\d/gi,_n=/Z|[+-]\d\d(?::?\d\d)?/gi,vc=/[+-]?\d+(\.\d{1,3})?/,bt=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Je=/^[1-9]\d?/,cs=/^([1-9]\d|\d)/,mn;mn={};function E(n,r,a){mn[n]=me(r)?r:function(l,h){return l&&a?a:r}}function wc(n,r){return c(mn,n)?mn[n](r._strict,r._locale):new RegExp(Cc(n))}function Cc(n){return we(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(r,a,l,h,f){return a||l||h||f}))}function we(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function re(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function b(n){var r=+n,a=0;return r!==0&&isFinite(r)&&(a=re(r)),a}var us={};function x(n,r){var a,l=r,h;for(typeof n=="string"&&(n=[n]),_(r)&&(l=function(f,p){p[r]=b(f)}),h=n.length,a=0;a<h;a++)us[n[a]]=l}function Dt(n,r){x(n,function(a,l,h,f){h._w=h._w||{},r(a,h._w,h,f)})}function Sc(n,r,a){r!=null&&c(us,n)&&us[n](r,a._a,a,n)}function pn(n){return n%4===0&&n%100!==0||n%400===0}var K=0,Ce=1,ge=2,j=3,ue=4,Se=5,We=6,Tc=7,Ec=8;I("Y",0,0,function(){var n=this.year();return n<=9999?pe(n,4):"+"+n}),I(0,["YY",2],0,function(){return this.year()%100}),I(0,["YYYY",4],0,"year"),I(0,["YYYYY",5],0,"year"),I(0,["YYYYYY",6,!0],0,"year"),E("Y",fn),E("YY",Y,te),E("YYYY",ls,as),E("YYYYY",dn,un),E("YYYYYY",dn,un),x(["YYYYY","YYYYYY"],K),x("YYYY",function(n,r){r[K]=n.length===2?t.parseTwoDigitYear(n):b(n)}),x("YY",function(n,r){r[K]=t.parseTwoDigitYear(n)}),x("Y",function(n,r){r[K]=parseInt(n,10)});function Nt(n){return pn(n)?366:365}t.parseTwoDigitYear=function(n){return b(n)+(b(n)>68?1900:2e3)};var ur=et("FullYear",!0);function Ic(){return pn(this.year())}function et(n,r){return function(a){return a!=null?(hr(this,n,a),t.updateOffset(this,r),this):Rt(this,n)}}function Rt(n,r){if(!n.isValid())return NaN;var a=n._d,l=n._isUTC;switch(r){case"Milliseconds":return l?a.getUTCMilliseconds():a.getMilliseconds();case"Seconds":return l?a.getUTCSeconds():a.getSeconds();case"Minutes":return l?a.getUTCMinutes():a.getMinutes();case"Hours":return l?a.getUTCHours():a.getHours();case"Date":return l?a.getUTCDate():a.getDate();case"Day":return l?a.getUTCDay():a.getDay();case"Month":return l?a.getUTCMonth():a.getMonth();case"FullYear":return l?a.getUTCFullYear():a.getFullYear();default:return NaN}}function hr(n,r,a){var l,h,f,p,T;if(!(!n.isValid()||isNaN(a))){switch(l=n._d,h=n._isUTC,r){case"Milliseconds":return void(h?l.setUTCMilliseconds(a):l.setMilliseconds(a));case"Seconds":return void(h?l.setUTCSeconds(a):l.setSeconds(a));case"Minutes":return void(h?l.setUTCMinutes(a):l.setMinutes(a));case"Hours":return void(h?l.setUTCHours(a):l.setHours(a));case"Date":return void(h?l.setUTCDate(a):l.setDate(a));case"FullYear":break;default:return}f=a,p=n.month(),T=n.date(),T=T===29&&p===1&&!pn(f)?28:T,h?l.setUTCFullYear(f,p,T):l.setFullYear(f,p,T)}}function kc(n){return n=ie(n),me(this[n])?this[n]():this}function Mc(n,r){if(typeof n=="object"){n=os(n);var a=gc(n),l,h=a.length;for(l=0;l<h;l++)this[a[l].unit](n[a[l].unit])}else if(n=ie(n),me(this[n]))return this[n](r);return this}function bc(n,r){return(n%r+r)%r}var G;Array.prototype.indexOf?G=Array.prototype.indexOf:G=function(n){var r;for(r=0;r<this.length;++r)if(this[r]===n)return r;return-1};function hs(n,r){if(isNaN(n)||isNaN(r))return NaN;var a=bc(r,12);return n+=(r-a)/12,a===1?pn(n)?29:28:31-a%7%2}I("M",["MM",2],"Mo",function(){return this.month()+1}),I("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)}),I("MMMM",0,0,function(n){return this.localeData().months(this,n)}),E("M",Y,Je),E("MM",Y,te),E("MMM",function(n,r){return r.monthsShortRegex(n)}),E("MMMM",function(n,r){return r.monthsRegex(n)}),x(["M","MM"],function(n,r){r[Ce]=b(n)-1}),x(["MMM","MMMM"],function(n,r,a,l){var h=a._locale.monthsParse(n,l,a._strict);h!=null?r[Ce]=h:C(a).invalidMonth=n});var Dc="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),dr="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),fr=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Nc=bt,Rc=bt;function Pc(n,r){return n?i(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||fr).test(r)?"format":"standalone"][n.month()]:i(this._months)?this._months:this._months.standalone}function Ac(n,r){return n?i(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[fr.test(r)?"format":"standalone"][n.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Oc(n,r,a){var l,h,f,p=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],l=0;l<12;++l)f=w([2e3,l]),this._shortMonthsParse[l]=this.monthsShort(f,"").toLocaleLowerCase(),this._longMonthsParse[l]=this.months(f,"").toLocaleLowerCase();return a?r==="MMM"?(h=G.call(this._shortMonthsParse,p),h!==-1?h:null):(h=G.call(this._longMonthsParse,p),h!==-1?h:null):r==="MMM"?(h=G.call(this._shortMonthsParse,p),h!==-1?h:(h=G.call(this._longMonthsParse,p),h!==-1?h:null)):(h=G.call(this._longMonthsParse,p),h!==-1?h:(h=G.call(this._shortMonthsParse,p),h!==-1?h:null))}function xc(n,r,a){var l,h,f;if(this._monthsParseExact)return Oc.call(this,n,r,a);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),l=0;l<12;l++){if(h=w([2e3,l]),a&&!this._longMonthsParse[l]&&(this._longMonthsParse[l]=new RegExp("^"+this.months(h,"").replace(".","")+"$","i"),this._shortMonthsParse[l]=new RegExp("^"+this.monthsShort(h,"").replace(".","")+"$","i")),!a&&!this._monthsParse[l]&&(f="^"+this.months(h,"")+"|^"+this.monthsShort(h,""),this._monthsParse[l]=new RegExp(f.replace(".",""),"i")),a&&r==="MMMM"&&this._longMonthsParse[l].test(n))return l;if(a&&r==="MMM"&&this._shortMonthsParse[l].test(n))return l;if(!a&&this._monthsParse[l].test(n))return l}}function _r(n,r){if(!n.isValid())return n;if(typeof r=="string"){if(/^\d+$/.test(r))r=b(r);else if(r=n.localeData().monthsParse(r),!_(r))return n}var a=r,l=n.date();return l=l<29?l:Math.min(l,hs(n.year(),a)),n._isUTC?n._d.setUTCMonth(a,l):n._d.setMonth(a,l),n}function mr(n){return n!=null?(_r(this,n),t.updateOffset(this,!0),this):Rt(this,"Month")}function Fc(){return hs(this.year(),this.month())}function Lc(n){return this._monthsParseExact?(c(this,"_monthsRegex")||pr.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(c(this,"_monthsShortRegex")||(this._monthsShortRegex=Nc),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function Yc(n){return this._monthsParseExact?(c(this,"_monthsRegex")||pr.call(this),n?this._monthsStrictRegex:this._monthsRegex):(c(this,"_monthsRegex")||(this._monthsRegex=Rc),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function pr(){function n(k,D){return D.length-k.length}var r=[],a=[],l=[],h,f,p,T;for(h=0;h<12;h++)f=w([2e3,h]),p=we(this.monthsShort(f,"")),T=we(this.months(f,"")),r.push(p),a.push(T),l.push(T),l.push(p);r.sort(n),a.sort(n),l.sort(n),this._monthsRegex=new RegExp("^("+l.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Wc(n,r,a,l,h,f,p){var T;return n<100&&n>=0?(T=new Date(n+400,r,a,l,h,f,p),isFinite(T.getFullYear())&&T.setFullYear(n)):T=new Date(n,r,a,l,h,f,p),T}function Pt(n){var r,a;return n<100&&n>=0?(a=Array.prototype.slice.call(arguments),a[0]=n+400,r=new Date(Date.UTC.apply(null,a)),isFinite(r.getUTCFullYear())&&r.setUTCFullYear(n)):r=new Date(Date.UTC.apply(null,arguments)),r}function gn(n,r,a){var l=7+r-a,h=(7+Pt(n,0,l).getUTCDay()-r)%7;return-h+l-1}function gr(n,r,a,l,h){var f=(7+a-l)%7,p=gn(n,l,h),T=1+7*(r-1)+f+p,k,D;return T<=0?(k=n-1,D=Nt(k)+T):T>Nt(n)?(k=n+1,D=T-Nt(n)):(k=n,D=T),{year:k,dayOfYear:D}}function At(n,r,a){var l=gn(n.year(),r,a),h=Math.floor((n.dayOfYear()-l-1)/7)+1,f,p;return h<1?(p=n.year()-1,f=h+Te(p,r,a)):h>Te(n.year(),r,a)?(f=h-Te(n.year(),r,a),p=n.year()+1):(p=n.year(),f=h),{week:f,year:p}}function Te(n,r,a){var l=gn(n,r,a),h=gn(n+1,r,a);return(Nt(n)-l+h)/7}I("w",["ww",2],"wo","week"),I("W",["WW",2],"Wo","isoWeek"),E("w",Y,Je),E("ww",Y,te),E("W",Y,Je),E("WW",Y,te),Dt(["w","ww","W","WW"],function(n,r,a,l){r[l.substr(0,1)]=b(n)});function Uc(n){return At(n,this._week.dow,this._week.doy).week}var Hc={dow:0,doy:6};function Vc(){return this._week.dow}function Gc(){return this._week.doy}function Bc(n){var r=this.localeData().week(this);return n==null?r:this.add((n-r)*7,"d")}function jc(n){var r=At(this,1,4).week;return n==null?r:this.add((n-r)*7,"d")}I("d",0,"do","day"),I("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)}),I("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)}),I("dddd",0,0,function(n){return this.localeData().weekdays(this,n)}),I("e",0,0,"weekday"),I("E",0,0,"isoWeekday"),E("d",Y),E("e",Y),E("E",Y),E("dd",function(n,r){return r.weekdaysMinRegex(n)}),E("ddd",function(n,r){return r.weekdaysShortRegex(n)}),E("dddd",function(n,r){return r.weekdaysRegex(n)}),Dt(["dd","ddd","dddd"],function(n,r,a,l){var h=a._locale.weekdaysParse(n,l,a._strict);h!=null?r.d=h:C(a).invalidWeekday=n}),Dt(["d","e","E"],function(n,r,a,l){r[l]=b(n)});function $c(n,r){return typeof n!="string"?n:isNaN(n)?(n=r.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function zc(n,r){return typeof n=="string"?r.weekdaysParse(n)%7||7:isNaN(n)?null:n}function ds(n,r){return n.slice(r,7).concat(n.slice(0,r))}var qc="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),yr="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Kc="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Qc=bt,Zc=bt,Xc=bt;function Jc(n,r){var a=i(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(r)?"format":"standalone"];return n===!0?ds(a,this._week.dow):n?a[n.day()]:a}function eu(n){return n===!0?ds(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function tu(n){return n===!0?ds(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function nu(n,r,a){var l,h,f,p=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],l=0;l<7;++l)f=w([2e3,1]).day(l),this._minWeekdaysParse[l]=this.weekdaysMin(f,"").toLocaleLowerCase(),this._shortWeekdaysParse[l]=this.weekdaysShort(f,"").toLocaleLowerCase(),this._weekdaysParse[l]=this.weekdays(f,"").toLocaleLowerCase();return a?r==="dddd"?(h=G.call(this._weekdaysParse,p),h!==-1?h:null):r==="ddd"?(h=G.call(this._shortWeekdaysParse,p),h!==-1?h:null):(h=G.call(this._minWeekdaysParse,p),h!==-1?h:null):r==="dddd"?(h=G.call(this._weekdaysParse,p),h!==-1||(h=G.call(this._shortWeekdaysParse,p),h!==-1)?h:(h=G.call(this._minWeekdaysParse,p),h!==-1?h:null)):r==="ddd"?(h=G.call(this._shortWeekdaysParse,p),h!==-1||(h=G.call(this._weekdaysParse,p),h!==-1)?h:(h=G.call(this._minWeekdaysParse,p),h!==-1?h:null)):(h=G.call(this._minWeekdaysParse,p),h!==-1||(h=G.call(this._weekdaysParse,p),h!==-1)?h:(h=G.call(this._shortWeekdaysParse,p),h!==-1?h:null))}function su(n,r,a){var l,h,f;if(this._weekdaysParseExact)return nu.call(this,n,r,a);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),l=0;l<7;l++){if(h=w([2e3,1]).day(l),a&&!this._fullWeekdaysParse[l]&&(this._fullWeekdaysParse[l]=new RegExp("^"+this.weekdays(h,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[l]=new RegExp("^"+this.weekdaysShort(h,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[l]=new RegExp("^"+this.weekdaysMin(h,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[l]||(f="^"+this.weekdays(h,"")+"|^"+this.weekdaysShort(h,"")+"|^"+this.weekdaysMin(h,""),this._weekdaysParse[l]=new RegExp(f.replace(".",""),"i")),a&&r==="dddd"&&this._fullWeekdaysParse[l].test(n))return l;if(a&&r==="ddd"&&this._shortWeekdaysParse[l].test(n))return l;if(a&&r==="dd"&&this._minWeekdaysParse[l].test(n))return l;if(!a&&this._weekdaysParse[l].test(n))return l}}function iu(n){if(!this.isValid())return n!=null?this:NaN;var r=Rt(this,"Day");return n!=null?(n=$c(n,this.localeData()),this.add(n-r,"d")):r}function ru(n){if(!this.isValid())return n!=null?this:NaN;var r=(this.day()+7-this.localeData()._week.dow)%7;return n==null?r:this.add(n-r,"d")}function ou(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var r=zc(n,this.localeData());return this.day(this.day()%7?r:r-7)}else return this.day()||7}function au(n){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||fs.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(c(this,"_weekdaysRegex")||(this._weekdaysRegex=Qc),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function lu(n){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||fs.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(c(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Zc),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function cu(n){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||fs.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(c(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Xc),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function fs(){function n(J,be){return be.length-J.length}var r=[],a=[],l=[],h=[],f,p,T,k,D;for(f=0;f<7;f++)p=w([2e3,1]).day(f),T=we(this.weekdaysMin(p,"")),k=we(this.weekdaysShort(p,"")),D=we(this.weekdays(p,"")),r.push(T),a.push(k),l.push(D),h.push(T),h.push(k),h.push(D);r.sort(n),a.sort(n),l.sort(n),h.sort(n),this._weekdaysRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+r.join("|")+")","i")}function _s(){return this.hours()%12||12}function uu(){return this.hours()||24}I("H",["HH",2],0,"hour"),I("h",["hh",2],0,_s),I("k",["kk",2],0,uu),I("hmm",0,0,function(){return""+_s.apply(this)+pe(this.minutes(),2)}),I("hmmss",0,0,function(){return""+_s.apply(this)+pe(this.minutes(),2)+pe(this.seconds(),2)}),I("Hmm",0,0,function(){return""+this.hours()+pe(this.minutes(),2)}),I("Hmmss",0,0,function(){return""+this.hours()+pe(this.minutes(),2)+pe(this.seconds(),2)});function vr(n,r){I(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),r)})}vr("a",!0),vr("A",!1);function wr(n,r){return r._meridiemParse}E("a",wr),E("A",wr),E("H",Y,cs),E("h",Y,Je),E("k",Y,Je),E("HH",Y,te),E("hh",Y,te),E("kk",Y,te),E("hmm",lr),E("hmmss",cr),E("Hmm",lr),E("Hmmss",cr),x(["H","HH"],j),x(["k","kk"],function(n,r,a){var l=b(n);r[j]=l===24?0:l}),x(["a","A"],function(n,r,a){a._isPm=a._locale.isPM(n),a._meridiem=n}),x(["h","hh"],function(n,r,a){r[j]=b(n),C(a).bigHour=!0}),x("hmm",function(n,r,a){var l=n.length-2;r[j]=b(n.substr(0,l)),r[ue]=b(n.substr(l)),C(a).bigHour=!0}),x("hmmss",function(n,r,a){var l=n.length-4,h=n.length-2;r[j]=b(n.substr(0,l)),r[ue]=b(n.substr(l,2)),r[Se]=b(n.substr(h)),C(a).bigHour=!0}),x("Hmm",function(n,r,a){var l=n.length-2;r[j]=b(n.substr(0,l)),r[ue]=b(n.substr(l))}),x("Hmmss",function(n,r,a){var l=n.length-4,h=n.length-2;r[j]=b(n.substr(0,l)),r[ue]=b(n.substr(l,2)),r[Se]=b(n.substr(h))});function hu(n){return(n+"").toLowerCase().charAt(0)==="p"}var du=/[ap]\.?m?\.?/i,fu=et("Hours",!0);function _u(n,r,a){return n>11?a?"pm":"PM":a?"am":"AM"}var Cr={calendar:nc,longDateFormat:oc,invalidDate:lc,ordinal:uc,dayOfMonthOrdinalParse:hc,relativeTime:fc,months:Dc,monthsShort:dr,week:Hc,weekdays:qc,weekdaysMin:Kc,weekdaysShort:yr,meridiemParse:du},H={},Ot={},xt;function mu(n,r){var a,l=Math.min(n.length,r.length);for(a=0;a<l;a+=1)if(n[a]!==r[a])return a;return l}function Sr(n){return n&&n.toLowerCase().replace("_","-")}function pu(n){for(var r=0,a,l,h,f;r<n.length;){for(f=Sr(n[r]).split("-"),a=f.length,l=Sr(n[r+1]),l=l?l.split("-"):null;a>0;){if(h=yn(f.slice(0,a).join("-")),h)return h;if(l&&l.length>=a&&mu(f,l)>=a-1)break;a--}r++}return xt}function gu(n){return!!(n&&n.match("^[^/\\\\]*$"))}function yn(n){var r=null,a;if(H[n]===void 0&&typeof It<"u"&&It&&It.exports&&gu(n))try{r=xt._abbr,a=Kr,a("./locale/"+n),Pe(r)}catch{H[n]=null}return H[n]}function Pe(n,r){var a;return n&&(d(r)?a=Ee(n):a=ms(n,r),a?xt=a:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),xt._abbr}function ms(n,r){if(r!==null){var a,l=Cr;if(r.abbr=n,H[n]!=null)sr("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),l=H[n]._config;else if(r.parentLocale!=null)if(H[r.parentLocale]!=null)l=H[r.parentLocale]._config;else if(a=yn(r.parentLocale),a!=null)l=a._config;else return Ot[r.parentLocale]||(Ot[r.parentLocale]=[]),Ot[r.parentLocale].push({name:n,config:r}),null;return H[n]=new ns(ts(l,r)),Ot[n]&&Ot[n].forEach(function(h){ms(h.name,h.config)}),Pe(n),H[n]}else return delete H[n],null}function yu(n,r){if(r!=null){var a,l,h=Cr;H[n]!=null&&H[n].parentLocale!=null?H[n].set(ts(H[n]._config,r)):(l=yn(n),l!=null&&(h=l._config),r=ts(h,r),l==null&&(r.abbr=n),a=new ns(r),a.parentLocale=H[n],H[n]=a),Pe(n)}else H[n]!=null&&(H[n].parentLocale!=null?(H[n]=H[n].parentLocale,n===Pe()&&Pe(n)):H[n]!=null&&delete H[n]);return H[n]}function Ee(n){var r;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return xt;if(!i(n)){if(r=yn(n),r)return r;n=[n]}return pu(n)}function vu(){return ss(H)}function ps(n){var r,a=n._a;return a&&C(n).overflow===-2&&(r=a[Ce]<0||a[Ce]>11?Ce:a[ge]<1||a[ge]>hs(a[K],a[Ce])?ge:a[j]<0||a[j]>24||a[j]===24&&(a[ue]!==0||a[Se]!==0||a[We]!==0)?j:a[ue]<0||a[ue]>59?ue:a[Se]<0||a[Se]>59?Se:a[We]<0||a[We]>999?We:-1,C(n)._overflowDayOfYear&&(r<K||r>ge)&&(r=ge),C(n)._overflowWeeks&&r===-1&&(r=Tc),C(n)._overflowWeekday&&r===-1&&(r=Ec),C(n).overflow=r),n}var wu=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Cu=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Su=/Z|[+-]\d\d(?::?\d\d)?/,vn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],gs=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Tu=/^\/?Date\((-?\d+)/i,Eu=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Iu={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Tr(n){var r,a,l=n._i,h=wu.exec(l)||Cu.exec(l),f,p,T,k,D=vn.length,J=gs.length;if(h){for(C(n).iso=!0,r=0,a=D;r<a;r++)if(vn[r][1].exec(h[1])){p=vn[r][0],f=vn[r][2]!==!1;break}if(p==null){n._isValid=!1;return}if(h[3]){for(r=0,a=J;r<a;r++)if(gs[r][1].exec(h[3])){T=(h[2]||" ")+gs[r][0];break}if(T==null){n._isValid=!1;return}}if(!f&&T!=null){n._isValid=!1;return}if(h[4])if(Su.exec(h[4]))k="Z";else{n._isValid=!1;return}n._f=p+(T||"")+(k||""),vs(n)}else n._isValid=!1}function ku(n,r,a,l,h,f){var p=[Mu(n),dr.indexOf(r),parseInt(a,10),parseInt(l,10),parseInt(h,10)];return f&&p.push(parseInt(f,10)),p}function Mu(n){var r=parseInt(n,10);return r<=49?2e3+r:r<=999?1900+r:r}function bu(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Du(n,r,a){if(n){var l=yr.indexOf(n),h=new Date(r[0],r[1],r[2]).getDay();if(l!==h)return C(a).weekdayMismatch=!0,a._isValid=!1,!1}return!0}function Nu(n,r,a){if(n)return Iu[n];if(r)return 0;var l=parseInt(a,10),h=l%100,f=(l-h)/100;return f*60+h}function Er(n){var r=Eu.exec(bu(n._i)),a;if(r){if(a=ku(r[4],r[3],r[2],r[5],r[6],r[7]),!Du(r[1],a,n))return;n._a=a,n._tzm=Nu(r[8],r[9],r[10]),n._d=Pt.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),C(n).rfc2822=!0}else n._isValid=!1}function Ru(n){var r=Tu.exec(n._i);if(r!==null){n._d=new Date(+r[1]);return}if(Tr(n),n._isValid===!1)delete n._isValid;else return;if(Er(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:t.createFromInputFallback(n)}t.createFromInputFallback=se("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function tt(n,r,a){return n??r??a}function Pu(n){var r=new Date(t.now());return n._useUTC?[r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()]:[r.getFullYear(),r.getMonth(),r.getDate()]}function ys(n){var r,a,l=[],h,f,p;if(!n._d){for(h=Pu(n),n._w&&n._a[ge]==null&&n._a[Ce]==null&&Au(n),n._dayOfYear!=null&&(p=tt(n._a[K],h[K]),(n._dayOfYear>Nt(p)||n._dayOfYear===0)&&(C(n)._overflowDayOfYear=!0),a=Pt(p,0,n._dayOfYear),n._a[Ce]=a.getUTCMonth(),n._a[ge]=a.getUTCDate()),r=0;r<3&&n._a[r]==null;++r)n._a[r]=l[r]=h[r];for(;r<7;r++)n._a[r]=l[r]=n._a[r]==null?r===2?1:0:n._a[r];n._a[j]===24&&n._a[ue]===0&&n._a[Se]===0&&n._a[We]===0&&(n._nextDay=!0,n._a[j]=0),n._d=(n._useUTC?Pt:Wc).apply(null,l),f=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[j]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==f&&(C(n).weekdayMismatch=!0)}}function Au(n){var r,a,l,h,f,p,T,k,D;r=n._w,r.GG!=null||r.W!=null||r.E!=null?(f=1,p=4,a=tt(r.GG,n._a[K],At(W(),1,4).year),l=tt(r.W,1),h=tt(r.E,1),(h<1||h>7)&&(k=!0)):(f=n._locale._week.dow,p=n._locale._week.doy,D=At(W(),f,p),a=tt(r.gg,n._a[K],D.year),l=tt(r.w,D.week),r.d!=null?(h=r.d,(h<0||h>6)&&(k=!0)):r.e!=null?(h=r.e+f,(r.e<0||r.e>6)&&(k=!0)):h=f),l<1||l>Te(a,f,p)?C(n)._overflowWeeks=!0:k!=null?C(n)._overflowWeekday=!0:(T=gr(a,l,h,f,p),n._a[K]=T.year,n._dayOfYear=T.dayOfYear)}t.ISO_8601=function(){},t.RFC_2822=function(){};function vs(n){if(n._f===t.ISO_8601){Tr(n);return}if(n._f===t.RFC_2822){Er(n);return}n._a=[],C(n).empty=!0;var r=""+n._i,a,l,h,f,p,T=r.length,k=0,D,J;for(h=ir(n._f,n._locale).match(is)||[],J=h.length,a=0;a<J;a++)f=h[a],l=(r.match(wc(f,n))||[])[0],l&&(p=r.substr(0,r.indexOf(l)),p.length>0&&C(n).unusedInput.push(p),r=r.slice(r.indexOf(l)+l.length),k+=l.length),Ze[f]?(l?C(n).empty=!1:C(n).unusedTokens.push(f),Sc(f,l,n)):n._strict&&!l&&C(n).unusedTokens.push(f);C(n).charsLeftOver=T-k,r.length>0&&C(n).unusedInput.push(r),n._a[j]<=12&&C(n).bigHour===!0&&n._a[j]>0&&(C(n).bigHour=void 0),C(n).parsedDateParts=n._a.slice(0),C(n).meridiem=n._meridiem,n._a[j]=Ou(n._locale,n._a[j],n._meridiem),D=C(n).era,D!==null&&(n._a[K]=n._locale.erasConvertYear(D,n._a[K])),ys(n),ps(n)}function Ou(n,r,a){var l;return a==null?r:n.meridiemHour!=null?n.meridiemHour(r,a):(n.isPM!=null&&(l=n.isPM(a),l&&r<12&&(r+=12),!l&&r===12&&(r=0)),r)}function xu(n){var r,a,l,h,f,p,T=!1,k=n._f.length;if(k===0){C(n).invalidFormat=!0,n._d=new Date(NaN);return}for(h=0;h<k;h++)f=0,p=!1,r=kt({},n),n._useUTC!=null&&(r._useUTC=n._useUTC),r._f=n._f[h],vs(r),q(r)&&(p=!0),f+=C(r).charsLeftOver,f+=C(r).unusedTokens.length*10,C(r).score=f,T?f<l&&(l=f,a=r):(l==null||f<l||p)&&(l=f,a=r,p&&(T=!0));g(n,a||r)}function Fu(n){if(!n._d){var r=os(n._i),a=r.day===void 0?r.date:r.day;n._a=y([r.year,r.month,a,r.hour,r.minute,r.second,r.millisecond],function(l){return l&&parseInt(l,10)}),ys(n)}}function Lu(n){var r=new Mt(ps(Ir(n)));return r._nextDay&&(r.add(1,"d"),r._nextDay=void 0),r}function Ir(n){var r=n._i,a=n._f;return n._locale=n._locale||Ee(n._l),r===null||a===void 0&&r===""?Re({nullInput:!0}):(typeof r=="string"&&(n._i=r=n._locale.preparse(r)),ce(r)?new Mt(ps(r)):(m(r)?n._d=r:i(a)?xu(n):a?vs(n):Yu(n),q(n)||(n._d=null),n))}function Yu(n){var r=n._i;d(r)?n._d=new Date(t.now()):m(r)?n._d=new Date(r.valueOf()):typeof r=="string"?Ru(n):i(r)?(n._a=y(r.slice(0),function(a){return parseInt(a,10)}),ys(n)):o(r)?Fu(n):_(r)?n._d=new Date(r):t.createFromInputFallback(n)}function kr(n,r,a,l,h){var f={};return(r===!0||r===!1)&&(l=r,r=void 0),(a===!0||a===!1)&&(l=a,a=void 0),(o(n)&&u(n)||i(n)&&n.length===0)&&(n=void 0),f._isAMomentObject=!0,f._useUTC=f._isUTC=h,f._l=a,f._i=n,f._f=r,f._strict=l,Lu(f)}function W(n,r,a,l){return kr(n,r,a,l,!1)}var Wu=se("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=W.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:Re()}),Uu=se("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=W.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:Re()});function Mr(n,r){var a,l;if(r.length===1&&i(r[0])&&(r=r[0]),!r.length)return W();for(a=r[0],l=1;l<r.length;++l)(!r[l].isValid()||r[l][n](a))&&(a=r[l]);return a}function Hu(){var n=[].slice.call(arguments,0);return Mr("isBefore",n)}function Vu(){var n=[].slice.call(arguments,0);return Mr("isAfter",n)}var Gu=function(){return Date.now?Date.now():+new Date},Ft=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Bu(n){var r,a=!1,l,h=Ft.length;for(r in n)if(c(n,r)&&!(G.call(Ft,r)!==-1&&(n[r]==null||!isNaN(n[r]))))return!1;for(l=0;l<h;++l)if(n[Ft[l]]){if(a)return!1;parseFloat(n[Ft[l]])!==b(n[Ft[l]])&&(a=!0)}return!0}function ju(){return this._isValid}function $u(){return he(NaN)}function wn(n){var r=os(n),a=r.year||0,l=r.quarter||0,h=r.month||0,f=r.week||r.isoWeek||0,p=r.day||0,T=r.hour||0,k=r.minute||0,D=r.second||0,J=r.millisecond||0;this._isValid=Bu(r),this._milliseconds=+J+D*1e3+k*6e4+T*1e3*60*60,this._days=+p+f*7,this._months=+h+l*3+a*12,this._data={},this._locale=Ee(),this._bubble()}function Cn(n){return n instanceof wn}function ws(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function zu(n,r,a){var l=Math.min(n.length,r.length),h=Math.abs(n.length-r.length),f=0,p;for(p=0;p<l;p++)(a&&n[p]!==r[p]||!a&&b(n[p])!==b(r[p]))&&f++;return f+h}function br(n,r){I(n,0,0,function(){var a=this.utcOffset(),l="+";return a<0&&(a=-a,l="-"),l+pe(~~(a/60),2)+r+pe(~~a%60,2)})}br("Z",":"),br("ZZ",""),E("Z",_n),E("ZZ",_n),x(["Z","ZZ"],function(n,r,a){a._useUTC=!0,a._tzm=Cs(_n,n)});var qu=/([\+\-]|\d\d)/gi;function Cs(n,r){var a=(r||"").match(n),l,h,f;return a===null?null:(l=a[a.length-1]||[],h=(l+"").match(qu)||["-",0,0],f=+(h[1]*60)+b(h[2]),f===0?0:h[0]==="+"?f:-f)}function Ss(n,r){var a,l;return r._isUTC?(a=r.clone(),l=(ce(n)||m(n)?n.valueOf():W(n).valueOf())-a.valueOf(),a._d.setTime(a._d.valueOf()+l),t.updateOffset(a,!1),a):W(n).local()}function Ts(n){return-Math.round(n._d.getTimezoneOffset())}t.updateOffset=function(){};function Ku(n,r,a){var l=this._offset||0,h;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=Cs(_n,n),n===null)return this}else Math.abs(n)<16&&!a&&(n=n*60);return!this._isUTC&&r&&(h=Ts(this)),this._offset=n,this._isUTC=!0,h!=null&&this.add(h,"m"),l!==n&&(!r||this._changeInProgress?Pr(this,he(n-l,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?l:Ts(this)}function Qu(n,r){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,r),this):-this.utcOffset()}function Zu(n){return this.utcOffset(0,n)}function Xu(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(Ts(this),"m")),this}function Ju(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=Cs(yc,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function eh(n){return this.isValid()?(n=n?W(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function th(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function nh(){if(!d(this._isDSTShifted))return this._isDSTShifted;var n={},r;return kt(n,this),n=Ir(n),n._a?(r=n._isUTC?w(n._a):W(n._a),this._isDSTShifted=this.isValid()&&zu(n._a,r.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function sh(){return this.isValid()?!this._isUTC:!1}function ih(){return this.isValid()?this._isUTC:!1}function Dr(){return this.isValid()?this._isUTC&&this._offset===0:!1}var rh=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,oh=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function he(n,r){var a=n,l=null,h,f,p;return Cn(n)?a={ms:n._milliseconds,d:n._days,M:n._months}:_(n)||!isNaN(+n)?(a={},r?a[r]=+n:a.milliseconds=+n):(l=rh.exec(n))?(h=l[1]==="-"?-1:1,a={y:0,d:b(l[ge])*h,h:b(l[j])*h,m:b(l[ue])*h,s:b(l[Se])*h,ms:b(ws(l[We]*1e3))*h}):(l=oh.exec(n))?(h=l[1]==="-"?-1:1,a={y:Ue(l[2],h),M:Ue(l[3],h),w:Ue(l[4],h),d:Ue(l[5],h),h:Ue(l[6],h),m:Ue(l[7],h),s:Ue(l[8],h)}):a==null?a={}:typeof a=="object"&&("from"in a||"to"in a)&&(p=ah(W(a.from),W(a.to)),a={},a.ms=p.milliseconds,a.M=p.months),f=new wn(a),Cn(n)&&c(n,"_locale")&&(f._locale=n._locale),Cn(n)&&c(n,"_isValid")&&(f._isValid=n._isValid),f}he.fn=wn.prototype,he.invalid=$u;function Ue(n,r){var a=n&&parseFloat(n.replace(",","."));return(isNaN(a)?0:a)*r}function Nr(n,r){var a={};return a.months=r.month()-n.month()+(r.year()-n.year())*12,n.clone().add(a.months,"M").isAfter(r)&&--a.months,a.milliseconds=+r-+n.clone().add(a.months,"M"),a}function ah(n,r){var a;return n.isValid()&&r.isValid()?(r=Ss(r,n),n.isBefore(r)?a=Nr(n,r):(a=Nr(r,n),a.milliseconds=-a.milliseconds,a.months=-a.months),a):{milliseconds:0,months:0}}function Rr(n,r){return function(a,l){var h,f;return l!==null&&!isNaN(+l)&&(sr(r,"moment()."+r+"(period, number) is deprecated. Please use moment()."+r+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),f=a,a=l,l=f),h=he(a,l),Pr(this,h,n),this}}function Pr(n,r,a,l){var h=r._milliseconds,f=ws(r._days),p=ws(r._months);n.isValid()&&(l=l??!0,p&&_r(n,Rt(n,"Month")+p*a),f&&hr(n,"Date",Rt(n,"Date")+f*a),h&&n._d.setTime(n._d.valueOf()+h*a),l&&t.updateOffset(n,f||p))}var lh=Rr(1,"add"),ch=Rr(-1,"subtract");function Ar(n){return typeof n=="string"||n instanceof String}function uh(n){return ce(n)||m(n)||Ar(n)||_(n)||dh(n)||hh(n)||n===null||n===void 0}function hh(n){var r=o(n)&&!u(n),a=!1,l=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],h,f,p=l.length;for(h=0;h<p;h+=1)f=l[h],a=a||c(n,f);return r&&a}function dh(n){var r=i(n),a=!1;return r&&(a=n.filter(function(l){return!_(l)&&Ar(n)}).length===0),r&&a}function fh(n){var r=o(n)&&!u(n),a=!1,l=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],h,f;for(h=0;h<l.length;h+=1)f=l[h],a=a||c(n,f);return r&&a}function _h(n,r){var a=n.diff(r,"days",!0);return a<-6?"sameElse":a<-1?"lastWeek":a<0?"lastDay":a<1?"sameDay":a<2?"nextDay":a<7?"nextWeek":"sameElse"}function mh(n,r){arguments.length===1&&(arguments[0]?uh(arguments[0])?(n=arguments[0],r=void 0):fh(arguments[0])&&(r=arguments[0],n=void 0):(n=void 0,r=void 0));var a=n||W(),l=Ss(a,this).startOf("day"),h=t.calendarFormat(this,l)||"sameElse",f=r&&(me(r[h])?r[h].call(this,a):r[h]);return this.format(f||this.localeData().calendar(h,this,W(a)))}function ph(){return new Mt(this)}function gh(n,r){var a=ce(n)?n:W(n);return this.isValid()&&a.isValid()?(r=ie(r)||"millisecond",r==="millisecond"?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(r).valueOf()):!1}function yh(n,r){var a=ce(n)?n:W(n);return this.isValid()&&a.isValid()?(r=ie(r)||"millisecond",r==="millisecond"?this.valueOf()<a.valueOf():this.clone().endOf(r).valueOf()<a.valueOf()):!1}function vh(n,r,a,l){var h=ce(n)?n:W(n),f=ce(r)?r:W(r);return this.isValid()&&h.isValid()&&f.isValid()?(l=l||"()",(l[0]==="("?this.isAfter(h,a):!this.isBefore(h,a))&&(l[1]===")"?this.isBefore(f,a):!this.isAfter(f,a))):!1}function wh(n,r){var a=ce(n)?n:W(n),l;return this.isValid()&&a.isValid()?(r=ie(r)||"millisecond",r==="millisecond"?this.valueOf()===a.valueOf():(l=a.valueOf(),this.clone().startOf(r).valueOf()<=l&&l<=this.clone().endOf(r).valueOf())):!1}function Ch(n,r){return this.isSame(n,r)||this.isAfter(n,r)}function Sh(n,r){return this.isSame(n,r)||this.isBefore(n,r)}function Th(n,r,a){var l,h,f;if(!this.isValid())return NaN;if(l=Ss(n,this),!l.isValid())return NaN;switch(h=(l.utcOffset()-this.utcOffset())*6e4,r=ie(r),r){case"year":f=Sn(this,l)/12;break;case"month":f=Sn(this,l);break;case"quarter":f=Sn(this,l)/3;break;case"second":f=(this-l)/1e3;break;case"minute":f=(this-l)/6e4;break;case"hour":f=(this-l)/36e5;break;case"day":f=(this-l-h)/864e5;break;case"week":f=(this-l-h)/6048e5;break;default:f=this-l}return a?f:re(f)}function Sn(n,r){if(n.date()<r.date())return-Sn(r,n);var a=(r.year()-n.year())*12+(r.month()-n.month()),l=n.clone().add(a,"months"),h,f;return r-l<0?(h=n.clone().add(a-1,"months"),f=(r-l)/(l-h)):(h=n.clone().add(a+1,"months"),f=(r-l)/(h-l)),-(a+f)||0}t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Eh(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Ih(n){if(!this.isValid())return null;var r=n!==!0,a=r?this.clone().utc():this;return a.year()<0||a.year()>9999?cn(a,r?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):me(Date.prototype.toISOString)?r?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",cn(a,"Z")):cn(a,r?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function kh(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",r="",a,l,h,f;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",r="Z"),a="["+n+'("]',l=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",h="-MM-DD[T]HH:mm:ss.SSS",f=r+'[")]',this.format(a+l+h+f)}function Mh(n){n||(n=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var r=cn(this,n);return this.localeData().postformat(r)}function bh(n,r){return this.isValid()&&(ce(n)&&n.isValid()||W(n).isValid())?he({to:this,from:n}).locale(this.locale()).humanize(!r):this.localeData().invalidDate()}function Dh(n){return this.from(W(),n)}function Nh(n,r){return this.isValid()&&(ce(n)&&n.isValid()||W(n).isValid())?he({from:this,to:n}).locale(this.locale()).humanize(!r):this.localeData().invalidDate()}function Rh(n){return this.to(W(),n)}function Or(n){var r;return n===void 0?this._locale._abbr:(r=Ee(n),r!=null&&(this._locale=r),this)}var xr=se("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function Fr(){return this._locale}var Tn=1e3,nt=60*Tn,En=60*nt,Lr=(365*400+97)*24*En;function st(n,r){return(n%r+r)%r}function Yr(n,r,a){return n<100&&n>=0?new Date(n+400,r,a)-Lr:new Date(n,r,a).valueOf()}function Wr(n,r,a){return n<100&&n>=0?Date.UTC(n+400,r,a)-Lr:Date.UTC(n,r,a)}function Ph(n){var r,a;if(n=ie(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(a=this._isUTC?Wr:Yr,n){case"year":r=a(this.year(),0,1);break;case"quarter":r=a(this.year(),this.month()-this.month()%3,1);break;case"month":r=a(this.year(),this.month(),1);break;case"week":r=a(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":r=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":r=a(this.year(),this.month(),this.date());break;case"hour":r=this._d.valueOf(),r-=st(r+(this._isUTC?0:this.utcOffset()*nt),En);break;case"minute":r=this._d.valueOf(),r-=st(r,nt);break;case"second":r=this._d.valueOf(),r-=st(r,Tn);break}return this._d.setTime(r),t.updateOffset(this,!0),this}function Ah(n){var r,a;if(n=ie(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(a=this._isUTC?Wr:Yr,n){case"year":r=a(this.year()+1,0,1)-1;break;case"quarter":r=a(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":r=a(this.year(),this.month()+1,1)-1;break;case"week":r=a(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":r=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":r=a(this.year(),this.month(),this.date()+1)-1;break;case"hour":r=this._d.valueOf(),r+=En-st(r+(this._isUTC?0:this.utcOffset()*nt),En)-1;break;case"minute":r=this._d.valueOf(),r+=nt-st(r,nt)-1;break;case"second":r=this._d.valueOf(),r+=Tn-st(r,Tn)-1;break}return this._d.setTime(r),t.updateOffset(this,!0),this}function Oh(){return this._d.valueOf()-(this._offset||0)*6e4}function xh(){return Math.floor(this.valueOf()/1e3)}function Fh(){return new Date(this.valueOf())}function Lh(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function Yh(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function Wh(){return this.isValid()?this.toISOString():null}function Uh(){return q(this)}function Hh(){return g({},C(this))}function Vh(){return C(this).overflow}function Gh(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}I("N",0,0,"eraAbbr"),I("NN",0,0,"eraAbbr"),I("NNN",0,0,"eraAbbr"),I("NNNN",0,0,"eraName"),I("NNNNN",0,0,"eraNarrow"),I("y",["y",1],"yo","eraYear"),I("y",["yy",2],0,"eraYear"),I("y",["yyy",3],0,"eraYear"),I("y",["yyyy",4],0,"eraYear"),E("N",Es),E("NN",Es),E("NNN",Es),E("NNNN",ed),E("NNNNN",td),x(["N","NN","NNN","NNNN","NNNNN"],function(n,r,a,l){var h=a._locale.erasParse(n,l,a._strict);h?C(a).era=h:C(a).invalidEra=n}),E("y",Xe),E("yy",Xe),E("yyy",Xe),E("yyyy",Xe),E("yo",nd),x(["y","yy","yyy","yyyy"],K),x(["yo"],function(n,r,a,l){var h;a._locale._eraYearOrdinalRegex&&(h=n.match(a._locale._eraYearOrdinalRegex)),a._locale.eraYearOrdinalParse?r[K]=a._locale.eraYearOrdinalParse(n,h):r[K]=parseInt(n,10)});function Bh(n,r){var a,l,h,f=this._eras||Ee("en")._eras;for(a=0,l=f.length;a<l;++a){switch(typeof f[a].since){case"string":h=t(f[a].since).startOf("day"),f[a].since=h.valueOf();break}switch(typeof f[a].until){case"undefined":f[a].until=1/0;break;case"string":h=t(f[a].until).startOf("day").valueOf(),f[a].until=h.valueOf();break}}return f}function jh(n,r,a){var l,h,f=this.eras(),p,T,k;for(n=n.toUpperCase(),l=0,h=f.length;l<h;++l)if(p=f[l].name.toUpperCase(),T=f[l].abbr.toUpperCase(),k=f[l].narrow.toUpperCase(),a)switch(r){case"N":case"NN":case"NNN":if(T===n)return f[l];break;case"NNNN":if(p===n)return f[l];break;case"NNNNN":if(k===n)return f[l];break}else if([p,T,k].indexOf(n)>=0)return f[l]}function $h(n,r){var a=n.since<=n.until?1:-1;return r===void 0?t(n.since).year():t(n.since).year()+(r-n.offset)*a}function zh(){var n,r,a,l=this.localeData().eras();for(n=0,r=l.length;n<r;++n)if(a=this.clone().startOf("day").valueOf(),l[n].since<=a&&a<=l[n].until||l[n].until<=a&&a<=l[n].since)return l[n].name;return""}function qh(){var n,r,a,l=this.localeData().eras();for(n=0,r=l.length;n<r;++n)if(a=this.clone().startOf("day").valueOf(),l[n].since<=a&&a<=l[n].until||l[n].until<=a&&a<=l[n].since)return l[n].narrow;return""}function Kh(){var n,r,a,l=this.localeData().eras();for(n=0,r=l.length;n<r;++n)if(a=this.clone().startOf("day").valueOf(),l[n].since<=a&&a<=l[n].until||l[n].until<=a&&a<=l[n].since)return l[n].abbr;return""}function Qh(){var n,r,a,l,h=this.localeData().eras();for(n=0,r=h.length;n<r;++n)if(a=h[n].since<=h[n].until?1:-1,l=this.clone().startOf("day").valueOf(),h[n].since<=l&&l<=h[n].until||h[n].until<=l&&l<=h[n].since)return(this.year()-t(h[n].since).year())*a+h[n].offset;return this.year()}function Zh(n){return c(this,"_erasNameRegex")||Is.call(this),n?this._erasNameRegex:this._erasRegex}function Xh(n){return c(this,"_erasAbbrRegex")||Is.call(this),n?this._erasAbbrRegex:this._erasRegex}function Jh(n){return c(this,"_erasNarrowRegex")||Is.call(this),n?this._erasNarrowRegex:this._erasRegex}function Es(n,r){return r.erasAbbrRegex(n)}function ed(n,r){return r.erasNameRegex(n)}function td(n,r){return r.erasNarrowRegex(n)}function nd(n,r){return r._eraYearOrdinalRegex||Xe}function Is(){var n=[],r=[],a=[],l=[],h,f,p,T,k,D=this.eras();for(h=0,f=D.length;h<f;++h)p=we(D[h].name),T=we(D[h].abbr),k=we(D[h].narrow),r.push(p),n.push(T),a.push(k),l.push(p),l.push(T),l.push(k);this._erasRegex=new RegExp("^("+l.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+r.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+a.join("|")+")","i")}I(0,["gg",2],0,function(){return this.weekYear()%100}),I(0,["GG",2],0,function(){return this.isoWeekYear()%100});function In(n,r){I(0,[n,n.length],0,r)}In("gggg","weekYear"),In("ggggg","weekYear"),In("GGGG","isoWeekYear"),In("GGGGG","isoWeekYear"),E("G",fn),E("g",fn),E("GG",Y,te),E("gg",Y,te),E("GGGG",ls,as),E("gggg",ls,as),E("GGGGG",dn,un),E("ggggg",dn,un),Dt(["gggg","ggggg","GGGG","GGGGG"],function(n,r,a,l){r[l.substr(0,2)]=b(n)}),Dt(["gg","GG"],function(n,r,a,l){r[l]=t.parseTwoDigitYear(n)});function sd(n){return Ur.call(this,n,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function id(n){return Ur.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function rd(){return Te(this.year(),1,4)}function od(){return Te(this.isoWeekYear(),1,4)}function ad(){var n=this.localeData()._week;return Te(this.year(),n.dow,n.doy)}function ld(){var n=this.localeData()._week;return Te(this.weekYear(),n.dow,n.doy)}function Ur(n,r,a,l,h){var f;return n==null?At(this,l,h).year:(f=Te(n,l,h),r>f&&(r=f),cd.call(this,n,r,a,l,h))}function cd(n,r,a,l,h){var f=gr(n,r,a,l,h),p=Pt(f.year,0,f.dayOfYear);return this.year(p.getUTCFullYear()),this.month(p.getUTCMonth()),this.date(p.getUTCDate()),this}I("Q",0,"Qo","quarter"),E("Q",or),x("Q",function(n,r){r[Ce]=(b(n)-1)*3});function ud(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}I("D",["DD",2],"Do","date"),E("D",Y,Je),E("DD",Y,te),E("Do",function(n,r){return n?r._dayOfMonthOrdinalParse||r._ordinalParse:r._dayOfMonthOrdinalParseLenient}),x(["D","DD"],ge),x("Do",function(n,r){r[ge]=b(n.match(Y)[0])});var Hr=et("Date",!0);I("DDD",["DDDD",3],"DDDo","dayOfYear"),E("DDD",hn),E("DDDD",ar),x(["DDD","DDDD"],function(n,r,a){a._dayOfYear=b(n)});function hd(n){var r=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?r:this.add(n-r,"d")}I("m",["mm",2],0,"minute"),E("m",Y,cs),E("mm",Y,te),x(["m","mm"],ue);var dd=et("Minutes",!1);I("s",["ss",2],0,"second"),E("s",Y,cs),E("ss",Y,te),x(["s","ss"],Se);var fd=et("Seconds",!1);I("S",0,0,function(){return~~(this.millisecond()/100)}),I(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),I(0,["SSS",3],0,"millisecond"),I(0,["SSSS",4],0,function(){return this.millisecond()*10}),I(0,["SSSSS",5],0,function(){return this.millisecond()*100}),I(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),I(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),I(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),I(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),E("S",hn,or),E("SS",hn,te),E("SSS",hn,ar);var Ae,Vr;for(Ae="SSSS";Ae.length<=9;Ae+="S")E(Ae,Xe);function _d(n,r){r[We]=b(("0."+n)*1e3)}for(Ae="S";Ae.length<=9;Ae+="S")x(Ae,_d);Vr=et("Milliseconds",!1),I("z",0,0,"zoneAbbr"),I("zz",0,0,"zoneName");function md(){return this._isUTC?"UTC":""}function pd(){return this._isUTC?"Coordinated Universal Time":""}var v=Mt.prototype;v.add=lh,v.calendar=mh,v.clone=ph,v.diff=Th,v.endOf=Ah,v.format=Mh,v.from=bh,v.fromNow=Dh,v.to=Nh,v.toNow=Rh,v.get=kc,v.invalidAt=Vh,v.isAfter=gh,v.isBefore=yh,v.isBetween=vh,v.isSame=wh,v.isSameOrAfter=Ch,v.isSameOrBefore=Sh,v.isValid=Uh,v.lang=xr,v.locale=Or,v.localeData=Fr,v.max=Uu,v.min=Wu,v.parsingFlags=Hh,v.set=Mc,v.startOf=Ph,v.subtract=ch,v.toArray=Lh,v.toObject=Yh,v.toDate=Fh,v.toISOString=Ih,v.inspect=kh,typeof Symbol<"u"&&Symbol.for!=null&&(v[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),v.toJSON=Wh,v.toString=Eh,v.unix=xh,v.valueOf=Oh,v.creationData=Gh,v.eraName=zh,v.eraNarrow=qh,v.eraAbbr=Kh,v.eraYear=Qh,v.year=ur,v.isLeapYear=Ic,v.weekYear=sd,v.isoWeekYear=id,v.quarter=v.quarters=ud,v.month=mr,v.daysInMonth=Fc,v.week=v.weeks=Bc,v.isoWeek=v.isoWeeks=jc,v.weeksInYear=ad,v.weeksInWeekYear=ld,v.isoWeeksInYear=rd,v.isoWeeksInISOWeekYear=od,v.date=Hr,v.day=v.days=iu,v.weekday=ru,v.isoWeekday=ou,v.dayOfYear=hd,v.hour=v.hours=fu,v.minute=v.minutes=dd,v.second=v.seconds=fd,v.millisecond=v.milliseconds=Vr,v.utcOffset=Ku,v.utc=Zu,v.local=Xu,v.parseZone=Ju,v.hasAlignedHourOffset=eh,v.isDST=th,v.isLocal=sh,v.isUtcOffset=ih,v.isUtc=Dr,v.isUTC=Dr,v.zoneAbbr=md,v.zoneName=pd,v.dates=se("dates accessor is deprecated. Use date instead.",Hr),v.months=se("months accessor is deprecated. Use month instead",mr),v.years=se("years accessor is deprecated. Use year instead",ur),v.zone=se("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Qu),v.isDSTShifted=se("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",nh);function gd(n){return W(n*1e3)}function yd(){return W.apply(null,arguments).parseZone()}function Gr(n){return n}var O=ns.prototype;O.calendar=sc,O.longDateFormat=ac,O.invalidDate=cc,O.ordinal=dc,O.preparse=Gr,O.postformat=Gr,O.relativeTime=_c,O.pastFuture=mc,O.set=tc,O.eras=Bh,O.erasParse=jh,O.erasConvertYear=$h,O.erasAbbrRegex=Xh,O.erasNameRegex=Zh,O.erasNarrowRegex=Jh,O.months=Pc,O.monthsShort=Ac,O.monthsParse=xc,O.monthsRegex=Yc,O.monthsShortRegex=Lc,O.week=Uc,O.firstDayOfYear=Gc,O.firstDayOfWeek=Vc,O.weekdays=Jc,O.weekdaysMin=tu,O.weekdaysShort=eu,O.weekdaysParse=su,O.weekdaysRegex=au,O.weekdaysShortRegex=lu,O.weekdaysMinRegex=cu,O.isPM=hu,O.meridiem=_u;function kn(n,r,a,l){var h=Ee(),f=w().set(l,r);return h[a](f,n)}function Br(n,r,a){if(_(n)&&(r=n,n=void 0),n=n||"",r!=null)return kn(n,r,a,"month");var l,h=[];for(l=0;l<12;l++)h[l]=kn(n,l,a,"month");return h}function ks(n,r,a,l){typeof n=="boolean"?(_(r)&&(a=r,r=void 0),r=r||""):(r=n,a=r,n=!1,_(r)&&(a=r,r=void 0),r=r||"");var h=Ee(),f=n?h._week.dow:0,p,T=[];if(a!=null)return kn(r,(a+f)%7,l,"day");for(p=0;p<7;p++)T[p]=kn(r,(p+f)%7,l,"day");return T}function vd(n,r){return Br(n,r,"months")}function wd(n,r){return Br(n,r,"monthsShort")}function Cd(n,r,a){return ks(n,r,a,"weekdays")}function Sd(n,r,a){return ks(n,r,a,"weekdaysShort")}function Td(n,r,a){return ks(n,r,a,"weekdaysMin")}Pe("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var r=n%10,a=b(n%100/10)===1?"th":r===1?"st":r===2?"nd":r===3?"rd":"th";return n+a}}),t.lang=se("moment.lang is deprecated. Use moment.locale instead.",Pe),t.langData=se("moment.langData is deprecated. Use moment.localeData instead.",Ee);var Ie=Math.abs;function Ed(){var n=this._data;return this._milliseconds=Ie(this._milliseconds),this._days=Ie(this._days),this._months=Ie(this._months),n.milliseconds=Ie(n.milliseconds),n.seconds=Ie(n.seconds),n.minutes=Ie(n.minutes),n.hours=Ie(n.hours),n.months=Ie(n.months),n.years=Ie(n.years),this}function jr(n,r,a,l){var h=he(r,a);return n._milliseconds+=l*h._milliseconds,n._days+=l*h._days,n._months+=l*h._months,n._bubble()}function Id(n,r){return jr(this,n,r,1)}function kd(n,r){return jr(this,n,r,-1)}function $r(n){return n<0?Math.floor(n):Math.ceil(n)}function Md(){var n=this._milliseconds,r=this._days,a=this._months,l=this._data,h,f,p,T,k;return n>=0&&r>=0&&a>=0||n<=0&&r<=0&&a<=0||(n+=$r(Ms(a)+r)*864e5,r=0,a=0),l.milliseconds=n%1e3,h=re(n/1e3),l.seconds=h%60,f=re(h/60),l.minutes=f%60,p=re(f/60),l.hours=p%24,r+=re(p/24),k=re(zr(r)),a+=k,r-=$r(Ms(k)),T=re(a/12),a%=12,l.days=r,l.months=a,l.years=T,this}function zr(n){return n*4800/146097}function Ms(n){return n*146097/4800}function bd(n){if(!this.isValid())return NaN;var r,a,l=this._milliseconds;if(n=ie(n),n==="month"||n==="quarter"||n==="year")switch(r=this._days+l/864e5,a=this._months+zr(r),n){case"month":return a;case"quarter":return a/3;case"year":return a/12}else switch(r=this._days+Math.round(Ms(this._months)),n){case"week":return r/7+l/6048e5;case"day":return r+l/864e5;case"hour":return r*24+l/36e5;case"minute":return r*1440+l/6e4;case"second":return r*86400+l/1e3;case"millisecond":return Math.floor(r*864e5)+l;default:throw new Error("Unknown unit "+n)}}function ke(n){return function(){return this.as(n)}}var qr=ke("ms"),Dd=ke("s"),Nd=ke("m"),Rd=ke("h"),Pd=ke("d"),Ad=ke("w"),Od=ke("M"),xd=ke("Q"),Fd=ke("y"),Ld=qr;function Yd(){return he(this)}function Wd(n){return n=ie(n),this.isValid()?this[n+"s"]():NaN}function He(n){return function(){return this.isValid()?this._data[n]:NaN}}var Ud=He("milliseconds"),Hd=He("seconds"),Vd=He("minutes"),Gd=He("hours"),Bd=He("days"),jd=He("months"),$d=He("years");function zd(){return re(this.days()/7)}var Me=Math.round,it={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function qd(n,r,a,l,h){return h.relativeTime(r||1,!!a,n,l)}function Kd(n,r,a,l){var h=he(n).abs(),f=Me(h.as("s")),p=Me(h.as("m")),T=Me(h.as("h")),k=Me(h.as("d")),D=Me(h.as("M")),J=Me(h.as("w")),be=Me(h.as("y")),Oe=f<=a.ss&&["s",f]||f<a.s&&["ss",f]||p<=1&&["m"]||p<a.m&&["mm",p]||T<=1&&["h"]||T<a.h&&["hh",T]||k<=1&&["d"]||k<a.d&&["dd",k];return a.w!=null&&(Oe=Oe||J<=1&&["w"]||J<a.w&&["ww",J]),Oe=Oe||D<=1&&["M"]||D<a.M&&["MM",D]||be<=1&&["y"]||["yy",be],Oe[2]=r,Oe[3]=+n>0,Oe[4]=l,qd.apply(null,Oe)}function Qd(n){return n===void 0?Me:typeof n=="function"?(Me=n,!0):!1}function Zd(n,r){return it[n]===void 0?!1:r===void 0?it[n]:(it[n]=r,n==="s"&&(it.ss=r-1),!0)}function Xd(n,r){if(!this.isValid())return this.localeData().invalidDate();var a=!1,l=it,h,f;return typeof n=="object"&&(r=n,n=!1),typeof n=="boolean"&&(a=n),typeof r=="object"&&(l=Object.assign({},it,r),r.s!=null&&r.ss==null&&(l.ss=r.s-1)),h=this.localeData(),f=Kd(this,!a,l,h),a&&(f=h.pastFuture(+this,f)),h.postformat(f)}var bs=Math.abs;function rt(n){return(n>0)-(n<0)||+n}function Mn(){if(!this.isValid())return this.localeData().invalidDate();var n=bs(this._milliseconds)/1e3,r=bs(this._days),a=bs(this._months),l,h,f,p,T=this.asSeconds(),k,D,J,be;return T?(l=re(n/60),h=re(l/60),n%=60,l%=60,f=re(a/12),a%=12,p=n?n.toFixed(3).replace(/\.?0+$/,""):"",k=T<0?"-":"",D=rt(this._months)!==rt(T)?"-":"",J=rt(this._days)!==rt(T)?"-":"",be=rt(this._milliseconds)!==rt(T)?"-":"",k+"P"+(f?D+f+"Y":"")+(a?D+a+"M":"")+(r?J+r+"D":"")+(h||l||n?"T":"")+(h?be+h+"H":"")+(l?be+l+"M":"")+(n?be+p+"S":"")):"P0D"}var R=wn.prototype;R.isValid=ju,R.abs=Ed,R.add=Id,R.subtract=kd,R.as=bd,R.asMilliseconds=qr,R.asSeconds=Dd,R.asMinutes=Nd,R.asHours=Rd,R.asDays=Pd,R.asWeeks=Ad,R.asMonths=Od,R.asQuarters=xd,R.asYears=Fd,R.valueOf=Ld,R._bubble=Md,R.clone=Yd,R.get=Wd,R.milliseconds=Ud,R.seconds=Hd,R.minutes=Vd,R.hours=Gd,R.days=Bd,R.weeks=zd,R.months=jd,R.years=$d,R.humanize=Xd,R.toISOString=Mn,R.toString=Mn,R.toJSON=Mn,R.locale=Or,R.localeData=Fr,R.toIsoString=se("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Mn),R.lang=xr,I("X",0,0,"unix"),I("x",0,0,"valueOf"),E("x",fn),E("X",vc),x("X",function(n,r,a){a._d=new Date(parseFloat(n)*1e3)}),x("x",function(n,r,a){a._d=new Date(b(n))});return t.version="2.30.1",e(W),t.fn=v,t.min=Hu,t.max=Vu,t.now=Gu,t.utc=w,t.unix=gd,t.months=vd,t.isDate=m,t.locale=Pe,t.invalid=Re,t.duration=he,t.isMoment=ce,t.weekdays=Cd,t.parseZone=yd,t.localeData=Ee,t.isDuration=Cn,t.monthsShort=wd,t.weekdaysMin=Td,t.defineLocale=ms,t.updateLocale=yu,t.locales=vu,t.weekdaysShort=Sd,t.normalizeUnits=ie,t.relativeTimeRounding=Qd,t.relativeTimeThreshold=Zd,t.calendarFormat=_h,t.prototype=v,t.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},t})});var sa=[{path:"",pathMatch:"full",redirectTo:""},{path:"",loadComponent:()=>import("./chunk-GSTRPPHF.js").then(s=>s.ProtectedRouteComponent),children:[{path:"pets",loadComponent:()=>import("./chunk-G2VC5L3V.js").then(s=>s.PetListRouteComponent)},{path:"pets/add",loadComponent:()=>import("./chunk-GWXLROVF.js").then(s=>s.PetAddRouteComponent)},{path:"mood",loadComponent:()=>import("./chunk-WMYIK7EU.js").then(s=>s.MoodListRouteComponent)},{path:"mood/add",loadComponent:()=>import("./chunk-UNRNEVTW.js").then(s=>s.MoodAddRouteComponent)}]}];var ef="@",tf=(()=>{class s{constructor(e,i,o,c,u){this.doc=e,this.delegate=i,this.zone=o,this.animationType=c,this.moduleImpl=u,this._rendererFactoryPromise=null,this.scheduler=Yt(no,{optional:!0}),this.loadingSchedulerFn=Yt(nf,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){let e=()=>this.moduleImpl??import("./chunk-DFMMP6LF.js").then(o=>o),i;return this.loadingSchedulerFn?i=this.loadingSchedulerFn(e):i=e(),i.catch(o=>{throw new Zr(5300,!1)}).then(({\u0275createEngine:o,\u0275AnimationRendererFactory:c})=>{this._engine=o(this.animationType,this.doc);let u=new c(this.delegate,this._engine,this.zone);return this.delegate=u,u})}createRenderer(e,i){let o=this.delegate.createRenderer(e,i);if(o.\u0275type===0)return o;typeof o.throwOnSyntheticProps=="boolean"&&(o.throwOnSyntheticProps=!1);let c=new Ys(o);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(u=>{let d=u.createRenderer(e,i);c.use(d),this.scheduler?.notify(10)}).catch(u=>{c.use(o)}),c}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(i){to()}}static{this.\u0275prov=Lt({token:s,factory:s.\u0275fac})}}return s})(),Ys=class{constructor(t){this.delegate=t,this.replay=[],this.\u0275type=1}use(t){if(this.delegate=t,this.replay!==null){for(let e of this.replay)e(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,e){this.delegate.appendChild(t,e)}insertBefore(t,e,i,o){this.delegate.insertBefore(t,e,i,o)}removeChild(t,e,i){this.delegate.removeChild(t,e,i)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,o){this.delegate.setAttribute(t,e,i,o)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,o){this.delegate.setStyle(t,e,i,o)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){this.shouldReplay(e)&&this.replay.push(o=>o.setProperty(t,e,i)),this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.shouldReplay(e)&&this.replay.push(o=>o.listen(t,e,i)),this.delegate.listen(t,e,i)}shouldReplay(t){return this.replay!==null&&t.startsWith(ef)}},nf=new at("");function ia(s="animations"){return io("NgAsyncAnimations"),Rn([{provide:so,useFactory:(t,e,i)=>new tf(t,e,i,s),deps:[lo,co,Pn]},{provide:eo,useValue:s==="noop"?"NoopAnimations":"BrowserAnimations"}])}var ra="@firebase/database",oa="1.0.8";var Fi="";function sf(s){Fi=s}var $s=class{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){e==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),$(e))}get(t){let e=this.domStorage_.getItem(this.prefixedName_(t));return e==null?null:On(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}};var zs=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){e==null?delete this.cache_[t]:this.cache_[t]=e}get(t){return ve(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}};var Ya=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){let t=window[s];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new $s(t)}}catch{}return new zs},Be=Ya("localStorage"),qs=Ya("sessionStorage");var _t=new bo("@firebase/database"),rf=function(){let s=1;return function(){return s++}}(),Wa=function(s){let t=Io(s),e=new To;e.update(t);let i=e.digest();return _o.encodeByteArray(i)},tn=function(...s){let t="";for(let e=0;e<s.length;e++){let i=s[e];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?t+=tn.apply(null,i):typeof i=="object"?t+=$(i):t+=i,t+=" "}return t},je=null,aa=!0,of=function(s,t){S(!t||s===!0||s===!1,"Can't turn on custom loggers persistently."),s===!0?(_t.logLevel=Mo.VERBOSE,je=_t.log.bind(_t),t&&qs.set("logging_enabled",!0)):typeof s=="function"?je=s:(je=null,qs.remove("logging_enabled"))},Q=function(...s){if(aa===!0&&(aa=!1,je===null&&qs.get("logging_enabled")===!0&&of(!0)),je){let t=tn.apply(null,s);je(t)}},nn=function(s){return function(...t){Q(s,...t)}},Ks=function(...s){let t="FIREBASE INTERNAL ERROR: "+tn(...s);_t.error(t)},Ne=function(...s){let t=`FIREBASE FATAL ERROR: ${tn(...s)}`;throw _t.error(t),new Error(t)},ne=function(...s){let t="FIREBASE WARNING: "+tn(...s);_t.warn(t)},af=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ne("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ua=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},lf=function(s){if(ye()||document.readyState==="complete")s();else{let t=!1,e=function(){if(!document.body){setTimeout(e,Math.floor(10));return}t||(t=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&e()}),window.attachEvent("onload",e))}},pt="[MIN_NAME]",$e="[MAX_NAME]",Tt=function(s,t){if(s===t)return 0;if(s===pt||t===$e)return-1;if(t===pt||s===$e)return 1;{let e=la(s),i=la(t);return e!==null?i!==null?e-i===0?s.length-t.length:e-i:-1:i!==null?1:s<t?-1:1}},cf=function(s,t){return s===t?0:s<t?-1:1},Gt=function(s,t){if(t&&s in t)return t[s];throw new Error("Missing required key ("+s+") in object: "+$(t))},Li=function(s){if(typeof s!="object"||s===null)return $(s);let t=[];for(let i in s)t.push(i);t.sort();let e="{";for(let i=0;i<t.length;i++)i!==0&&(e+=","),e+=$(t[i]),e+=":",e+=Li(s[t[i]]);return e+="}",e},Ha=function(s,t){let e=s.length;if(e<=t)return[s];let i=[];for(let o=0;o<e;o+=t)o+t>e?i.push(s.substring(o,e)):i.push(s.substring(o,o+t));return i};function le(s,t){for(let e in s)s.hasOwnProperty(e)&&t(e,s[e])}var Va=function(s){S(!Ua(s),"Invalid JSON number");let t=11,e=52,i=(1<<t-1)-1,o,c,u,d,_;s===0?(c=0,u=0,o=1/s===-1/0?1:0):(o=s<0,s=Math.abs(s),s>=Math.pow(2,1-i)?(d=Math.min(Math.floor(Math.log(s)/Math.LN2),i),c=d+i,u=Math.round(s*Math.pow(2,e-d)-Math.pow(2,e))):(c=0,u=Math.round(s/Math.pow(2,1-i-e))));let m=[];for(_=e;_;_-=1)m.push(u%2?1:0),u=Math.floor(u/2);for(_=t;_;_-=1)m.push(c%2?1:0),c=Math.floor(c/2);m.push(o?1:0),m.reverse();let y=m.join(""),g="";for(_=0;_<64;_+=8){let w=parseInt(y.substr(_,8),2).toString(16);w.length===1&&(w="0"+w),g=g+w}return g.toLowerCase()},uf=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},hf=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var df=new RegExp("^-?(0*)\\d{1,10}$"),ff=-2147483648,_f=2147483647,la=function(s){if(df.test(s)){let t=Number(s);if(t>=ff&&t<=_f)return t}return null},sn=function(s){try{s()}catch(t){setTimeout(()=>{let e=t.stack||"";throw ne("Exception was thrown by user callback.",e),t},Math.floor(0))}},mf=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qt=function(s,t){let e=setTimeout(s,t);return typeof e=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):typeof e=="object"&&e.unref&&e.unref(),e};var Qs=class{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=e?.getImmediate({optional:!0}),this.appCheck||e?.get().then(i=>this.appCheck=i)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((e,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){var e;(e=this.appCheckProvider)===null||e===void 0||e.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){ne(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Zs=class{constructor(t,e,i){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(o=>this.auth_=o)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(e=>e&&e.code==="auth/token-not-initialized"?(Q("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ne(t)}},Kt=(()=>{class s{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}s.OWNER="owner";return s})(),Ln="5",Ga="v",Ba="s",ja="r",$a="f",za=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,qa="ls",Ka="p",Xs="ac",Qa="websocket",Za="long_polling";var Yn=class{constructor(t,e,i,o,c=!1,u="",d=!1,_=!1){this.secure=e,this.namespace=i,this.webSocketOnly=o,this.nodeAdmin=c,this.persistenceKey=u,this.includeNamespaceInQueryParams=d,this.isUsingEmulator=_,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Be.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Be.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){let t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${e}`}};function pf(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function Xa(s,t,e){S(typeof t=="string","typeof type must == string"),S(typeof e=="object","typeof params must == object");let i;if(t===Qa)i=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(t===Za)i=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);pf(s)&&(e.ns=s.namespace);let o=[];return le(e,(c,u)=>{o.push(c+"="+u)}),i+o.join("&")}var Js=class{constructor(){this.counters_={}}incrementCounter(t,e=1){ve(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return po(this.counters_)}};var Ws={},Us={};function Yi(s){let t=s.toString();return Ws[t]||(Ws[t]=new Js),Ws[t]}function gf(s,t){let e=s.toString();return Us[e]||(Us[e]=t()),Us[e]}var ei=class{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let o=0;o<i.length;++o)i[o]&&sn(()=>{this.onMessage_(i[o])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var ca="start",yf="close",vf="pLPCommand",wf="pRTLPCB",Ja="id",el="pw",tl="ser",Cf="cb",Sf="seg",Tf="ts",Ef="d",If="dframe",nl=1870,sl=30,kf=nl-sl,Mf=25e3,bf=3e4,ti=class s{constructor(t,e,i,o,c,u,d){this.connId=t,this.repoInfo=e,this.applicationId=i,this.appCheckToken=o,this.authToken=c,this.transportSessionId=u,this.lastSessionId=d,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=nn(t),this.stats_=Yi(e),this.urlFn=_=>(this.appCheckToken&&(_[Xs]=this.appCheckToken),Xa(e,Za,_))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new ei(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(bf)),lf(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ni((...c)=>{let[u,d,_,m,y]=c;if(this.incrementIncomingBytes_(c),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,u===ca)this.id=d,this.password=_;else if(u===yf)d?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(d,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+u)},(...c)=>{let[u,d]=c;this.incrementIncomingBytes_(c),this.myPacketOrderer.handleResponse(u,d)},()=>{this.onClosed_()},this.urlFn);let i={};i[ca]="t",i[tl]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Cf]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Ga]=Ln,this.transportSessionId&&(i[Ba]=this.transportSessionId),this.lastSessionId&&(i[qa]=this.lastSessionId),this.applicationId&&(i[Ka]=this.applicationId),this.appCheckToken&&(i[Xs]=this.appCheckToken),typeof location<"u"&&location.hostname&&za.test(location.hostname)&&(i[ja]=$a);let o=this.urlFn(i);this.log_("Connecting via long-poll to "+o),this.scriptTagHolder.addTag(o,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){s.forceAllow_=!0}static forceDisallow(){s.forceDisallow_=!0}static isAvailable(){return ye()?!1:s.forceAllow_?!0:!s.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!uf()&&!hf()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){let e=$(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);let i=mo(e),o=Ha(i,kf);for(let c=0;c<o.length;c++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,o.length,o[c]),this.curSegmentNum++}addDisconnectPingFrame(t,e){if(ye())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[If]="t",i[Ja]=t,i[el]=e,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){let e=$(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}},ni=class s{constructor(t,e,i,o){if(this.onDisconnect=i,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ye())this.commandCB=t,this.onMessageCB=e;else{this.uniqueCallbackIdentifier=rf(),window[vf+this.uniqueCallbackIdentifier]=t,window[wf+this.uniqueCallbackIdentifier]=e,this.myIFrame=s.createIFrame_();let c="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(c='<script>document.domain="'+document.domain+'";<\/script>');let u="<html><body>"+c+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(u),this.myIFrame.doc.close()}catch(d){Q("frame writing exception"),d.stack&&Q(d.stack),Q(d)}}}static createIFrame_(){let t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Q("No IE domain setting required")}catch{let i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let t={};t[Ja]=this.myID,t[el]=this.myPW,t[tl]=this.currentSerial;let e=this.urlFn(t),i="",o=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+sl+i.length<=nl;){let u=this.pendingSegs.shift();i=i+"&"+Sf+o+"="+u.seg+"&"+Tf+o+"="+u.ts+"&"+Ef+o+"="+u.d,o++}return e=e+i,this.addLongPollTag_(e,this.currentSerial),!0}else return!1}enqueueSegment(t,e,i){this.pendingSegs.push({seg:t,ts:e,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);let i=()=>{this.outstandingRequests.delete(e),this.newRequest_()},o=setTimeout(i,Math.floor(Mf)),c=()=>{clearTimeout(o),i()};this.addTag(t,c)}addTag(t,e){ye()?this.doNodeLongPoll(t,e):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){let o=i.readyState;(!o||o==="loaded"||o==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=()=>{Q("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var Df=16384,Nf=45e3,Wn=null;typeof MozWebSocket<"u"?Wn=MozWebSocket:typeof WebSocket<"u"&&(Wn=WebSocket);var Bt=(()=>{class s{constructor(e,i,o,c,u,d,_){this.connId=e,this.applicationId=o,this.appCheckToken=c,this.authToken=u,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=nn(this.connId),this.stats_=Yi(i),this.connURL=s.connectionURL_(i,d,_,c,o),this.nodeAdmin=i.nodeAdmin}static connectionURL_(e,i,o,c,u){let d={};return d[Ga]=Ln,!ye()&&typeof location<"u"&&location.hostname&&za.test(location.hostname)&&(d[ja]=$a),i&&(d[Ba]=i),o&&(d[qa]=o),c&&(d[Xs]=c),u&&(d[Ka]=u),Xa(e,Qa,d)}open(e,i){this.onDisconnect=i,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Be.set("previous_websocket_failure",!0);try{let o;if(ye()){let c=this.nodeAdmin?"AdminNode":"Node";o={headers:{"User-Agent":`Firebase/${Ln}/${Fi}/${process.platform}/${c}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(o.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(o.headers["X-Firebase-AppCheck"]=this.appCheckToken);let u=process.env,d=this.connURL.indexOf("wss://")===0?u.HTTPS_PROXY||u.https_proxy:u.HTTP_PROXY||u.http_proxy;d&&(o.proxy={origin:d})}this.mySock=new Wn(this.connURL,[],o)}catch(o){this.log_("Error instantiating WebSocket.");let c=o.message||o.data;c&&this.log_(c),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");let c=o.message||o.data;c&&this.log_(c),this.onClosed_()}}start(){}static forceDisallow(){s.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,o=navigator.userAgent.match(i);o&&o.length>1&&parseFloat(o[1])<4.4&&(e=!0)}return!e&&Wn!==null&&!s.forceDisallow_}static previouslyFailed(){return Be.isInMemoryStorage||Be.get("previous_websocket_failure")===!0}markConnectionHealthy(){Be.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let o=On(i);this.onMessage(o)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(S(this.frames===null,"We already have a frame buffer"),e.length<=6){let i=Number(e);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;let i=e.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let o=this.extractFrameCount_(i);o!==null&&this.appendFrame_(o)}}send(e){this.resetKeepAlive();let i=$(e);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let o=Ha(i,Df);o.length>1&&this.sendString_(String(o.length));for(let c=0;c<o.length;c++)this.sendString_(o[c])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Nf))}sendString_(e){try{this.mySock.send(e)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}s.responsesRequiredToBeHealthy=2,s.healthyTimeout=3e4;return s})(),Rf=(()=>{class s{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[ti,Bt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){let i=Bt&&Bt.isAvailable(),o=i&&!Bt.previouslyFailed();if(e.webSocketOnly&&(i||ne("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[Bt];else{let c=this.transports_=[];for(let u of s.ALL_TRANSPORTS)u&&u.isAvailable()&&c.push(u);s.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}s.globalTransportInitialized_=!1;return s})(),Pf=6e4,Af=5e3,Of=10*1024,xf=100*1024,Hs="t",ua="d",Ff="s",ha="r",Lf="e",da="o",fa="a",_a="n",ma="p",Yf="h",si=class{constructor(t,e,i,o,c,u,d,_,m,y){this.id=t,this.repoInfo_=e,this.applicationId_=i,this.appCheckToken_=o,this.authToken_=c,this.onMessage_=u,this.onReady_=d,this.onDisconnect_=_,this.onKill_=m,this.lastSessionId=y,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=nn("c:"+this.id+":"),this.transportManager_=new Rf(e),this.log_("Connection created"),this.start_()}start_(){let t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;let e=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,i)},Math.floor(0));let o=t.healthyTimeout||0;o>0&&(this.healthyTimeout_=qt(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>xf?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Of?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(o)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){let e={t:"d",d:t};this.sendData_(e)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(Hs in t){let e=t[Hs];e===fa?this.upgradeIfSecondaryHealthy_():e===ha?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):e===da&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){let e=Gt("t",t),i=Gt("d",t);if(e==="c")this.onSecondaryControl_(i);else if(e==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+e)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:ma,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:fa,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:_a,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){let e=Gt("t",t),i=Gt("d",t);e==="c"?this.onControl_(i):e==="d"&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){let e=Gt(Hs,t);if(ua in t){let i=t[ua];if(e===Yf){let o=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(o.h=this.repoInfo_.host),this.onHandshake_(o)}else if(e===_a){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let o=0;o<this.pendingDataMessages.length;++o)this.onDataMessage_(this.pendingDataMessages[o]);this.pendingDataMessages=[],this.tryCleanupConnection()}else e===Ff?this.onConnectionShutdown_(i):e===ha?this.onReset_(i):e===Lf?Ks("Server Error: "+i):e===da?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ks("Unknown control packet command: "+e)}}onHandshake_(t){let e=t.ts,i=t.v,o=t.h;this.sessionId=t.s,this.repoInfo_.host=o,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),Ln!==i&&ne("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;let e=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,i),qt(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Pf))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qt(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Af))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:ma,d:{}}}))}onSecondaryConnectionLost_(){let t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Be.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Un=class{put(t,e,i,o){}merge(t,e,i,o){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,i){}onDisconnectMerge(t,e,i){}onDisconnectCancel(t,e){}reportStats(t){}};var Hn=class{constructor(t){this.allowedEvents_=t,this.listeners_={},S(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){let i=[...this.listeners_[t]];for(let o=0;o<i.length;o++)i[o].callback.apply(i[o].context,e)}}on(t,e,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:i});let o=this.getInitialEvent(t);o&&e.apply(i,o)}off(t,e,i){this.validateEventType_(t);let o=this.listeners_[t]||[];for(let c=0;c<o.length;c++)if(o[c].callback===e&&(!i||i===o[c].context)){o.splice(c,1);return}}validateEventType_(t){S(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}};var Vn=class s extends Hn{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Rs()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new s}getInitialEvent(t){return S(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}};var pa=32,ga=768,L=class{constructor(t,e){if(e===void 0){this.pieces_=t.split("/");let i=0;for(let o=0;o<this.pieces_.length;o++)this.pieces_[o].length>0&&(this.pieces_[i]=this.pieces_[o],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)this.pieces_[e]!==""&&(t+="/"+this.pieces_[e]);return t||"/"}};function F(){return new L("")}function P(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function Fe(s){return s.pieces_.length-s.pieceNum_}function U(s){let t=s.pieceNum_;return t<s.pieces_.length&&t++,new L(s.pieces_,t)}function il(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function Wf(s){let t="";for(let e=s.pieceNum_;e<s.pieces_.length;e++)s.pieces_[e]!==""&&(t+="/"+encodeURIComponent(String(s.pieces_[e])));return t||"/"}function rl(s,t=0){return s.pieces_.slice(s.pieceNum_+t)}function ol(s){if(s.pieceNum_>=s.pieces_.length)return null;let t=[];for(let e=s.pieceNum_;e<s.pieces_.length-1;e++)t.push(s.pieces_[e]);return new L(t,0)}function z(s,t){let e=[];for(let i=s.pieceNum_;i<s.pieces_.length;i++)e.push(s.pieces_[i]);if(t instanceof L)for(let i=t.pieceNum_;i<t.pieces_.length;i++)e.push(t.pieces_[i]);else{let i=t.split("/");for(let o=0;o<i.length;o++)i[o].length>0&&e.push(i[o])}return new L(e,0)}function N(s){return s.pieceNum_>=s.pieces_.length}function oe(s,t){let e=P(s),i=P(t);if(e===null)return t;if(e===i)return oe(U(s),U(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+s+")")}function al(s,t){if(Fe(s)!==Fe(t))return!1;for(let e=s.pieceNum_,i=t.pieceNum_;e<=s.pieces_.length;e++,i++)if(s.pieces_[e]!==t.pieces_[i])return!1;return!0}function fe(s,t){let e=s.pieceNum_,i=t.pieceNum_;if(Fe(s)>Fe(t))return!1;for(;e<s.pieces_.length;){if(s.pieces_[e]!==t.pieces_[i])return!1;++e,++i}return!0}var ii=class{constructor(t,e){this.errorPrefix_=e,this.parts_=rl(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Ht(this.parts_[i]);ll(this)}};function Uf(s,t){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(t),s.byteLength_+=Ht(t),ll(s)}function Hf(s){let t=s.parts_.pop();s.byteLength_-=Ht(t),s.parts_.length>0&&(s.byteLength_-=1)}function ll(s){if(s.byteLength_>ga)throw new Error(s.errorPrefix_+"has a key path longer than "+ga+" bytes ("+s.byteLength_+").");if(s.parts_.length>pa)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+pa+") or object contains a cycle "+Ge(s))}function Ge(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}var ri=class s extends Hn{constructor(){super(["visible"]);let t,e;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{let i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new s}getInitialEvent(t){return S(t==="visible","Unknown event type: "+t),[this.visible_]}};var jt=1e3,Vf=60*5*1e3,ya=30*1e3,Gf=1.3,Bf=3e4,jf="server_kill",va=3,Wi=(()=>{class s extends Un{constructor(e,i,o,c,u,d,_,m){if(super(),this.repoInfo_=e,this.applicationId_=i,this.onDataUpdate_=o,this.onConnectStatus_=c,this.onServerInfoUpdate_=u,this.authTokenProvider_=d,this.appCheckTokenProvider_=_,this.authOverride_=m,this.id=s.nextPersistentConnectionId_++,this.log_=nn("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=jt,this.maxReconnectDelay_=Vf,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,m&&!ye())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ri.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Vn.getInstance().on("online",this.onOnline_,this)}sendRequest(e,i,o){let c=++this.requestNumber_,u={r:c,a:e,b:i};this.log_($(u)),S(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(u),o&&(this.requestCBHash_[c]=o)}get(e){this.initConnection_();let i=new Ns,c={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:d=>{let _=d.d;d.s==="ok"?i.resolve(_):i.reject(_)}};this.outstandingGets_.push(c),this.outstandingGetCount_++;let u=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(u),i.promise}listen(e,i,o,c){this.initConnection_();let u=e._queryIdentifier,d=e._path.toString();this.log_("Listen called for "+d+" "+u),this.listens.has(d)||this.listens.set(d,new Map),S(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),S(!this.listens.get(d).has(u),"listen() called twice for same path/queryId.");let _={onComplete:c,hashFn:i,query:e,tag:o};this.listens.get(d).set(u,_),this.connected_&&this.sendListen_(_)}sendGet_(e){let i=this.outstandingGets_[e];this.sendRequest("g",i.request,o=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(o)})}sendListen_(e){let i=e.query,o=i._path.toString(),c=i._queryIdentifier;this.log_("Listen on "+o+" for "+c);let u={p:o},d="q";e.tag&&(u.q=i._queryObject,u.t=e.tag),u.h=e.hashFn(),this.sendRequest(d,u,_=>{let m=_.d,y=_.s;s.warnOnListenWarnings_(m,i),(this.listens.get(o)&&this.listens.get(o).get(c))===e&&(this.log_("listen response",_),y!=="ok"&&this.removeListen_(o,c),e.onComplete&&e.onComplete(y,m))})}static warnOnListenWarnings_(e,i){if(e&&typeof e=="object"&&ve(e,"w")){let o=Ve(e,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){let c='".indexOn": "'+i._queryParams.getIndex().toString()+'"',u=i._path.toString();ne(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${c} at ${u} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Co(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=ya)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let e=this.authToken_,i=wo(e)?"auth":"gauth",o={cred:e};this.authOverride_===null?o.noauth=!0:typeof this.authOverride_=="object"&&(o.authvar=this.authOverride_),this.sendRequest(i,o,c=>{let u=c.s,d=c.d||"error";this.authToken_===e&&(u==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(u,d))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{let i=e.s,o=e.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,o)})}unlisten(e,i){let o=e._path.toString(),c=e._queryIdentifier;this.log_("Unlisten called for "+o+" "+c),S(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,c)&&this.connected_&&this.sendUnlisten_(o,c,e._queryObject,i)}sendUnlisten_(e,i,o,c){this.log_("Unlisten on "+e+" for "+i);let u={p:e},d="n";c&&(u.q=o,u.t=c),this.sendRequest(d,u)}onDisconnectPut(e,i,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,i,o):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:i,onComplete:o})}onDisconnectMerge(e,i,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,i,o):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:i,onComplete:o})}onDisconnectCancel(e,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(e,i,o,c){let u={p:i,d:o};this.log_("onDisconnect "+e,u),this.sendRequest(e,u,d=>{c&&setTimeout(()=>{c(d.s,d.d)},Math.floor(0))})}put(e,i,o,c){this.putInternal("p",e,i,o,c)}merge(e,i,o,c){this.putInternal("m",e,i,o,c)}putInternal(e,i,o,c,u){this.initConnection_();let d={p:i,d:o};u!==void 0&&(d.h=u),this.outstandingPuts_.push({action:e,request:d,onComplete:c}),this.outstandingPutCount_++;let _=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(_):this.log_("Buffering put: "+i)}sendPut_(e){let i=this.outstandingPuts_[e].action,o=this.outstandingPuts_[e].request,c=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(i,o,u=>{this.log_(i+" response",u),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),c&&c(u.s,u.d)})}reportStats(e){if(this.connected_){let i={c:e};this.log_("reportStats",i),this.sendRequest("s",i,o=>{if(o.s!=="ok"){let u=o.d;this.log_("reportStats","Error sending stats: "+u)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+$(e));let i=e.r,o=this.requestCBHash_[i];o&&(delete this.requestCBHash_[i],o(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,i){this.log_("handleServerMessage",e,i),e==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):e==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):e==="c"?this.onListenRevoked_(i.p,i.q):e==="ac"?this.onAuthRevoked_(i.s,i.d):e==="apc"?this.onAppCheckRevoked_(i.s,i.d):e==="sd"?this.onSecurityDebugPacket_(i):Ks("Unrecognized action received from server: "+$(e)+`
Are you using the latest client?`)}onReady_(e,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){S(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=jt,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=jt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Bf&&(this.reconnectDelay_=jt),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let e=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-e);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Gf)}this.onConnectStatus_(!1)}establishConnection_(){return bn(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let e=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),o=this.onRealtimeDisconnect_.bind(this),c=this.id+":"+s.nextConnectionId_++,u=this.lastSessionId,d=!1,_=null,m=function(){_?_.close():(d=!0,o())},y=function(w){S(_,"sendRequest call when we're not connected not allowed."),_.sendRequest(w)};this.realtime_={close:m,sendRequest:y};let g=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[w,M]=yield Promise.all([this.authTokenProvider_.getToken(g),this.appCheckTokenProvider_.getToken(g)]);d?Q("getToken() completed but was canceled"):(Q("getToken() completed. Creating connection."),this.authToken_=w&&w.accessToken,this.appCheckToken_=M&&M.token,_=new si(c,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,i,o,C=>{ne(C+" ("+this.repoInfo_.toString()+")"),this.interrupt(jf)},u))}catch(w){this.log_("Failed to get token: "+w),d||(this.repoInfo_.nodeAdmin&&ne(w),m())}}})}interrupt(e){Q("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Q("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Ps(this.interruptReasons_)&&(this.reconnectDelay_=jt,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){let i=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){let i=this.outstandingPuts_[e];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,i){let o;i?o=i.map(u=>Li(u)).join("$"):o="default";let c=this.removeListen_(e,o);c&&c.onComplete&&c.onComplete("permission_denied")}removeListen_(e,i){let o=new L(e).toString(),c;if(this.listens.has(o)){let u=this.listens.get(o);c=u.get(i),u.delete(i),u.size===0&&this.listens.delete(o)}else c=void 0;return c}onAuthRevoked_(e,i){Q("Auth token revoked: "+e+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=va&&(this.reconnectDelay_=ya,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,i){Q("App check token revoked: "+e+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=va&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let e of this.listens.values())for(let i of e.values())this.sendListen_(i);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){let e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){let e={},i="js";ye()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),e["sdk."+i+"."+Fi.replace(/\./g,"-")]=1,Rs()?e["framework.cordova"]=1:vo()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){let e=Vn.getInstance().currentlyOnline();return Ps(this.interruptReasons_)&&e}}s.nextPersistentConnectionId_=0,s.nextConnectionId_=0;return s})(),A=class s{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new s(t,e)}};var gt=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){let i=new A(pt,t),o=new A(pt,e);return this.compare(i,o)!==0}minPost(){return A.MIN}};var Fn,Gn=class extends gt{static get __EMPTY_NODE(){return Fn}static set __EMPTY_NODE(t){Fn=t}compare(t,e){return Tt(t.name,e.name)}isDefinedOn(t){throw ct("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return A.MIN}maxPost(){return new A($e,Fn)}makePost(t,e){return S(typeof t=="string","KeyIndex indexValue must always be a string."),new A(t,Fn)}toString(){return".key"}},mt=new Gn;var dt=class{constructor(t,e,i,o,c=null){this.isReverse_=o,this.resultGenerator_=c,this.nodeStack_=[];let u=1;for(;!t.isEmpty();)if(t=t,u=e?i(t.key,e):1,o&&(u*=-1),u<0)this.isReverse_?t=t.left:t=t.right;else if(u===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),e;if(this.resultGenerator_?e=this.resultGenerator_(t.key,t.value):e={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}},de=(()=>{class s{constructor(e,i,o,c,u){this.key=e,this.value=i,this.color=o??s.RED,this.left=c??ae.EMPTY_NODE,this.right=u??ae.EMPTY_NODE}copy(e,i,o,c,u){return new s(e??this.key,i??this.value,o??this.color,c??this.left,u??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,i,o){let c=this,u=o(e,c.key);return u<0?c=c.copy(null,null,null,c.left.insert(e,i,o),null):u===0?c=c.copy(null,i,null,null,null):c=c.copy(null,null,null,null,c.right.insert(e,i,o)),c.fixUp_()}removeMin_(){if(this.left.isEmpty())return ae.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,i){let o,c;if(o=this,i(e,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(e,i),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),i(e,o.key)===0){if(o.right.isEmpty())return ae.EMPTY_NODE;c=o.right.min_(),o=o.copy(c.key,c.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(e,i))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){let e=this.copy(null,null,s.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){let e=this.copy(null,null,s.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){let e=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,i)}checkMaxDepth_(){let e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}return s.RED=!0,s.BLACK=!1,s})(),oi=class{copy(t,e,i,o,c){return this}insert(t,e,i){return new de(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},ae=class s{constructor(t,e=s.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new s(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,de.BLACK,null,null))}remove(t){return new s(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,de.BLACK,null,null))}get(t){let e,i=this.root_;for(;!i.isEmpty();){if(e=this.comparator_(t,i.key),e===0)return i.value;e<0?i=i.left:e>0&&(i=i.right)}return null}getPredecessorKey(t){let e,i=this.root_,o=null;for(;!i.isEmpty();)if(e=this.comparator_(t,i.key),e===0){if(i.left.isEmpty())return o?o.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else e<0?i=i.left:e>0&&(o=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new dt(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new dt(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new dt(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new dt(this.root_,null,this.comparator_,!0,t)}};ae.EMPTY_NODE=new oi;function $f(s,t){return Tt(s.name,t.name)}function Ui(s,t){return Tt(s,t)}var ai;function zf(s){ai=s}var cl=function(s){return typeof s=="number"?"number:"+Va(s):"string:"+s},ul=function(s){if(s.isLeafNode()){let t=s.val();S(typeof t=="string"||typeof t=="number"||typeof t=="object"&&ve(t,".sv"),"Priority must be a string or number.")}else S(s===ai||s.isEmpty(),"priority of unexpected type.");S(s===ai||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var wa,yt=(()=>{class s{constructor(e,i=s.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=i,this.lazyHash_=null,S(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),ul(this.priorityNode_)}static set __childrenNodeConstructor(e){wa=e}static get __childrenNodeConstructor(){return wa}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new s(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:s.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return N(e)?this:P(e)===".priority"?this.priorityNode_:s.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,i){return null}updateImmediateChild(e,i){return e===".priority"?this.updatePriority(i):i.isEmpty()&&e!==".priority"?this:s.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,i).updatePriority(this.priorityNode_)}updateChild(e,i){let o=P(e);return o===null?i:i.isEmpty()&&o!==".priority"?this:(S(o!==".priority"||Fe(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(o,s.__childrenNodeConstructor.EMPTY_NODE.updateChild(U(e),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,i){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+cl(this.priorityNode_.val())+":");let i=typeof this.value_;e+=i+":",i==="number"?e+=Va(this.value_):e+=this.value_,this.lazyHash_=Wa(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===s.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof s.__childrenNodeConstructor?-1:(S(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){let i=typeof e.value_,o=typeof this.value_,c=s.VALUE_TYPE_ORDER.indexOf(i),u=s.VALUE_TYPE_ORDER.indexOf(o);return S(c>=0,"Unknown leaf type: "+i),S(u>=0,"Unknown leaf type: "+o),c===u?o==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:u-c}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){let i=e;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}s.VALUE_TYPE_ORDER=["object","boolean","number","string"];return s})(),hl,dl;function qf(s){hl=s}function Kf(s){dl=s}var li=class extends gt{compare(t,e){let i=t.node.getPriority(),o=e.node.getPriority(),c=i.compareTo(o);return c===0?Tt(t.name,e.name):c}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return A.MIN}maxPost(){return new A($e,new yt("[PRIORITY-POST]",dl))}makePost(t,e){let i=hl(t);return new A(e,new yt("[PRIORITY-POST]",i))}toString(){return".priority"}},X=new li;var Qf=Math.log(2),ci=class{constructor(t){let e=c=>parseInt(Math.log(c)/Qf,10),i=c=>parseInt(Array(c+1).join("1"),2);this.count=e(t+1),this.current_=this.count-1;let o=i(this.count);this.bits_=t+1&o}nextBitIsOne(){let t=!(this.bits_&1<<this.current_);return this.current_--,t}},Bn=function(s,t,e,i){s.sort(t);let o=function(_,m){let y=m-_,g,w;if(y===0)return null;if(y===1)return g=s[_],w=e?e(g):g,new de(w,g.node,de.BLACK,null,null);{let M=parseInt(y/2,10)+_,C=o(_,M),B=o(M+1,m);return g=s[M],w=e?e(g):g,new de(w,g.node,de.BLACK,C,B)}},c=function(_){let m=null,y=null,g=s.length,w=function(C,B){let q=g-C,Re=g;g-=C;let Le=o(q+1,Re),Ye=s[q],kt=e?e(Ye):Ye;M(new de(kt,Ye.node,B,null,Le))},M=function(C){m?(m.left=C,m=C):(y=C,m=C)};for(let C=0;C<_.count;++C){let B=_.nextBitIsOne(),q=Math.pow(2,_.count-(C+1));B?w(q,de.BLACK):(w(q,de.BLACK),w(q,de.RED))}return y},u=new ci(s.length),d=c(u);return new ae(i||t,d)};var Vs,ht={},vt=class s{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return S(ht&&X,"ChildrenNode.ts has not been loaded"),Vs=Vs||new s({".priority":ht},{".priority":X}),Vs}get(t){let e=Ve(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof ae?e:null}hasIndex(t){return ve(this.indexSet_,t.toString())}addIndex(t,e){S(t!==mt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],o=!1,c=e.getIterator(A.Wrap),u=c.getNext();for(;u;)o=o||t.isDefinedOn(u.node),i.push(u),u=c.getNext();let d;o?d=Bn(i,t.getCompare()):d=ht;let _=t.toString(),m=Object.assign({},this.indexSet_);m[_]=t;let y=Object.assign({},this.indexes_);return y[_]=d,new s(y,m)}addToIndexes(t,e){let i=Ut(this.indexes_,(o,c)=>{let u=Ve(this.indexSet_,c);if(S(u,"Missing index implementation for "+c),o===ht)if(u.isDefinedOn(t.node)){let d=[],_=e.getIterator(A.Wrap),m=_.getNext();for(;m;)m.name!==t.name&&d.push(m),m=_.getNext();return d.push(t),Bn(d,u.getCompare())}else return ht;else{let d=e.get(t.name),_=o;return d&&(_=_.remove(new A(t.name,d))),_.insert(t,t.node)}});return new s(i,this.indexSet_)}removeFromIndexes(t,e){let i=Ut(this.indexes_,o=>{if(o===ht)return o;{let c=e.get(t.name);return c?o.remove(new A(t.name,c)):o}});return new s(i,this.indexSet_)}};var $t,V=(()=>{class s{constructor(e,i,o){this.children_=e,this.priorityNode_=i,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&ul(this.priorityNode_),this.children_.isEmpty()&&S(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return $t||($t=new s(new ae(Ui),null,vt.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||$t}updatePriority(e){return this.children_.isEmpty()?this:new s(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{let i=this.children_.get(e);return i===null?$t:i}}getChild(e){let i=P(e);return i===null?this:this.getImmediateChild(i).getChild(U(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,i){if(S(i,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(i);{let o=new A(e,i),c,u;i.isEmpty()?(c=this.children_.remove(e),u=this.indexMap_.removeFromIndexes(o,this.children_)):(c=this.children_.insert(e,i),u=this.indexMap_.addToIndexes(o,this.children_));let d=c.isEmpty()?$t:this.priorityNode_;return new s(c,d,u)}}updateChild(e,i){let o=P(e);if(o===null)return i;{S(P(e)!==".priority"||Fe(e)===1,".priority must be the last token in a path");let c=this.getImmediateChild(o).updateChild(U(e),i);return this.updateImmediateChild(o,c)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;let i={},o=0,c=0,u=!0;if(this.forEachChild(X,(d,_)=>{i[d]=_.val(e),o++,u&&s.INTEGER_REGEXP_.test(d)?c=Math.max(c,Number(d)):u=!1}),!e&&u&&c<2*o){let d=[];for(let _ in i)d[_]=i[_];return d}else return e&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+cl(this.getPriority().val())+":"),this.forEachChild(X,(i,o)=>{let c=o.hash();c!==""&&(e+=":"+i+":"+c)}),this.lazyHash_=e===""?"":Wa(e)}return this.lazyHash_}getPredecessorChildName(e,i,o){let c=this.resolveIndex_(o);if(c){let u=c.getPredecessorKey(new A(e,i));return u?u.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){let i=this.resolveIndex_(e);if(i){let o=i.minKey();return o&&o.name}else return this.children_.minKey()}getFirstChild(e){let i=this.getFirstChildName(e);return i?new A(i,this.children_.get(i)):null}getLastChildName(e){let i=this.resolveIndex_(e);if(i){let o=i.maxKey();return o&&o.name}else return this.children_.maxKey()}getLastChild(e){let i=this.getLastChildName(e);return i?new A(i,this.children_.get(i)):null}forEachChild(e,i){let o=this.resolveIndex_(e);return o?o.inorderTraversal(c=>i(c.name,c.node)):this.children_.inorderTraversal(i)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,i){let o=this.resolveIndex_(i);if(o)return o.getIteratorFrom(e,c=>c);{let c=this.children_.getIteratorFrom(e.name,A.Wrap),u=c.peek();for(;u!=null&&i.compare(u,e)<0;)c.getNext(),u=c.peek();return c}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,i){let o=this.resolveIndex_(i);if(o)return o.getReverseIteratorFrom(e,c=>c);{let c=this.children_.getReverseIteratorFrom(e.name,A.Wrap),u=c.peek();for(;u!=null&&i.compare(u,e)>0;)c.getNext(),u=c.peek();return c}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===rn?-1:0}withIndex(e){if(e===mt||this.indexMap_.hasIndex(e))return this;{let i=this.indexMap_.addIndex(e,this.children_);return new s(this.children_,this.priorityNode_,i)}}isIndexed(e){return e===mt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{let i=e;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let o=this.getIterator(X),c=i.getIterator(X),u=o.getNext(),d=c.getNext();for(;u&&d;){if(u.name!==d.name||!u.node.equals(d.node))return!1;u=o.getNext(),d=c.getNext()}return u===null&&d===null}else return!1;else return!1}}resolveIndex_(e){return e===mt?null:this.indexMap_.get(e.toString())}}return s.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,s})(),ui=class extends V{constructor(){super(new ae(Ui),V.EMPTY_NODE,vt.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return V.EMPTY_NODE}isEmpty(){return!1}},rn=new ui;Object.defineProperties(A,{MIN:{value:new A(pt,V.EMPTY_NODE)},MAX:{value:new A($e,rn)}});Gn.__EMPTY_NODE=V.EMPTY_NODE;yt.__childrenNodeConstructor=V;zf(rn);Kf(rn);var Zf=!0;function Z(s,t=null){if(s===null)return V.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(t=s[".priority"]),S(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){let e=s;return new yt(e,Z(t))}if(!(s instanceof Array)&&Zf){let e=[],i=!1;if(le(s,(u,d)=>{if(u.substring(0,1)!=="."){let _=Z(d);_.isEmpty()||(i=i||!_.getPriority().isEmpty(),e.push(new A(u,_)))}}),e.length===0)return V.EMPTY_NODE;let c=Bn(e,$f,u=>u.name,Ui);if(i){let u=Bn(e,X.getCompare());return new V(c,Z(t),new vt({".priority":u},{".priority":X}))}else return new V(c,Z(t),vt.Default)}else{let e=V.EMPTY_NODE;return le(s,(i,o)=>{if(ve(s,i)&&i.substring(0,1)!=="."){let c=Z(o);(c.isLeafNode()||!c.isEmpty())&&(e=e.updateImmediateChild(i,c))}}),e.updatePriority(Z(t))}}qf(Z);var hi=class extends gt{constructor(t){super(),this.indexPath_=t,S(!N(t)&&P(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){let i=this.extractChild(t.node),o=this.extractChild(e.node),c=i.compareTo(o);return c===0?Tt(t.name,e.name):c}makePost(t,e){let i=Z(t),o=V.EMPTY_NODE.updateChild(this.indexPath_,i);return new A(e,o)}maxPost(){let t=V.EMPTY_NODE.updateChild(this.indexPath_,rn);return new A($e,t)}toString(){return rl(this.indexPath_,0).join("/")}};var di=class extends gt{compare(t,e){let i=t.node.compareTo(e.node);return i===0?Tt(t.name,e.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return A.MIN}maxPost(){return A.MAX}makePost(t,e){let i=Z(t);return new A(e,i)}toString(){return".value"}},Xf=new di;function Jf(s){return{type:"value",snapshotNode:s}}function e_(s,t){return{type:"child_added",snapshotNode:t,childName:s}}function t_(s,t){return{type:"child_removed",snapshotNode:t,childName:s}}function Ca(s,t,e){return{type:"child_changed",snapshotNode:t,childName:s,oldSnap:e}}function n_(s,t){return{type:"child_moved",snapshotNode:t,childName:s}}var fi=class s{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=X}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return S(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return S(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:pt}hasEnd(){return this.endSet_}getIndexEndValue(){return S(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return S(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$e}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return S(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===X}copy(){let t=new s;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}};function Sa(s){let t={};if(s.isDefault())return t;let e;if(s.index_===X?e="$priority":s.index_===Xf?e="$value":s.index_===mt?e="$key":(S(s.index_ instanceof hi,"Unrecognized index type!"),e=s.index_.toString()),t.orderBy=$(e),s.startSet_){let i=s.startAfterSet_?"startAfter":"startAt";t[i]=$(s.indexStartValue_),s.startNameSet_&&(t[i]+=","+$(s.indexStartName_))}if(s.endSet_){let i=s.endBeforeSet_?"endBefore":"endAt";t[i]=$(s.indexEndValue_),s.endNameSet_&&(t[i]+=","+$(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?t.limitToFirst=s.limit_:t.limitToLast=s.limit_),t}function Ta(s){let t={};if(s.startSet_&&(t.sp=s.indexStartValue_,s.startNameSet_&&(t.sn=s.indexStartName_),t.sin=!s.startAfterSet_),s.endSet_&&(t.ep=s.indexEndValue_,s.endNameSet_&&(t.en=s.indexEndName_),t.ein=!s.endBeforeSet_),s.limitSet_){t.l=s.limit_;let e=s.viewFrom_;e===""&&(s.isViewFromLeft()?e="l":e="r"),t.vf=e}return s.index_!==X&&(t.i=s.index_.toString()),t}var _i=class s extends Un{constructor(t,e,i,o){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=i,this.appCheckTokenProvider_=o,this.log_=nn("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return e!==void 0?"tag$"+e:(S(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,i,o){let c=t._path.toString();this.log_("Listen called for "+c+" "+t._queryIdentifier);let u=s.getListenId_(t,i),d={};this.listens_[u]=d;let _=Sa(t._queryParams);this.restRequest_(c+".json",_,(m,y)=>{let g=y;if(m===404&&(g=null,m=null),m===null&&this.onDataUpdate_(c,g,!1,i),Ve(this.listens_,u)===d){let w;m?m===401?w="permission_denied":w="rest_error:"+m:w="ok",o(w,null)}})}unlisten(t,e){let i=s.getListenId_(t,e);delete this.listens_[i]}get(t){let e=Sa(t._queryParams),i=t._path.toString(),o=new Ns;return this.restRequest_(i+".json",e,(c,u)=>{let d=u;c===404&&(d=null,c=null),c===null?(this.onDataUpdate_(i,d,!1,null),o.resolve(d)):o.reject(new Error(d))}),o.promise}refreshAuthToken(t){}restRequest_(t,e={},i){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([o,c])=>{o&&o.accessToken&&(e.auth=o.accessToken),c&&c.token&&(e.ac=c.token);let u=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+So(e);this.log_("Sending REST request for "+u);let d=new XMLHttpRequest;d.onreadystatechange=()=>{if(i&&d.readyState===4){this.log_("REST Response for "+u+" received. status:",d.status,"response:",d.responseText);let _=null;if(d.status>=200&&d.status<300){try{_=On(d.responseText)}catch{ne("Failed to parse JSON response for "+u+": "+d.responseText)}i(null,_)}else d.status!==401&&d.status!==404&&ne("Got unsuccessful REST response for "+u+" Status: "+d.status),i(d.status);i=null}},d.open("GET",u,!0),d.send()})}};var mi=class{constructor(){this.rootNode_=V.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}};function jn(){return{value:null,children:new Map}}function fl(s,t,e){if(N(t))s.value=e,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(t,e);else{let i=P(t);s.children.has(i)||s.children.set(i,jn());let o=s.children.get(i);t=U(t),fl(o,t,e)}}function pi(s,t,e){s.value!==null?e(t,s.value):s_(s,(i,o)=>{let c=new L(t.toString()+"/"+i);pi(o,c,e)})}function s_(s,t){s.children.forEach((e,i)=>{t(i,e)})}var gi=class{constructor(t){this.collection_=t,this.last_=null}get(){let t=this.collection_.get(),e=Object.assign({},t);return this.last_&&le(this.last_,(i,o)=>{e[i]=e[i]-o}),this.last_=t,e}};var Ea=10*1e3,i_=30*1e3,r_=5*60*1e3,yi=class{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new gi(t);let i=Ea+(i_-Ea)*Math.random();qt(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let t=this.statsListener_.get(),e={},i=!1;le(t,(o,c)=>{c>0&&ve(this.statsToReport_,o)&&(e[o]=c,i=!0)}),i&&this.server_.reportStats(e),qt(this.reportStats_.bind(this),Math.floor(Math.random()*2*r_))}};var De=function(s){return s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",s}(De||{});function _l(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function ml(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function pl(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}var vi=class s{constructor(t,e,i){this.path=t,this.affectedTree=e,this.revert=i,this.type=De.ACK_USER_WRITE,this.source=_l()}operationForChild(t){if(N(this.path)){if(this.affectedTree.value!=null)return S(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let e=this.affectedTree.subtree(new L(t));return new s(F(),e,this.revert)}}else return S(P(this.path)===t,"operationForChild called for unrelated child."),new s(U(this.path),this.affectedTree,this.revert)}};var wt=class s{constructor(t,e,i){this.source=t,this.path=e,this.snap=i,this.type=De.OVERWRITE}operationForChild(t){return N(this.path)?new s(this.source,F(),this.snap.getImmediateChild(t)):new s(this.source,U(this.path),this.snap)}};var $n=class s{constructor(t,e,i){this.source=t,this.path=e,this.children=i,this.type=De.MERGE}operationForChild(t){if(N(this.path)){let e=this.children.subtree(new L(t));return e.isEmpty()?null:e.value?new wt(this.source,F(),e.value):new s(this.source,F(),e)}else return S(P(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new s(this.source,U(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Xt=class{constructor(t,e,i){this.node_=t,this.fullyInitialized_=e,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(N(t))return this.isFullyInitialized()&&!this.filtered_;let e=P(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}};function o_(s,t,e,i){let o=[],c=[];return t.forEach(u=>{u.type==="child_changed"&&s.index_.indexedValueChanged(u.oldSnap,u.snapshotNode)&&c.push(n_(u.childName,u.snapshotNode))}),zt(s,o,"child_removed",t,i,e),zt(s,o,"child_added",t,i,e),zt(s,o,"child_moved",c,i,e),zt(s,o,"child_changed",t,i,e),zt(s,o,"value",t,i,e),o}function zt(s,t,e,i,o,c){let u=i.filter(d=>d.type===e);u.sort((d,_)=>l_(s,d,_)),u.forEach(d=>{let _=a_(s,d,c);o.forEach(m=>{m.respondsTo(d.type)&&t.push(m.createEvent(_,s.query_))})})}function a_(s,t,e){return t.type==="value"||t.type==="child_removed"||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,s.index_)),t}function l_(s,t,e){if(t.childName==null||e.childName==null)throw ct("Should only compare child_ events.");let i=new A(t.childName,t.snapshotNode),o=new A(e.childName,e.snapshotNode);return s.index_.compare(i,o)}function gl(s,t){return{eventCache:s,serverCache:t}}function Qt(s,t,e,i){return gl(new Xt(t,e,i),s.serverCache)}function yl(s,t,e,i){return gl(s.eventCache,new Xt(t,e,i))}function wi(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function ze(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}var Gs,c_=()=>(Gs||(Gs=new ae(cf)),Gs),ee=class s{constructor(t,e=c_()){this.value=t,this.children=e}static fromObject(t){let e=new s(null);return le(t,(i,o)=>{e=e.set(new L(i),o)}),e}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(this.value!=null&&e(this.value))return{path:F(),value:this.value};if(N(t))return null;{let i=P(t),o=this.children.get(i);if(o!==null){let c=o.findRootMostMatchingPathAndValue(U(t),e);return c!=null?{path:z(new L(i),c.path),value:c.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(N(t))return this;{let e=P(t),i=this.children.get(e);return i!==null?i.subtree(U(t)):new s(null)}}set(t,e){if(N(t))return new s(e,this.children);{let i=P(t),c=(this.children.get(i)||new s(null)).set(U(t),e),u=this.children.insert(i,c);return new s(this.value,u)}}remove(t){if(N(t))return this.children.isEmpty()?new s(null):new s(null,this.children);{let e=P(t),i=this.children.get(e);if(i){let o=i.remove(U(t)),c;return o.isEmpty()?c=this.children.remove(e):c=this.children.insert(e,o),this.value===null&&c.isEmpty()?new s(null):new s(this.value,c)}else return this}}get(t){if(N(t))return this.value;{let e=P(t),i=this.children.get(e);return i?i.get(U(t)):null}}setTree(t,e){if(N(t))return e;{let i=P(t),c=(this.children.get(i)||new s(null)).setTree(U(t),e),u;return c.isEmpty()?u=this.children.remove(i):u=this.children.insert(i,c),new s(this.value,u)}}fold(t){return this.fold_(F(),t)}fold_(t,e){let i={};return this.children.inorderTraversal((o,c)=>{i[o]=c.fold_(z(t,o),e)}),e(t,this.value,i)}findOnPath(t,e){return this.findOnPath_(t,F(),e)}findOnPath_(t,e,i){let o=this.value?i(e,this.value):!1;if(o)return o;if(N(t))return null;{let c=P(t),u=this.children.get(c);return u?u.findOnPath_(U(t),z(e,c),i):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,F(),e)}foreachOnPath_(t,e,i){if(N(t))return this;{this.value&&i(e,this.value);let o=P(t),c=this.children.get(o);return c?c.foreachOnPath_(U(t),z(e,o),i):new s(null)}}foreach(t){this.foreach_(F(),t)}foreach_(t,e){this.children.inorderTraversal((i,o)=>{o.foreach_(z(t,i),e)}),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal((e,i)=>{i.value&&t(e,i.value)})}};var _e=class s{constructor(t){this.writeTree_=t}static empty(){return new s(new ee(null))}};function Zt(s,t,e){if(N(t))return new _e(new ee(e));{let i=s.writeTree_.findRootMostValueAndPath(t);if(i!=null){let o=i.path,c=i.value,u=oe(o,t);return c=c.updateChild(u,e),new _e(s.writeTree_.set(o,c))}else{let o=new ee(e),c=s.writeTree_.setTree(t,o);return new _e(c)}}}function Ia(s,t,e){let i=s;return le(e,(o,c)=>{i=Zt(i,z(t,o),c)}),i}function ka(s,t){if(N(t))return _e.empty();{let e=s.writeTree_.setTree(t,new ee(null));return new _e(e)}}function Ci(s,t){return qe(s,t)!=null}function qe(s,t){let e=s.writeTree_.findRootMostValueAndPath(t);return e!=null?s.writeTree_.get(e.path).getChild(oe(e.path,t)):null}function Ma(s){let t=[],e=s.writeTree_.value;return e!=null?e.isLeafNode()||e.forEachChild(X,(i,o)=>{t.push(new A(i,o))}):s.writeTree_.children.inorderTraversal((i,o)=>{o.value!=null&&t.push(new A(i,o.value))}),t}function xe(s,t){if(N(t))return s;{let e=qe(s,t);return e!=null?new _e(new ee(e)):new _e(s.writeTree_.subtree(t))}}function Si(s){return s.writeTree_.isEmpty()}function Ct(s,t){return vl(F(),s.writeTree_,t)}function vl(s,t,e){if(t.value!=null)return e.updateChild(s,t.value);{let i=null;return t.children.inorderTraversal((o,c)=>{o===".priority"?(S(c.value!==null,"Priority writes must always be leaf nodes"),i=c.value):e=vl(z(s,o),c,e)}),!e.getChild(s).isEmpty()&&i!==null&&(e=e.updateChild(z(s,".priority"),i)),e}}function wl(s,t){return Il(t,s)}function u_(s,t,e,i,o){S(i>s.lastWriteId,"Stacking an older write on top of newer ones"),o===void 0&&(o=!0),s.allWrites.push({path:t,snap:e,writeId:i,visible:o}),o&&(s.visibleWrites=Zt(s.visibleWrites,t,e)),s.lastWriteId=i}function h_(s,t){for(let e=0;e<s.allWrites.length;e++){let i=s.allWrites[e];if(i.writeId===t)return i}return null}function d_(s,t){let e=s.allWrites.findIndex(d=>d.writeId===t);S(e>=0,"removeWrite called with nonexistent writeId.");let i=s.allWrites[e];s.allWrites.splice(e,1);let o=i.visible,c=!1,u=s.allWrites.length-1;for(;o&&u>=0;){let d=s.allWrites[u];d.visible&&(u>=e&&f_(d,i.path)?o=!1:fe(i.path,d.path)&&(c=!0)),u--}if(o){if(c)return __(s),!0;if(i.snap)s.visibleWrites=ka(s.visibleWrites,i.path);else{let d=i.children;le(d,_=>{s.visibleWrites=ka(s.visibleWrites,z(i.path,_))})}return!0}else return!1}function f_(s,t){if(s.snap)return fe(s.path,t);for(let e in s.children)if(s.children.hasOwnProperty(e)&&fe(z(s.path,e),t))return!0;return!1}function __(s){s.visibleWrites=Cl(s.allWrites,m_,F()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function m_(s){return s.visible}function Cl(s,t,e){let i=_e.empty();for(let o=0;o<s.length;++o){let c=s[o];if(t(c)){let u=c.path,d;if(c.snap)fe(e,u)?(d=oe(e,u),i=Zt(i,d,c.snap)):fe(u,e)&&(d=oe(u,e),i=Zt(i,F(),c.snap.getChild(d)));else if(c.children){if(fe(e,u))d=oe(e,u),i=Ia(i,d,c.children);else if(fe(u,e))if(d=oe(u,e),N(d))i=Ia(i,F(),c.children);else{let _=Ve(c.children,P(d));if(_){let m=_.getChild(U(d));i=Zt(i,F(),m)}}}else throw ct("WriteRecord should have .snap or .children")}}return i}function Sl(s,t,e,i,o){if(!i&&!o){let c=qe(s.visibleWrites,t);if(c!=null)return c;{let u=xe(s.visibleWrites,t);if(Si(u))return e;if(e==null&&!Ci(u,F()))return null;{let d=e||V.EMPTY_NODE;return Ct(u,d)}}}else{let c=xe(s.visibleWrites,t);if(!o&&Si(c))return e;if(!o&&e==null&&!Ci(c,F()))return null;{let u=function(m){return(m.visible||o)&&(!i||!~i.indexOf(m.writeId))&&(fe(m.path,t)||fe(t,m.path))},d=Cl(s.allWrites,u,t),_=e||V.EMPTY_NODE;return Ct(d,_)}}}function p_(s,t,e){let i=V.EMPTY_NODE,o=qe(s.visibleWrites,t);if(o)return o.isLeafNode()||o.forEachChild(X,(c,u)=>{i=i.updateImmediateChild(c,u)}),i;if(e){let c=xe(s.visibleWrites,t);return e.forEachChild(X,(u,d)=>{let _=Ct(xe(c,new L(u)),d);i=i.updateImmediateChild(u,_)}),Ma(c).forEach(u=>{i=i.updateImmediateChild(u.name,u.node)}),i}else{let c=xe(s.visibleWrites,t);return Ma(c).forEach(u=>{i=i.updateImmediateChild(u.name,u.node)}),i}}function g_(s,t,e,i,o){S(i||o,"Either existingEventSnap or existingServerSnap must exist");let c=z(t,e);if(Ci(s.visibleWrites,c))return null;{let u=xe(s.visibleWrites,c);return Si(u)?o.getChild(e):Ct(u,o.getChild(e))}}function y_(s,t,e,i){let o=z(t,e),c=qe(s.visibleWrites,o);if(c!=null)return c;if(i.isCompleteForChild(e)){let u=xe(s.visibleWrites,o);return Ct(u,i.getNode().getImmediateChild(e))}else return null}function v_(s,t){return qe(s.visibleWrites,t)}function w_(s,t,e,i,o,c,u){let d,_=xe(s.visibleWrites,t),m=qe(_,F());if(m!=null)d=m;else if(e!=null)d=Ct(_,e);else return[];if(d=d.withIndex(u),!d.isEmpty()&&!d.isLeafNode()){let y=[],g=u.getCompare(),w=c?d.getReverseIteratorFrom(i,u):d.getIteratorFrom(i,u),M=w.getNext();for(;M&&y.length<o;)g(M,i)!==0&&y.push(M),M=w.getNext();return y}else return[]}function C_(){return{visibleWrites:_e.empty(),allWrites:[],lastWriteId:-1}}function Ti(s,t,e,i){return Sl(s.writeTree,s.treePath,t,e,i)}function Tl(s,t){return p_(s.writeTree,s.treePath,t)}function ba(s,t,e,i){return g_(s.writeTree,s.treePath,t,e,i)}function zn(s,t){return v_(s.writeTree,z(s.treePath,t))}function S_(s,t,e,i,o,c){return w_(s.writeTree,s.treePath,t,e,i,o,c)}function Hi(s,t,e){return y_(s.writeTree,s.treePath,t,e)}function El(s,t){return Il(z(s.treePath,t),s.writeTree)}function Il(s,t){return{treePath:s,writeTree:t}}var Ei=class{constructor(){this.changeMap=new Map}trackChildChange(t){let e=t.type,i=t.childName;S(e==="child_added"||e==="child_changed"||e==="child_removed","Only child changes supported for tracking"),S(i!==".priority","Only non-priority child changes can be tracked.");let o=this.changeMap.get(i);if(o){let c=o.type;if(e==="child_added"&&c==="child_removed")this.changeMap.set(i,Ca(i,t.snapshotNode,o.snapshotNode));else if(e==="child_removed"&&c==="child_added")this.changeMap.delete(i);else if(e==="child_removed"&&c==="child_changed")this.changeMap.set(i,t_(i,o.oldSnap));else if(e==="child_changed"&&c==="child_added")this.changeMap.set(i,e_(i,t.snapshotNode));else if(e==="child_changed"&&c==="child_changed")this.changeMap.set(i,Ca(i,t.snapshotNode,o.oldSnap));else throw ct("Illegal combination of changes: "+t+" occurred after "+o)}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}};var Ii=class{getCompleteChild(t){return null}getChildAfterChild(t,e,i){return null}},kl=new Ii,Jt=class{constructor(t,e,i=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=i}getCompleteChild(t){let e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{let i=this.optCompleteServerCache_!=null?new Xt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Hi(this.writes_,t,i)}}getChildAfterChild(t,e,i){let o=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ze(this.viewCache_),c=S_(this.writes_,o,e,1,i,t);return c.length===0?null:c[0]}};function T_(s,t){S(t.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),S(t.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function E_(s,t,e,i,o){let c=new Ei,u,d;if(e.type===De.OVERWRITE){let m=e;m.source.fromUser?u=ki(s,t,m.path,m.snap,i,o,c):(S(m.source.fromServer,"Unknown source."),d=m.source.tagged||t.serverCache.isFiltered()&&!N(m.path),u=qn(s,t,m.path,m.snap,i,o,d,c))}else if(e.type===De.MERGE){let m=e;m.source.fromUser?u=k_(s,t,m.path,m.children,i,o,c):(S(m.source.fromServer,"Unknown source."),d=m.source.tagged||t.serverCache.isFiltered(),u=Mi(s,t,m.path,m.children,i,o,d,c))}else if(e.type===De.ACK_USER_WRITE){let m=e;m.revert?u=D_(s,t,m.path,i,o,c):u=M_(s,t,m.path,m.affectedTree,i,o,c)}else if(e.type===De.LISTEN_COMPLETE)u=b_(s,t,e.path,i,c);else throw ct("Unknown operation type: "+e.type);let _=c.getChanges();return I_(t,u,_),{viewCache:u,changes:_}}function I_(s,t,e){let i=t.eventCache;if(i.isFullyInitialized()){let o=i.getNode().isLeafNode()||i.getNode().isEmpty(),c=wi(s);(e.length>0||!s.eventCache.isFullyInitialized()||o&&!i.getNode().equals(c)||!i.getNode().getPriority().equals(c.getPriority()))&&e.push(Jf(wi(t)))}}function Ml(s,t,e,i,o,c){let u=t.eventCache;if(zn(i,e)!=null)return t;{let d,_;if(N(e))if(S(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){let m=ze(t),y=m instanceof V?m:V.EMPTY_NODE,g=Tl(i,y);d=s.filter.updateFullNode(t.eventCache.getNode(),g,c)}else{let m=Ti(i,ze(t));d=s.filter.updateFullNode(t.eventCache.getNode(),m,c)}else{let m=P(e);if(m===".priority"){S(Fe(e)===1,"Can't have a priority with additional path components");let y=u.getNode();_=t.serverCache.getNode();let g=ba(i,e,y,_);g!=null?d=s.filter.updatePriority(y,g):d=u.getNode()}else{let y=U(e),g;if(u.isCompleteForChild(m)){_=t.serverCache.getNode();let w=ba(i,e,u.getNode(),_);w!=null?g=u.getNode().getImmediateChild(m).updateChild(y,w):g=u.getNode().getImmediateChild(m)}else g=Hi(i,m,t.serverCache);g!=null?d=s.filter.updateChild(u.getNode(),m,g,y,o,c):d=u.getNode()}}return Qt(t,d,u.isFullyInitialized()||N(e),s.filter.filtersNodes())}}function qn(s,t,e,i,o,c,u,d){let _=t.serverCache,m,y=u?s.filter:s.filter.getIndexedFilter();if(N(e))m=y.updateFullNode(_.getNode(),i,null);else if(y.filtersNodes()&&!_.isFiltered()){let M=_.getNode().updateChild(e,i);m=y.updateFullNode(_.getNode(),M,null)}else{let M=P(e);if(!_.isCompleteForPath(e)&&Fe(e)>1)return t;let C=U(e),q=_.getNode().getImmediateChild(M).updateChild(C,i);M===".priority"?m=y.updatePriority(_.getNode(),q):m=y.updateChild(_.getNode(),M,q,C,kl,null)}let g=yl(t,m,_.isFullyInitialized()||N(e),y.filtersNodes()),w=new Jt(o,g,c);return Ml(s,g,e,o,w,d)}function ki(s,t,e,i,o,c,u){let d=t.eventCache,_,m,y=new Jt(o,t,c);if(N(e))m=s.filter.updateFullNode(t.eventCache.getNode(),i,u),_=Qt(t,m,!0,s.filter.filtersNodes());else{let g=P(e);if(g===".priority")m=s.filter.updatePriority(t.eventCache.getNode(),i),_=Qt(t,m,d.isFullyInitialized(),d.isFiltered());else{let w=U(e),M=d.getNode().getImmediateChild(g),C;if(N(w))C=i;else{let B=y.getCompleteChild(g);B!=null?il(w)===".priority"&&B.getChild(ol(w)).isEmpty()?C=B:C=B.updateChild(w,i):C=V.EMPTY_NODE}if(M.equals(C))_=t;else{let B=s.filter.updateChild(d.getNode(),g,C,w,y,u);_=Qt(t,B,d.isFullyInitialized(),s.filter.filtersNodes())}}}return _}function Da(s,t){return s.eventCache.isCompleteForChild(t)}function k_(s,t,e,i,o,c,u){let d=t;return i.foreach((_,m)=>{let y=z(e,_);Da(t,P(y))&&(d=ki(s,d,y,m,o,c,u))}),i.foreach((_,m)=>{let y=z(e,_);Da(t,P(y))||(d=ki(s,d,y,m,o,c,u))}),d}function Na(s,t,e){return e.foreach((i,o)=>{t=t.updateChild(i,o)}),t}function Mi(s,t,e,i,o,c,u,d){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let _=t,m;N(e)?m=i:m=new ee(null).setTree(e,i);let y=t.serverCache.getNode();return m.children.inorderTraversal((g,w)=>{if(y.hasChild(g)){let M=t.serverCache.getNode().getImmediateChild(g),C=Na(s,M,w);_=qn(s,_,new L(g),C,o,c,u,d)}}),m.children.inorderTraversal((g,w)=>{let M=!t.serverCache.isCompleteForChild(g)&&w.value===null;if(!y.hasChild(g)&&!M){let C=t.serverCache.getNode().getImmediateChild(g),B=Na(s,C,w);_=qn(s,_,new L(g),B,o,c,u,d)}}),_}function M_(s,t,e,i,o,c,u){if(zn(o,e)!=null)return t;let d=t.serverCache.isFiltered(),_=t.serverCache;if(i.value!=null){if(N(e)&&_.isFullyInitialized()||_.isCompleteForPath(e))return qn(s,t,e,_.getNode().getChild(e),o,c,d,u);if(N(e)){let m=new ee(null);return _.getNode().forEachChild(mt,(y,g)=>{m=m.set(new L(y),g)}),Mi(s,t,e,m,o,c,d,u)}else return t}else{let m=new ee(null);return i.foreach((y,g)=>{let w=z(e,y);_.isCompleteForPath(w)&&(m=m.set(y,_.getNode().getChild(w)))}),Mi(s,t,e,m,o,c,d,u)}}function b_(s,t,e,i,o){let c=t.serverCache,u=yl(t,c.getNode(),c.isFullyInitialized()||N(e),c.isFiltered());return Ml(s,u,e,i,kl,o)}function D_(s,t,e,i,o,c){let u;if(zn(i,e)!=null)return t;{let d=new Jt(i,t,o),_=t.eventCache.getNode(),m;if(N(e)||P(e)===".priority"){let y;if(t.serverCache.isFullyInitialized())y=Ti(i,ze(t));else{let g=t.serverCache.getNode();S(g instanceof V,"serverChildren would be complete if leaf node"),y=Tl(i,g)}y=y,m=s.filter.updateFullNode(_,y,c)}else{let y=P(e),g=Hi(i,y,t.serverCache);g==null&&t.serverCache.isCompleteForChild(y)&&(g=_.getImmediateChild(y)),g!=null?m=s.filter.updateChild(_,y,g,U(e),d,c):t.eventCache.getNode().hasChild(y)?m=s.filter.updateChild(_,y,V.EMPTY_NODE,U(e),d,c):m=_,m.isEmpty()&&t.serverCache.isFullyInitialized()&&(u=Ti(i,ze(t)),u.isLeafNode()&&(m=s.filter.updateFullNode(m,u,c)))}return u=t.serverCache.isFullyInitialized()||zn(i,F())!=null,Qt(t,m,u,s.filter.filtersNodes())}}function N_(s,t){let e=ze(s.viewCache_);return e&&(s.query._queryParams.loadsAllData()||!N(t)&&!e.getImmediateChild(P(t)).isEmpty())?e.getChild(t):null}function Ra(s,t,e,i){t.type===De.MERGE&&t.source.queryId!==null&&(S(ze(s.viewCache_),"We should always have a full cache before handling merges"),S(wi(s.viewCache_),"Missing event cache, even though we have a server cache"));let o=s.viewCache_,c=E_(s.processor_,o,t,e,i);return T_(s.processor_,c.viewCache),S(c.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=c.viewCache,R_(s,c.changes,c.viewCache.eventCache.getNode(),null)}function R_(s,t,e,i){let o=i?[i]:s.eventRegistrations_;return o_(s.eventGenerator_,t,e,o)}var Pa;function P_(s){S(!Pa,"__referenceConstructor has already been defined"),Pa=s}function Vi(s,t,e,i){let o=t.source.queryId;if(o!==null){let c=s.views.get(o);return S(c!=null,"SyncTree gave us an op for an invalid query."),Ra(c,t,e,i)}else{let c=[];for(let u of s.views.values())c=c.concat(Ra(u,t,e,i));return c}}function Gi(s,t){let e=null;for(let i of s.views.values())e=e||N_(i,t);return e}var Aa;function A_(s){S(!Aa,"__referenceConstructor has already been defined"),Aa=s}var Kn=class{constructor(t){this.listenProvider_=t,this.syncPointTree_=new ee(null),this.pendingWriteTree_=C_(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function O_(s,t,e,i,o){return u_(s.pendingWriteTree_,t,e,i,o),o?Zn(s,new wt(_l(),t,e)):[]}function ft(s,t,e=!1){let i=h_(s.pendingWriteTree_,t);if(d_(s.pendingWriteTree_,t)){let c=new ee(null);return i.snap!=null?c=c.set(F(),!0):le(i.children,u=>{c=c.set(new L(u),!0)}),Zn(s,new vi(i.path,c,e))}else return[]}function Qn(s,t,e){return Zn(s,new wt(ml(),t,e))}function x_(s,t,e){let i=ee.fromObject(e);return Zn(s,new $n(ml(),t,i))}function F_(s,t,e,i){let o=Rl(s,i);if(o!=null){let c=Pl(o),u=c.path,d=c.queryId,_=oe(u,t),m=new wt(pl(d),_,e);return Al(s,u,m)}else return[]}function L_(s,t,e,i){let o=Rl(s,i);if(o){let c=Pl(o),u=c.path,d=c.queryId,_=oe(u,t),m=ee.fromObject(e),y=new $n(pl(d),_,m);return Al(s,u,y)}else return[]}function bl(s,t,e){let o=s.pendingWriteTree_,c=s.syncPointTree_.findOnPath(t,(u,d)=>{let _=oe(u,t),m=Gi(d,_);if(m)return m});return Sl(o,t,c,e,!0)}function Zn(s,t){return Dl(t,s.syncPointTree_,null,wl(s.pendingWriteTree_,F()))}function Dl(s,t,e,i){if(N(s.path))return Nl(s,t,e,i);{let o=t.get(F());e==null&&o!=null&&(e=Gi(o,F()));let c=[],u=P(s.path),d=s.operationForChild(u),_=t.children.get(u);if(_&&d){let m=e?e.getImmediateChild(u):null,y=El(i,u);c=c.concat(Dl(d,_,m,y))}return o&&(c=c.concat(Vi(o,s,i,e))),c}}function Nl(s,t,e,i){let o=t.get(F());e==null&&o!=null&&(e=Gi(o,F()));let c=[];return t.children.inorderTraversal((u,d)=>{let _=e?e.getImmediateChild(u):null,m=El(i,u),y=s.operationForChild(u);y&&(c=c.concat(Nl(y,d,_,m)))}),o&&(c=c.concat(Vi(o,s,i,e))),c}function Rl(s,t){return s.tagToQueryMap.get(t)}function Pl(s){let t=s.indexOf("$");return S(t!==-1&&t<s.length-1,"Bad queryKey."),{queryId:s.substr(t+1),path:new L(s.substr(0,t))}}function Al(s,t,e){let i=s.syncPointTree_.get(t);S(i,"Missing sync point for query tag that we're tracking");let o=wl(s.pendingWriteTree_,t);return Vi(i,e,o,null)}var bi=class s{constructor(t){this.node_=t}getImmediateChild(t){let e=this.node_.getImmediateChild(t);return new s(e)}node(){return this.node_}},Di=class s{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){let e=z(this.path_,t);return new s(this.syncTree_,e)}node(){return bl(this.syncTree_,this.path_)}},Y_=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},Oa=function(s,t,e){if(!s||typeof s!="object")return s;if(S(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return W_(s[".sv"],t,e);if(typeof s[".sv"]=="object")return U_(s[".sv"],t);S(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},W_=function(s,t,e){switch(s){case"timestamp":return e.timestamp;default:S(!1,"Unexpected server value: "+s)}},U_=function(s,t,e){s.hasOwnProperty("increment")||S(!1,"Unexpected server value: "+JSON.stringify(s,null,2));let i=s.increment;typeof i!="number"&&S(!1,"Unexpected increment value: "+i);let o=t.node();if(S(o!==null&&typeof o<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return i;let u=o.getValue();return typeof u!="number"?i:u+i},H_=function(s,t,e,i){return Bi(t,new Di(e,s),i)},V_=function(s,t,e){return Bi(s,new bi(t),e)};function Bi(s,t,e){let i=s.getPriority().val(),o=Oa(i,t.getImmediateChild(".priority"),e),c;if(s.isLeafNode()){let u=s,d=Oa(u.getValue(),t,e);return d!==u.getValue()||o!==u.getPriority().val()?new yt(d,Z(o)):s}else{let u=s;return c=u,o!==u.getPriority().val()&&(c=c.updatePriority(new yt(o))),u.forEachChild(X,(d,_)=>{let m=Bi(_,t.getImmediateChild(d),e);m!==_&&(c=c.updateImmediateChild(d,m))}),c}}var en=class{constructor(t="",e=null,i={children:{},childCount:0}){this.name=t,this.parent=e,this.node=i}};function ji(s,t){let e=t instanceof L?t:new L(t),i=s,o=P(e);for(;o!==null;){let c=Ve(i.node.children,o)||{children:{},childCount:0};i=new en(o,i,c),e=U(e),o=P(e)}return i}function Et(s){return s.node.value}function Ol(s,t){s.node.value=t,Ni(s)}function xl(s){return s.node.childCount>0}function G_(s){return Et(s)===void 0&&!xl(s)}function Xn(s,t){le(s.node.children,(e,i)=>{t(new en(e,s,i))})}function Fl(s,t,e,i){e&&!i&&t(s),Xn(s,o=>{Fl(o,t,!0,i)}),e&&i&&t(s)}function B_(s,t,e){let i=e?s:s.parent;for(;i!==null;){if(t(i))return!0;i=i.parent}return!1}function on(s){return new L(s.parent===null?s.name:on(s.parent)+"/"+s.name)}function Ni(s){s.parent!==null&&j_(s.parent,s.name,s)}function j_(s,t,e){let i=G_(e),o=ve(s.node.children,t);i&&o?(delete s.node.children[t],s.node.childCount--,Ni(s)):!i&&!o&&(s.node.children[t]=e.node,s.node.childCount++,Ni(s))}var $_=/[\[\].#$\/\u0000-\u001F\u007F]/,z_=/[\[\].#$\u0000-\u001F\u007F]/,Bs=10*1024*1024,Ll=function(s){return typeof s=="string"&&s.length!==0&&!$_.test(s)},q_=function(s){return typeof s=="string"&&s.length!==0&&!z_.test(s)},K_=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),q_(s)};var Yl=function(s,t,e){let i=e instanceof L?new ii(e,s):e;if(t===void 0)throw new Error(s+"contains undefined "+Ge(i));if(typeof t=="function")throw new Error(s+"contains a function "+Ge(i)+" with contents = "+t.toString());if(Ua(t))throw new Error(s+"contains "+t.toString()+" "+Ge(i));if(typeof t=="string"&&t.length>Bs/3&&Ht(t)>Bs)throw new Error(s+"contains a string greater than "+Bs+" utf8 bytes "+Ge(i)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let o=!1,c=!1;if(le(t,(u,d)=>{if(u===".value")o=!0;else if(u!==".priority"&&u!==".sv"&&(c=!0,!Ll(u)))throw new Error(s+" contains an invalid key ("+u+") "+Ge(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Uf(i,u),Yl(s,d,i),Hf(i)}),o&&c)throw new Error(s+' contains ".value" child '+Ge(i)+" in addition to actual children.")}};var Q_=function(s,t){let e=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!Ll(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||e.length!==0&&!K_(e))throw new Error(Eo(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Ri=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Z_(s,t){let e=null;for(let i=0;i<t.length;i++){let o=t[i],c=o.getPath();e!==null&&!al(c,e.path)&&(s.eventLists_.push(e),e=null),e===null&&(e={events:[],path:c}),e.events.push(o)}e&&s.eventLists_.push(e)}function Ke(s,t,e){Z_(s,e),X_(s,i=>fe(i,t)||fe(t,i))}function X_(s,t){s.recursionDepth_++;let e=!0;for(let i=0;i<s.eventLists_.length;i++){let o=s.eventLists_[i];if(o){let c=o.path;t(c)?(J_(s.eventLists_[i]),s.eventLists_[i]=null):e=!1}}e&&(s.eventLists_=[]),s.recursionDepth_--}function J_(s){for(let t=0;t<s.events.length;t++){let e=s.events[t];if(e!==null){s.events[t]=null;let i=e.getEventRunner();je&&Q("event: "+e.toString()),sn(i)}}}var em="repo_interrupt",tm=25,Pi=class{constructor(t,e,i,o){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=i,this.appCheckProvider_=o,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ri,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=jn(),this.transactionQueueTree_=new en,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function nm(s,t,e){if(s.stats_=Yi(s.repoInfo_),s.forceRestClient_||mf())s.server_=new _i(s.repoInfo_,(i,o,c,u)=>{xa(s,i,o,c,u)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>Fa(s,!0),0);else{if(typeof e<"u"&&e!==null){if(typeof e!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{$(e)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}s.persistentConnection_=new Wi(s.repoInfo_,t,(i,o,c,u)=>{xa(s,i,o,c,u)},i=>{Fa(s,i)},i=>{im(s,i)},s.authTokenProvider_,s.appCheckProvider_,e),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(i=>{s.server_.refreshAuthToken(i)}),s.appCheckProvider_.addTokenChangeListener(i=>{s.server_.refreshAppCheckToken(i.token)}),s.statsReporter_=gf(s.repoInfo_,()=>new yi(s.stats_,s.server_)),s.infoData_=new mi,s.infoSyncTree_=new Kn({startListening:(i,o,c,u)=>{let d=[],_=s.infoData_.getNode(i._path);return _.isEmpty()||(d=Qn(s.infoSyncTree_,i._path,_),setTimeout(()=>{u("ok")},0)),d},stopListening:()=>{}}),$i(s,"connected",!1),s.serverSyncTree_=new Kn({startListening:(i,o,c,u)=>(s.server_.listen(i,c,o,(d,_)=>{let m=u(d,_);Ke(s.eventQueue_,i._path,m)}),[]),stopListening:(i,o)=>{s.server_.unlisten(i,o)}})}function sm(s){let e=s.infoData_.getNode(new L(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e}function Wl(s){return Y_({timestamp:sm(s)})}function xa(s,t,e,i,o){s.dataUpdateCount++;let c=new L(t);e=s.interceptServerDataCallback_?s.interceptServerDataCallback_(t,e):e;let u=[];if(o)if(i){let _=Ut(e,m=>Z(m));u=L_(s.serverSyncTree_,c,_,o)}else{let _=Z(e);u=F_(s.serverSyncTree_,c,_,o)}else if(i){let _=Ut(e,m=>Z(m));u=x_(s.serverSyncTree_,c,_)}else{let _=Z(e);u=Qn(s.serverSyncTree_,c,_)}let d=c;u.length>0&&(d=qi(s,c)),Ke(s.eventQueue_,d,u)}function Fa(s,t){$i(s,"connected",t),t===!1&&om(s)}function im(s,t){le(t,(e,i)=>{$i(s,e,i)})}function $i(s,t,e){let i=new L("/.info/"+t),o=Z(e);s.infoData_.updateSnapshot(i,o);let c=Qn(s.infoSyncTree_,i,o);Ke(s.eventQueue_,i,c)}function rm(s){return s.nextWriteId_++}function om(s){Ul(s,"onDisconnectEvents");let t=Wl(s),e=jn();pi(s.onDisconnect_,F(),(o,c)=>{let u=H_(o,c,s.serverSyncTree_,t);fl(e,o,u)});let i=[];pi(e,F(),(o,c)=>{i=i.concat(Qn(s.serverSyncTree_,o,c));let u=um(s,o);qi(s,u)}),s.onDisconnect_=jn(),Ke(s.eventQueue_,F(),i)}function am(s){s.persistentConnection_&&s.persistentConnection_.interrupt(em)}function Ul(s,...t){let e="";s.persistentConnection_&&(e=s.persistentConnection_.id+":"),Q(e,...t)}function Hl(s,t,e){return bl(s.serverSyncTree_,t,e)||V.EMPTY_NODE}function zi(s,t=s.transactionQueueTree_){if(t||Jn(s,t),Et(t)){let e=Gl(s,t);S(e.length>0,"Sending zero length transaction queue"),e.every(o=>o.status===0)&&lm(s,on(t),e)}else xl(t)&&Xn(t,e=>{zi(s,e)})}function lm(s,t,e){let i=e.map(m=>m.currentWriteId),o=Hl(s,t,i),c=o,u=o.hash();for(let m=0;m<e.length;m++){let y=e[m];S(y.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),y.status=1,y.retryCount++;let g=oe(t,y.path);c=c.updateChild(g,y.currentOutputSnapshotRaw)}let d=c.val(!0),_=t;s.server_.put(_.toString(),d,m=>{Ul(s,"transaction put response",{path:_.toString(),status:m});let y=[];if(m==="ok"){let g=[];for(let w=0;w<e.length;w++)e[w].status=2,y=y.concat(ft(s.serverSyncTree_,e[w].currentWriteId)),e[w].onComplete&&g.push(()=>e[w].onComplete(null,!0,e[w].currentOutputSnapshotResolved)),e[w].unwatcher();Jn(s,ji(s.transactionQueueTree_,t)),zi(s,s.transactionQueueTree_),Ke(s.eventQueue_,t,y);for(let w=0;w<g.length;w++)sn(g[w])}else{if(m==="datastale")for(let g=0;g<e.length;g++)e[g].status===3?e[g].status=4:e[g].status=0;else{ne("transaction at "+_.toString()+" failed: "+m);for(let g=0;g<e.length;g++)e[g].status=4,e[g].abortReason=m}qi(s,t)}},u)}function qi(s,t){let e=Vl(s,t),i=on(e),o=Gl(s,e);return cm(s,o,i),i}function cm(s,t,e){if(t.length===0)return;let i=[],o=[],u=t.filter(d=>d.status===0).map(d=>d.currentWriteId);for(let d=0;d<t.length;d++){let _=t[d],m=oe(e,_.path),y=!1,g;if(S(m!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),_.status===4)y=!0,g=_.abortReason,o=o.concat(ft(s.serverSyncTree_,_.currentWriteId,!0));else if(_.status===0)if(_.retryCount>=tm)y=!0,g="maxretry",o=o.concat(ft(s.serverSyncTree_,_.currentWriteId,!0));else{let w=Hl(s,_.path,u);_.currentInputSnapshot=w;let M=t[d].update(w.val());if(M!==void 0){Yl("transaction failed: Data returned ",M,_.path);let C=Z(M);typeof M=="object"&&M!=null&&ve(M,".priority")||(C=C.updatePriority(w.getPriority()));let q=_.currentWriteId,Re=Wl(s),Le=V_(C,w,Re);_.currentOutputSnapshotRaw=C,_.currentOutputSnapshotResolved=Le,_.currentWriteId=rm(s),u.splice(u.indexOf(q),1),o=o.concat(O_(s.serverSyncTree_,_.path,Le,_.currentWriteId,_.applyLocally)),o=o.concat(ft(s.serverSyncTree_,q,!0))}else y=!0,g="nodata",o=o.concat(ft(s.serverSyncTree_,_.currentWriteId,!0))}Ke(s.eventQueue_,e,o),o=[],y&&(t[d].status=2,function(w){setTimeout(w,Math.floor(0))}(t[d].unwatcher),t[d].onComplete&&(g==="nodata"?i.push(()=>t[d].onComplete(null,!1,t[d].currentInputSnapshot)):i.push(()=>t[d].onComplete(new Error(g),!1,null))))}Jn(s,s.transactionQueueTree_);for(let d=0;d<i.length;d++)sn(i[d]);zi(s,s.transactionQueueTree_)}function Vl(s,t){let e,i=s.transactionQueueTree_;for(e=P(t);e!==null&&Et(i)===void 0;)i=ji(i,e),t=U(t),e=P(t);return i}function Gl(s,t){let e=[];return Bl(s,t,e),e.sort((i,o)=>i.order-o.order),e}function Bl(s,t,e){let i=Et(t);if(i)for(let o=0;o<i.length;o++)e.push(i[o]);Xn(t,o=>{Bl(s,o,e)})}function Jn(s,t){let e=Et(t);if(e){let i=0;for(let o=0;o<e.length;o++)e[o].status!==2&&(e[i]=e[o],i++);e.length=i,Ol(t,e.length>0?e:void 0)}Xn(t,i=>{Jn(s,i)})}function um(s,t){let e=on(Vl(s,t)),i=ji(s.transactionQueueTree_,t);return B_(i,o=>{js(s,o)}),js(s,i),Fl(i,o=>{js(s,o)}),e}function js(s,t){let e=Et(t);if(e){let i=[],o=[],c=-1;for(let u=0;u<e.length;u++)e[u].status===3||(e[u].status===1?(S(c===u-1,"All SENT items should be at beginning of queue."),c=u,e[u].status=3,e[u].abortReason="set"):(S(e[u].status===0,"Unexpected transaction status in abort"),e[u].unwatcher(),o=o.concat(ft(s.serverSyncTree_,e[u].currentWriteId,!0)),e[u].onComplete&&i.push(e[u].onComplete.bind(null,new Error("set"),!1,null))));c===-1?Ol(t,void 0):e.length=c+1,Ke(s.eventQueue_,on(t),o);for(let u=0;u<i.length;u++)sn(i[u])}}function hm(s){let t="",e=s.split("/");for(let i=0;i<e.length;i++)if(e[i].length>0){let o=e[i];try{o=decodeURIComponent(o.replace(/\+/g," "))}catch{}t+="/"+o}return t}function dm(s){let t={};s.charAt(0)==="?"&&(s=s.substring(1));for(let e of s.split("&")){if(e.length===0)continue;let i=e.split("=");i.length===2?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ne(`Invalid query segment '${e}' in query '${s}'`)}return t}var La=function(s,t){let e=fm(s),i=e.namespace;e.domain==="firebase.com"&&Ne(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&e.domain!=="localhost"&&Ne("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||af();let o=e.scheme==="ws"||e.scheme==="wss";return{repoInfo:new Yn(e.host,e.secure,i,o,t,"",i!==e.subdomain),path:new L(e.pathString)}},fm=function(s){let t="",e="",i="",o="",c="",u=!0,d="https",_=443;if(typeof s=="string"){let m=s.indexOf("//");m>=0&&(d=s.substring(0,m-1),s=s.substring(m+2));let y=s.indexOf("/");y===-1&&(y=s.length);let g=s.indexOf("?");g===-1&&(g=s.length),t=s.substring(0,Math.min(y,g)),y<g&&(o=hm(s.substring(y,g)));let w=dm(s.substring(Math.min(s.length,g)));m=t.indexOf(":"),m>=0?(u=d==="https"||d==="wss",_=parseInt(t.substring(m+1),10)):m=t.length;let M=t.slice(0,m);if(M.toLowerCase()==="localhost")e="localhost";else if(M.split(".").length<=2)e=M;else{let C=t.indexOf(".");i=t.substring(0,C).toLowerCase(),e=t.substring(C+1),c=i}"ns"in w&&(c=w.ns)}return{host:t,port:_,domain:e,subdomain:i,secure:u,scheme:d,pathString:o,namespace:c}};var Ai=class s{constructor(t,e,i,o){this._repo=t,this._path=e,this._queryParams=i,this._orderByCalled=o}get key(){return N(this._path)?null:il(this._path)}get ref(){return new St(this._repo,this._path)}get _queryIdentifier(){let t=Ta(this._queryParams),e=Li(t);return e==="{}"?"default":e}get _queryObject(){return Ta(this._queryParams)}isEqual(t){if(t=As(t),!(t instanceof s))return!1;let e=this._repo===t._repo,i=al(this._path,t._path),o=this._queryIdentifier===t._queryIdentifier;return e&&i&&o}toJSON(){return this.toString()}toString(){return this._repo.toString()+Wf(this._path)}};var St=class s extends Ai{constructor(t,e){super(t,e,new fi,!1)}get parent(){let t=ol(this._path);return t===null?null:new s(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}};P_(St);A_(St);var _m="FIREBASE_DATABASE_EMULATOR_HOST",Oi={},mm=!1;function pm(s,t,e,i){s.repoInfo_=new Yn(`${t}:${e}`,!1,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0),i&&(s.authTokenProvider_=i)}function gm(s,t,e,i,o){let c=i||s.options.databaseURL;c===void 0&&(s.options.projectId||Ne("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Q("Using default host for project ",s.options.projectId),c=`${s.options.projectId}-default-rtdb.firebaseio.com`);let u=La(c,o),d=u.repoInfo,_,m;typeof process<"u"&&process.env&&(m=process.env[_m]),m?(_=!0,c=`http://${m}?ns=${d.namespace}`,u=La(c,o),d=u.repoInfo):_=!u.repoInfo.secure;let y=o&&_?new Kt(Kt.OWNER):new Zs(s.name,s.options,t);Q_("Invalid Firebase Database URL",u),N(u.path)||Ne("Database URL must point to the root of a Firebase Database (not including a child path).");let g=vm(d,s,y,new Qs(s.name,e));return new xi(g,s)}function ym(s,t){let e=Oi[t];(!e||e[s.key]!==s)&&Ne(`Database ${t}(${s.repoInfo_}) has already been deleted.`),am(s),delete e[s.key]}function vm(s,t,e,i){let o=Oi[t.name];o||(o={},Oi[t.name]=o);let c=o[s.toURLString()];return c&&Ne("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),c=new Pi(s,mm,e,i),o[s.toURLString()]=c,c}var xi=class{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(nm(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new St(this._repo,F())),this._rootInternal}_delete(){return this._rootInternal!==null&&(ym(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Ne("Cannot call "+t+" on a deleted database.")}};function jl(s=Po(),t){let e=No(s,"database").getImmediate({identifier:t});if(!e._instanceStarted){let i=go("database");i&&$l(e,...i)}return e}function $l(s,t,e,i={}){s=As(s),s._checkNotDeleted("useEmulator"),s._instanceStarted&&Ne("Cannot call useEmulator() after instance has already been initialized.");let o=s._repoInternal,c;if(o.repoInfo_.nodeAdmin)i.mockUserToken&&Ne('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new Kt(Kt.OWNER);else if(i.mockUserToken){let u=typeof i.mockUserToken=="string"?i.mockUserToken:yo(i.mockUserToken,s.app.options.projectId);c=new Kt(u)}pm(o,t,e,c)}function wm(s){sf(Ro),Do(new ko("database",(t,{instanceIdentifier:e})=>{let i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),c=t.getProvider("app-check-internal");return gm(i,o,c,e)},"PUBLIC").setMultipleInstances(!0)),Vt(ra,oa,s),Vt(ra,oa,"esm2017")}Wi.prototype.simpleListen=function(s,t){this.sendRequest("q",{p:s},t)};Wi.prototype.echo=function(s,t){this.sendRequest("echo",{d:s},t)};wm();var an=class{constructor(t){return t}},zl="database",Ki=class{constructor(){return xo(zl)}};var Qi=new at("angularfire2.database-instances");function Cm(s,t){let e=Oo(zl,s,t);return e&&new an(e)}function Sm(s){return(t,e)=>{let i=t.runOutsideAngular(()=>s(e));return new an(i)}}var Tm={provide:Ki,deps:[[new Wt,Qi]]},Em={provide:an,useFactory:Cm,deps:[[new Wt,Qi],Wo]};function ql(s,...t){return Vt("angularfire",Ao.full,"rtdb"),Rn([Em,Tm,{provide:Qi,useFactory:Sm(s),multi:!0,deps:[Pn,Jr,Lo,Uo,[new Wt,Go],[new Wt,Fo],...t]}])}var Kl=Yo(jl,!0);var Im=Qr(Xi(),1),Ql=Qr(Xi(),1),Qe=Ql.default||Im,Ji=new at("MAT_MOMENT_DATE_ADAPTER_OPTIONS",{providedIn:"root",factory:km});function km(){return{useUtc:!1}}function Mm(s,t){let e=Array(s);for(let i=0;i<s;i++)e[i]=t(i);return e}var bm=(()=>{class s extends Ls{constructor(e,i){super(),this._options=i,this.setLocale(e||Qe.locale())}setLocale(e){super.setLocale(e);let i=Qe.localeData(e);this._localeData={firstDayOfWeek:i.firstDayOfWeek(),longMonths:i.months(),shortMonths:i.monthsShort(),dates:Mm(31,o=>this.createDate(2017,0,o+1).format("D")),longDaysOfWeek:i.weekdays(),shortDaysOfWeek:i.weekdaysShort(),narrowDaysOfWeek:i.weekdaysMin()}}getYear(e){return this.clone(e).year()}getMonth(e){return this.clone(e).month()}getDate(e){return this.clone(e).date()}getDayOfWeek(e){return this.clone(e).day()}getMonthNames(e){return e=="long"?this._localeData.longMonths:this._localeData.shortMonths}getDateNames(){return this._localeData.dates}getDayOfWeekNames(e){return e=="long"?this._localeData.longDaysOfWeek:e=="short"?this._localeData.shortDaysOfWeek:this._localeData.narrowDaysOfWeek}getYearName(e){return this.clone(e).format("YYYY")}getFirstDayOfWeek(){return this._localeData.firstDayOfWeek}getNumDaysInMonth(e){return this.clone(e).daysInMonth()}clone(e){return e.clone().locale(this.locale)}createDate(e,i,o){let c=this._createMoment({year:e,month:i,date:o}).locale(this.locale);return c.isValid(),c}today(){return this._createMoment().locale(this.locale)}parse(e,i){return e&&typeof e=="string"?this._createMoment(e,i,this.locale):e?this._createMoment(e).locale(this.locale):null}format(e,i){return e=this.clone(e),this.isValid(e),e.format(i)}addCalendarYears(e,i){return this.clone(e).add({years:i})}addCalendarMonths(e,i){return this.clone(e).add({months:i})}addCalendarDays(e,i){return this.clone(e).add({days:i})}toIso8601(e){return this.clone(e).format()}deserialize(e){let i;if(e instanceof Date)i=this._createMoment(e).locale(this.locale);else if(this.isDateInstance(e))return this.clone(e);if(typeof e=="string"){if(!e)return null;i=this._createMoment(e,Qe.ISO_8601).locale(this.locale)}return i&&this.isValid(i)?this._createMoment(i).locale(this.locale):super.deserialize(e)}isDateInstance(e){return Qe.isMoment(e)}isValid(e){return this.clone(e).isValid()}invalid(){return Qe.invalid()}_createMoment(e,i,o){let{strict:c,useUtc:u}=this._options||{};return u?Qe.utc(e,i,o,c):Qe(e,i,o,c)}static{this.\u0275fac=function(i){return new(i||s)(Dn(Fs,8),Dn(Ji,8))}}static{this.\u0275prov=Lt({token:s,factory:s.\u0275fac})}}return s})(),Dm={parse:{dateInput:"l"},display:{dateInput:"l",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}};var Zl=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=lt({type:s})}static{this.\u0275inj=ot({providers:[er()]})}}return s})();function er(s=Dm,t){let e=[{provide:Ls,useClass:bm,deps:[Fs,Ji]},{provide:Jo,useValue:s}];return t&&e.push({provide:Ji,useValue:t}),e}var Xl={providers:[{provide:ea,useValue:{appearance:"outline",floatLabel:"always",subscriptSizing:"dynamic"}},ao({eventCoalescing:!0}),fo(sa),ia(),Ho(()=>Vo({projectId:"ng-to-firebase-host-example",appId:"1:845087366098:web:2bf0c47663cb3ade13860b",storageBucket:"ng-to-firebase-host-example.firebasestorage.app",apiKey:"AIzaSyA2nOxkkX5o1dyGqWw6a_SxVv1ESON_180",authDomain:"ng-to-firebase-host-example.firebaseapp.com",messagingSenderId:"845087366098",measurementId:"G-MWFYHY6VP0"})),Bo(()=>jo()),zo(()=>Qo()),ql(()=>Kl()),er(void 0,{useUtc:!0}),Xr(Zl)]};var Jl=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=lt({type:s})}static{this.\u0275inj=ot({imports:[ut,ut]})}}return s})();var ec=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=lt({type:s})}static{this.\u0275inj=ot({imports:[ut,ut]})}}return s})();var es=class s{constructor(t){this.fb=t;this.productForm=this.fb.group({name:["",xs.required],price:[0,xs.required]})}title="ng-test";firestore=Yt($o);productForm;products=ro([]);ngOnInit(){this.getProducts()}onSubmit(){return bn(this,null,function*(){if(this.productForm.valid){let t=this.productForm.value,e=Os(this.firestore,"products");yield Ko(e,t),this.productForm.reset()}})}getProducts(){let t=Os(this.firestore,"products");qo(t,{idField:"id"}).subscribe(e=>{this.products.set(e)})}static \u0275fac=function(e){return new(e||s)(Ds(Zo))};static \u0275cmp=Nn({type:s,selectors:[["app-root"]],standalone:!0,features:[An],decls:1,vars:0,template:function(e,i){e&1&&oo(0,"router-outlet")},dependencies:[ho,Jl,ec,na,ta,Xo]})};uo(es,Xl).catch(s=>console.error(s));
